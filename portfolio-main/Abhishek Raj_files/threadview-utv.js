(window.webpackJsonp=window.webpackJsonp||[]).push([["threadview-utv"],{"+jHl":function(e,t,n){"use strict";n.r(t);n.d(t,"wrapFailedMessage",function(){return c});var a=n("Ybsy"),r=n("4Oo9"),i=n("jPg9"),o=n("mNNF"),s=n("D1/i"),c=Object(s.a)(function(e,t){var n=e.threadId,s=e.channel,c=e.allowRetry,u=void 0===c||c;return Object(i.a)(t)&&Object(r.getStatusForCmf)(t)===a.a?Object(o.a)({message:t,threadId:n,channel:s,allowRetry:u}):t})},"+rg3":function(e,t,n){"use strict";n.r(t);n.d(t,"attachmentError",function(){return i});var a=n("CRij"),r=n("bDpH"),i=Object(a.createAction)(r.a,function(e,t){return{error:e,threadId:t}})},"+wbG":function(e,t,n){"use strict";n.d(t,"a",function(){return a});n.d(t,"b",function(){return r});n.d(t,"c",function(){return i});var a="agent",r="default",i="visitor"},"/A3W":function(e,t,n){"use strict";n.r(t);n.d(t,"getHubspotUtk",function(){return o});var a=n("ib5I"),r=n("mu3n"),i=n("30X/"),o=Object(a.a)(i.a,function(e){return Object(r.getHubspotUtk)(e)})},"/Zaq":function(e,t,n){var a=n("fwVr"),r="__lodash_hash_undefined__";function i(e,t){var n=this.__data__;this.size+=this.has(e)?0:1;n[e]=a&&void 0===t?r:t;return this}e.exports=i},"/ceY":function(e,t,n){"use strict";n.r(t);var a,r=n("6+o1"),i=n("zRU2"),o=n.n(i),s=n("4Oo9"),c=function(e,t){return Boolean(t[Object(s.getType)(e)])},u=n("qBhh"),l=n("UaBW"),d=Object(r.Record)((a={},Object(u.a)(a,l.b,l.a),Object(u.a)(a,"timestamp",null),Object(u.a)(a,"id",null),a),"DateMessage"),p=n("E7sj"),h=n.n(p),m=function(e,t){var n=h.a.moment(Object(s.getTimestamp)(e)),a=h.a.moment(Object(s.getTimestamp)(t));return!n.isSame(a,"day")},b=function(e,t,n){return!(!t&&!n)&&Boolean(Object(s.getTimestamp)(e)&&(!t||m(t,e)))},f=n("enlW");n.d(t,"insertDatesIntoMessageList",function(){return v});var g=o()(d,function(e){return e.id}),v=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e.reduce(function(a,r,i){var o=i>0?e.get(i-1):void 0;b(r,o,n)&&c(r,t)&&(a=a.push(g({id:Object(f.a)(r)+"-date",timestamp:Object(s.getTimestamp)(r)})));return a.push(r)},Object(r.List)())}},"/gqD":function(e,t){function n(e,t){return null==e?void 0:e[t]}e.exports=n},"00xA":function(e,t,n){var a=n("RWBV"),r=n("15fP"),i=n("RSm/"),o=n("ce3V"),s=n("h8ap");function c(e){var t=-1,n=null==e?0:e.length;this.clear();for(;++t<n;){var a=e[t];this.set(a[0],a[1])}}c.prototype.clear=a;c.prototype.delete=r;c.prototype.get=i;c.prototype.has=o;c.prototype.set=s;e.exports=c},"08NH":function(e,t,n){"use strict";n.r(t);n.d(t,"getMostRecentMessageIsEmailPrompt",function(){return s});var a=n("ib5I"),r=n("42Z2"),i=n("4Oo9"),o=n("12I0"),s=Object(a.a)([r.a],function(e){return Object(i.getType)(e.last())===o.j})},"0pNr":function(e,t,n){"use strict";n.r(t);n.d(t,"PRIMARY",function(){return a});n.d(t,"SECONDARY",function(){return r});var a="primary",r="secondary"},"0v5j":function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n("6+o1"),r=n("ib5I"),i=n("BjQQ"),o=n("rkDb"),s=n("Xqh6"),c=n("4ajQ"),u=Object(r.a)([s.a,c.typingStates],function(e,t){var n=Object(o.getThreadId)(e);return Object(i.a)(""+n,t)||Object(a.Map)()})},"15fP":function(e,t,n){var a=n("I04N"),r=Array.prototype.splice;function i(e){var t=this.__data__,n=a(t,e);if(n<0)return!1;n==t.length-1?t.pop():r.call(t,n,1);--this.size;return!0}e.exports=i},"1an1":function(e,t,n){"use strict";var a=n("PvDV"),r=n("ZQ2w"),i=n.n(r),o=n("y4Zp"),s=n.n(o),c="javascript:void(0)",u=/^([^:]+):/,l=/[\s\x00-\x1f]/g,d=function(e){if(e&&"string"==typeof e){var t=e.match(u);if(!t||e===c)return!1;if("javascript:"===t[0].replace(l,"").toLowerCase())return!0}return!1},p=n("OCxt").e.img.withConfig({displayName:"VizExImage__StyledImg",componentId:"sc-1owz4lv-0"})(["display:block;height:auto;max-width:100%;"]),h=function(e){var t=e.src,n=Object(a.a)(e,["src"]),r=d(t);r&&console.warn("VizExImage was given an unsafe src, defaulting to empty.");return i.a.createElement(p,Object.assign({},n,{src:r?null:t}))};h.propTypes={src:s.a.string.isRequired};h.displayName="VizExImage";t.a=h},"2NeP":function(e,t,n){"use strict";n.r(t);var a=n("ib5I"),r=n("kJ+w"),i=n("dIiL"),o=Object(a.a)([r.getThreadByThreadId],i.a),s=n("L6i2");n.d(t,"shouldRecordUrlContextUpdate",function(){return c});var c=Object(a.a)([o,s.getMessagesPageUri],function(e,t){return e!==t})},"2a3n":function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n("Txxr"),r=n("gXf6"),i=n("nRUj"),o=n("ib5I"),s=Object(o.b)(function(e,t,n){var o=Object(a.agentTypeToSenderType)(Object(i.getAgentType)(e)||n);return new r.a({id:Object(i.getUserId)(e)||t,avatar:Object(i.getAvatar)(e),firstName:Object(i.getFirstName)(e),email:Object(i.getEmail)(e),lastName:Object(i.getLastName)(e),senderType:o})})},"2aGJ":function(e,t,n){var a=n("fwVr"),r="__lodash_hash_undefined__",i=Object.prototype.hasOwnProperty;function o(e){var t=this.__data__;if(a){var n=t[e];return n===r?void 0:n}return i.call(t,e)?t[e]:void 0}e.exports=o},"3+Oy":function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n("BjQQ"),r=n("ib5I"),i=Object(a.a)("gdpr"),o=Object(r.a)([i],Object(a.a)("hasVisitorGivenConsentToProcess"))},"32t3":function(e,t,n){"use strict";n.r(t);n.d(t,"attachmentUploadStart",function(){return i});var a=n("CRij"),r=n("bDpH"),i=Object(a.createAction)(r.d)},"3ApS":function(e,t,n){"use strict";n.r(t);n.d(t,"shouldRecordImplicitConsentToProcess",function(){return c});var a=n("ib5I"),r=n("HRPO"),i=n("ecbq"),o=n("qeXV"),s=n("3+Oy"),c=Object(a.a)([o.getLatestWidgetData,s.a],function(e,t){return Object(r.gdprConsentToProcessEnabled)(e)&&!Object(i.gdprExplicitConsentRequired)(e)&&!t})},"3L1q":function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];"function"==typeof e&&e.apply(void 0,n)}},"3R6H":function(e,t,n){"use strict";n.d(t,"a",function(){return h});var a=n("ib5I"),r=n("BjQQ"),i=n("eg8c"),o=n("23q4"),s=n("RS+R"),c=n("YhCZ"),u=n("9VMc"),l=n("lGcn"),d=n("pnsR"),p=Object(r.a)("subscriptions"),h=Object(a.a)([u.getAsyncStagedThread,s.getAsyncPubSubClient,c.hasPersistedThreads,p,l.a,d.a],function(e,t,n,a,r,s){return!Object(i.isStarted)(e)&&(!(!Object(i.isUninitialized)(e)||n)||!(!Object(i.isSucceeded)(r)&&!Object(i.isUninitialized)(r)||!Object(i.isSucceeded)(s)&&!Object(i.isUninitialized)(s))&&(!!(n&&Object(o.isClientReady)(t)&&Object(i.isSucceeded)(a))||!!(Object(i.isSucceeded)(e)&&Object(o.isClientReady)(t)&&Object(i.isSucceeded)(a))))})},"3mCc":function(e,t,n){"use strict";var a=n("PvDV"),r=n("y4Zp"),i=n.n(r),o=n("ZQ2w"),s=n.n(o),c=n("OCxt"),u=n("10Vg").h,l=n("ZVA3"),d=c.e.div.withConfig({displayName:"VizExNanoProgress__Bar",componentId:"vrf6zp-0"})(["transition:width 0.2s ease-in-out;left:0;position:absolute;top:0;opacity:",";width:",";height:3px;z-index:",";background-color:",";"],function(e){return 0===e.value?0:1},function(e){return e.value+"%"},function(e){return e.zIndex},function(e){var t=e.theme;return u(t)}),p=function(e){var t=e.zIndex,n=e.value,r=e.theme,i=Object(a.a)(e,["zIndex","value","theme"]);return s.a.createElement(d,Object.assign({},i,{"aria-valuemax":100,"aria-valuemin":0,"aria-valuenow":n,role:"progressbar",zIndex:t,value:n,theme:r}))};p.propTypes={theme:l.a,value:i.a.number,zIndex:i.a.number};p.defaultProps={zIndex:10,value:0};p.displayName="VizExNanoProgress";t.a=p},"42Z2":function(e,t,n){"use strict";var a=n("b2e+"),r=n("+jHl"),i=n("rkDb"),o=n("6+o1"),s=n("ib5I"),c=n("D1/i"),u=n("etd5");u.a.implement(Array,function(e,t){return o.Iterable.isIterable(e)?t.concat(e.toJS()):t.concat(e)});u.a.implementInherited(o.Seq.Indexed,function(e,t){return t.concat(e)});u.a.implementInherited(o.Collection.Indexed,function(e,t){return t.concat(e)});u.a.implement(String,function(e,t){return t.concat(e)});var l,d=u.a,p=Object(c.a)(d),h=n("A3tK"),m=n("iRI7"),b=n("qENm"),f=n("cep6"),g=n("826o"),v=n("6uLn"),O=n("6yZo");n.d(t,"a",function(){return j});var j=Object(s.a)([f.a,v.a,b.a,O.a],function(e,t,n,s){var c=Object(i.getChannelName)(e),u=Object(i.getThreadId)(e),d=Object(a.b)(t)||Object(o.List)(),b=Object(m.a)(p(d),p(n),Object(h.a)(Object(r.wrapFailedMessage)({threadId:u,channel:c})),p(s))(Object(o.List)()),f=b.size?b.filter(g.isSupportedMessageType):Object(o.List)();Object(o.is)(l,f)||(l=f);return l})},"4Fvb":function(e,t,n){"use strict";var a=n("xq+X");t.a=Object(a.a)(["meetingsLinkUrl"])},"4o4y":function(e,t,n){"use strict";var a=n("6+o1"),r=Object(a.Record)({tileBackgroundColor:"rgba(255, 255, 255, 1)"},"FileAttachmentTheme");t.a=r},"5Dxy":function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n("0U3V"),r=n("nncj"),i=n("rkDb"),o=n("oEjG"),s=function(e){var t=e.attachment,n=e.thread;return function(e){var s=Object(i.getThreadId)(n),c=Object(a.getLocalId)(t);e(Object(o.removeAttachment)({localId:c,threadId:s}));e(Object(r.trackInteraction)("remove-staged-attachment",{action:"remove staged attachment"}))}}},"5EC7":function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n("/ceY"),r=n("ib5I"),i=n("u70c"),o=n("42Z2"),s=!1,c=Object(r.a)([o.a],function(e){return Object(a.insertDatesIntoMessageList)(e,i.a,s)})},"5EvN":function(e,t){function n(e){var t=this.has(e)&&delete this.__data__[e];this.size-=t?1:0;return t}e.exports=n},"6uLn":function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n("CPNZ"),r=n("ib5I"),i=n("pnsR"),o=n("V/zO"),s=n("9VMc"),c=n("sjvu"),u=Object(r.a)([o.getCurrentThreadId,i.a,s.getStagedThreadHistory],function(e,t,n){return e===c.a?n:Object(a.a)(t)||null})},"6uUH":function(e,t){function n(e,t){return e===t||e!=e&&t!=t}e.exports=n},"6yZo":function(e,t,n){"use strict";var a=n("qBhh"),r=n("Txxr"),i=n("nRUj"),o=n("ib5I"),s=n("cep6"),c=n("PRHD"),u=Object(o.a)([function(e){return e},s.a],function(e,t){return Object(c.a)(e,{thread:t})}),l=n("V/zO"),d=n("6+o1"),p=n("SXe/"),h=n("mXvI"),m=n("DbbD");n.d(t,"a",function(){return b});var b=Object(o.a)([u,l.getCurrentThreadId],function(e,t){if(!e||!t)return Object(d.List)();var n=Object(r.agentTypeToCMFSenderType)(Object(i.getAgentType)(e),!0),o=Object(m.a)(n);return Object(d.List)([new p.a({id:Object(h.generateUuid)(),typingState:null,sender:Object(a.a)({"@type":n},o,Object(i.getUserId)(e))})])})},"7+AW":function(e,t,n){"use strict";n.r(t);n.d(t,"trackSendMessage",function(){return r});var a=n("nncj"),r=function(e){var t=e.threadId;return function(e){var n={};"number"==typeof t&&(n.threadId=t);e(Object(a.trackInteraction)("send-message",n))}}},"7RMX":function(e,t,n){var a=n("fwVr"),r=Object.prototype.hasOwnProperty;function i(e){var t=this.__data__;return a?void 0!==t[e]:r.call(t,e)}e.exports=i},"826o":function(e,t,n){"use strict";n.r(t);n.d(t,"isSupportedMessageType",function(){return l});var a=n("rgv4"),r=n("mNNF"),i=n("fWsJ"),o=n("NFcK"),s=n("u70c"),c=n("4Oo9"),u=n("N7U+"),l=function(e){if(e instanceof a.a||e instanceof r.a){e=Object(i.a)(e);if(Object(c.getSenderType)(e)!==u.e)return!1}if(Object(o.a)(e))return!1;var t=Object(c.getType)(e);return Object.keys(s.a).some(function(e){return e===t})}},"8cQJ":function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n("ib5I"),r=n("4Fvb"),i=n("sdvt"),o=Object(a.a)([i.getAssignedResponderInWidget],function(e){return Boolean(e&&Object(r.a)(e))})},"8fPJ":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n("FT30"),r=n("MscV"),i=function(e){return Object(a.buildSenderLocator)(Object(r.getType)(e),Object(r.getId)(e))}},"9H+j":function(e,t,n){"use strict";n.r(t);n.d(t,"updateSessionId",function(){return i});var a=n("CRij"),r=n("lPFy"),i=Object(a.createAction)(r.b,function(e){return{sessionId:e}})},"9J2q":function(e,t,n){var a=n("wzyz")(n("QN3r"),"Map");e.exports=a},"9O5s":function(e,t,n){"use strict";n.r(t);n.d(t,"getMessageId",function(){return o});var a=n("ib5I"),r=n("BjQQ"),i=n("8XG9"),o=Object(a.a)(i.a,Object(r.a)("id"))},AXPb:function(e,t,n){"use strict";var a=n("6+o1"),r="<<anonymous>>",i={listOf:d,mapOf:h,orderedMapOf:m,setOf:b,orderedSetOf:f,stackOf:g,iterableOf:v,recordOf:O,shape:y,contains:y,mapContains:C,list:c("List",a.List.isList),map:c("Map",a.Map.isMap),orderedMap:c("OrderedMap",a.OrderedMap.isOrderedMap),set:c("Set",a.Set.isSet),orderedSet:c("OrderedSet",a.OrderedSet.isOrderedSet),stack:c("Stack",a.Stack.isStack),seq:c("Seq",a.Seq.isSeq),record:c("Record",function(e){return e instanceof a.Record}),iterable:c("Iterable",a.Iterable.isIterable)};function o(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":e instanceof a.Iterable?"Immutable."+e.toSource().split(" ")[0]:t}function s(e){function t(t,n,a,i,o,s){for(var c=arguments.length,u=Array(c>6?c-6:0),l=6;l<c;l++)u[l-6]=arguments[l];s=s||a;i=i||r;return null!=n[a]?e.apply(void 0,[n,a,i,o,s].concat(u)):t?new Error("Required "+o+" `"+s+"` was not specified in `"+i+"`."):void 0}var n=t.bind(null,!1);n.isRequired=t.bind(null,!0);return n}function c(e,t){function n(n,a,r,i,s){var c=n[a];if(!t(c)){var u=o(c);return new Error("Invalid "+i+" `"+s+"` of type `"+u+"` supplied to `"+r+"`, expected `"+e+"`.")}return null}return s(n)}function u(e,t,n){function a(a,r,i,s,c){for(var u=arguments.length,l=Array(u>5?u-5:0),d=5;d<u;d++)l[d-5]=arguments[d];var p=a[r];if(!n(p)){var h=s,m=o(p);return new Error("Invalid "+h+" `"+c+"` of type `"+m+"` supplied to `"+i+"`, expected an Immutable.js "+t+".")}if("function"!=typeof e)return new Error("Invalid typeChecker supplied to `"+i+"` for propType `"+c+"`, expected a function.");for(var b=p.toArray(),f=0,g=b.length;f<g;f++){var v=e.apply(void 0,[b,f,i,s,c+"["+f+"]"].concat(l));if(v instanceof Error)return v}}return s(a)}function l(e){function t(t,n,a,r,i){for(var o=arguments.length,s=Array(o>5?o-5:0),c=5;c<o;c++)s[c-5]=arguments[c];var u=t[n];if("function"!=typeof e)return new Error("Invalid keysTypeChecker (optional second argument) supplied to `"+a+"` for propType `"+i+"`, expected a function.");for(var l=u.keySeq().toArray(),d=0,p=l.length;d<p;d++){var h=e.apply(void 0,[l,d,a,r,i+" -> key("+l[d]+")"].concat(s));if(h instanceof Error)return h}}return s(t)}function d(e){return u(e,"List",a.List.isList)}function p(e,t,n,a){function r(){for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return u(e,n,a).apply(void 0,i)||t&&l(t).apply(void 0,i)}return s(r)}function h(e,t){return p(e,t,"Map",a.Map.isMap)}function m(e,t){return p(e,t,"OrderedMap",a.OrderedMap.isOrderedMap)}function b(e){return u(e,"Set",a.Set.isSet)}function f(e){return u(e,"OrderedSet",a.OrderedSet.isOrderedSet)}function g(e){return u(e,"Stack",a.Stack.isStack)}function v(e){return u(e,"Iterable",a.Iterable.isIterable)}function O(e){function t(t,n,r,i,s){for(var c=arguments.length,u=Array(c>5?c-5:0),l=5;l<c;l++)u[l-5]=arguments[l];var d=t[n];if(!(d instanceof a.Record)){var p=o(d);return new Error("Invalid "+i+" `"+s+"` of type `"+p+"` supplied to `"+r+"`, expected an Immutable.js Record.")}for(var h in e){var m=e[h];if(m){var b=d.toObject(),f=m.apply(void 0,[b,h,r,i,s+"."+h].concat(u));if(f)return f}}}return s(t)}function j(e){var t=void 0===arguments[1]?"Iterable":arguments[1],n=void 0===arguments[2]?a.Iterable.isIterable:arguments[2];function r(a,r,i,s,c){for(var u=arguments.length,l=Array(u>5?u-5:0),d=5;d<u;d++)l[d-5]=arguments[d];var p=a[r];if(!n(p)){var h=o(p);return new Error("Invalid "+s+" `"+c+"` of type `"+h+"` supplied to `"+i+"`, expected an Immutable.js "+t+".")}var m=p.toObject();for(var b in e){var f=e[b];if(f){var g=f.apply(void 0,[m,b,i,s,c+"."+b].concat(l));if(g)return g}}}return s(r)}function y(e){return j(e)}function C(e){return j(e,"Map",a.Map.isMap)}e.exports=i},B948:function(e,t,n){"use strict";n.r(t);n.d(t,"buildVisitorCommonMessage",function(){return h});var a=n("qBhh"),r=n("N7U+"),i=n("XGeH"),o=n("DbbD"),s=n("I0Yy"),c=n("12I0"),u=n("mXvI"),l=n("Ybsy"),d=n("ryNe"),p=n("rkDb"),h=function(e){var t,n=e.clientType,h=e.fileAttachment,m=e.quickReply,b=e.richText,f=e.senderId,g=e.text,v=e.thread,O=Object(p.getSource)(v),j=Object(s.b)(r.e),y=Object(o.a)(j),C=[];h&&C.push(h);m&&C.push(new i.a(m));return Object(d.buildCommonMessage)({status:{source:O,messageStatus:l.b},clientType:n,attachments:C,text:g,richText:b,id:Object(u.generateUuid)(),sender:(t={},Object(a.a)(t,c.p,j),Object(a.a)(t,y,f),t)})}},BBNf:function(e,t,n){"use strict";var a=n("ibZn"),r=n("5Dxy"),i=n("Qu2R"),o=n("Ta4D"),s=n("Gbx4"),c=n("3R6H"),u=n("ib5I"),l=n("eg8c"),d=n("RS+R"),p=Object(u.a)([d.getAsyncPubSubClient],l.isFailed),h=n("cep6"),m=n("zC+/"),b=n("L6i2"),f=n("RPTv"),g=n("GAhl"),v=n("rXC1"),O=n("ilp/"),j=n("999m"),y=n("/bxT"),C=n("E53m"),x=n("KMxH"),T=n("MS0j"),k=n("HmhQ"),E=n("Pett"),w=n("xq+X"),I=Object(w.a)(["isAttachmentDisabled"]),R=n("TcSF"),S=Object(u.a)([R.a],function(e){return I(e)}),A=n("bz7q"),M=n("BjQQ"),P=function(e){return Object(M.a)("messageEditorStaging",e)},N=n("7RmY"),q=function(e,t){return Object(w.a)([e,N.a],t)},_=Object(u.a)(A.getSelectedThreadId,P,function(e,t){return q(e,t)}),F=n("CRij"),D=n("2n97"),L=Object(F.createAction)(D.H,function(e){return e}),B=Object(F.createAction)(D.A),z=function(e){return function(t,n){t(L({stagingText:e,threadId:Object(A.getSelectedThreadId)(n())}))}},U=function(){return function(e,t){e(B(Object(A.getSelectedThreadId)(t())))}},H=n("E+Od"),V=n("Qq8X"),Q=n("+Tc3"),W=n("e1jc"),Z=function(e){var t=Object(h.a)(e),n=!Object(C.a)(e,{thread:t})&&Object(g.a)(e,{thread:t}),a=Object(x.getIsBot)(e)&&Object(W.getIsWidgetInAwayMode)(e)&&!Object(Q.isPersistedThread)(t);return{coloring:Object(m.a)(e),currentConversation:t,disablePublish:!Object(c.a)(e),disableTextInput:n||a,showQuickReplyPlaceholder:n,isOnFocus:Object(E.a)(e),stagedMessage:_(e),messagesPageUri:Object(b.getMessagesPageUri)(e),networkOffline:p(e),showingHsBranding:Object(f.a)(e),showInitialMessageBubble:Object(y.a)(e),stagedAttachments:Object(o.a)(e),mobile:Object(T.getIsMobile)(e),shouldDisableAttachment:S(e),shouldSendInputStagingEvent:Object(V.a)()}},G={closeInitialMessageBubble:j.a,inputStagingEvent:H.a,onRemoveAttachment:r.a,onSelectAttachmentFile:i.a,publishMessage:s.a,publishTypingMessage:v.a,toggleOnAndOffInputFocus:k.a,setMessageEditorStagingText:z,removeMessageEditorStagingText:U};t.a=Object(a.b)(Z,G)(O.a)},BOd2:function(e,t,n){var a=n("QWT7");function r(e){return a(this,e).get(e)}e.exports=r},BX77:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a="WEB"},BaOL:function(e,t,n){"use strict";n.r(t);n.d(t,"attachmentUploadProgress",function(){return i});var a=n("CRij"),r=n("bDpH"),i=Object(a.createAction)(r.c)},BvgU:function(e,t,n){"use strict";var a=n("NbFO"),r="\\.",i='\\s\\?\\#\\/\\(\\)\\=\\:\\;\\@\\\\"'+r,o="(?:www"+r+")",s="(?:[%a-zA-Z0-9_-]+)",c="(?:(?:\\.[%a-zA-Z0-9-]+)[^\\.\\s])",u="\\s\\?\\#\\&",l=new RegExp("^(?:.+)@"+{www:o,domain:o+"?(?:(?:[^"+i+"]+)"+r+")+(?:[^"+i+"]+)",protocol:"(?:(?:https?:)?\\/\\/)",protocolRequired:"(?:https?:\\/\\/)",path:"(?:(?:\\/[^\\s\\/\\#\\&\\?]*)+\\/?)",wildcardPath:"(?:(/(?:[%a-zA-Z0-9_-])*?)*(?:/[\\*]))",file:""+s+c,fileName:s,fileExtension:c,search:"(?:([\\?&#][^"+u+"]*?=?([^"+u+"]*))+)",ungroupedSearch:"(?:(?:[\\?&#][^"+u+"]*?=?(?:[^"+u+"]*))+)"}.domain+"$");t.a=Object(a.a)({name:"EmailAddress",validator:function(e){return l.test(e)}})},DHw3:function(e,t,n){"use strict";n.r(t);n.d(t,"clickedConsentToProcess",function(){return b});n.d(t,"consentToProcessSucceeded",function(){return f});n.d(t,"consentToProcessFailed",function(){return g});n.d(t,"consentToProcess",function(){return v});var a=n("CRij"),r=n("4scq"),i=n("Dho5"),o=n("xOvp"),s=n("9O5s"),c=n("xqCo"),u=n("Jtvd"),l=n("gmfO"),d=n("9H+j"),p=n("/A3W"),h=n("nncj"),m=n("qeXV"),b=Object(a.createAction)(i.d),f=Object(a.createAction)(i.f),g=Object(a.createAction)(i.e);function v(){return function(e,t){var n=Object(o.getSessionId)(t()),a=Object(s.getMessageId)(t()),i=Object(p.getHubspotUtk)(t()),v=Object(m.getLatestWidgetData)(t());e(b());Object(c.sendConsentToProcess)({sessionId:n,hubspotUtk:i,welcomeMessageId:a,widgetData:v}).then(function(n){var a=n.sessionId;Object(l.gdprCookieConsentOnExitIntentEnabled)(t(),v)||e(Object(u.handleStoreMessagesCookie)(Object(r.getMessagesUtk)(t())));e(Object(d.updateSessionId)(a));e(f());e(Object(h.trackInteraction)("widget-interaction",{action:"clicked consent to process button"}))},function(t){return e(g({error:t}))}).done()}}},DZ7b:function(e,t,n){"use strict";var a=n("gjBT"),r=n("u1T7"),i=n("2hC2"),o=n("8PIh"),s=n("G/XJ"),c=n("E7sj"),u=n.n(c),l=n("Kb5M"),d=n("y4Zp"),p=n.n(d),h=n("ZQ2w"),m=n.n(h),b=n("nU4D"),f=n.n(b),g=n("OCxt"),v=n("DM3q"),O=n("u9LH"),j=n("PvDV"),y=["left","right"],C=["top","bottom"],x=y.concat(C).concat(["left top","left bottom","right top","right bottom","top left","top right","bottom left","bottom right","top center","bottom center","left middle","right middle"]);function T(e){return e.split(" ")[0]}function k(e){return y.includes(e)}function E(e){var t=e.split(" ")[1];return t||(k(T(e))?"middle":"center")}var w=16,I=8,R=function(e){switch(T(e.placement)){case"top":return Object(g.d)(["transform:rotate(45deg);top:-","px;"],w+5);case"right":return Object(g.d)(["transform:rotate(135deg);right:-","px;"],w+5);case"bottom":return Object(g.d)(["transform:rotate(-135deg);bottom:-","px;"],w+5);case"left":return Object(g.d)(["transform:rotate(-45deg);left:-","px;"],w+5);default:return""}},S=function(e){switch(E(e.placement)){case"top":return Object(g.d)(["top:","px;"],I);case"middle":return Object(g.d)(["top:calc(50% - ","px);"],w/2);case"bottom":return Object(g.d)(["bottom:","px;"],I);case"left":return Object(g.d)(["left:","px;"],I);case"center":return Object(g.d)(["left:calc(50% - ","px);"],w/2);case"right":return Object(g.d)(["right:","px;"],I);default:return""}},A=function(e){var t=e.placement;return Object(g.d)(["",";",";"],R({placement:t}),S({placement:t}))},M=n("XMjd"),P="#425b76",N=function(){return P},q=function(){return M.l},_=g.e.div.withConfig({displayName:"VizExTooltipArrow",componentId:"myy70c-0"})(["position:absolute;pointer-events:none;border:none;clip-path:polygon(100% 100%,0 100%,100% 0);border-top-left-radius:100%;border-radius:3px;border-top-color:transparent !important;border-left-color:transparent !important;border-bottom-right-radius:3px;width:16px;height:16px;background-color:",";",""],function(e){var t=e.theme;return N(t)},A),F=16,D=function(e){switch(E(e.placement)){case"top":return Object(g.d)(["top:0;"]);case"bottom":return Object(g.d)(["bottom:0;"]);case"left":return Object(g.d)(["left:0;"]);case"right":return Object(g.d)(["right:0;"]);default:return""}},L=function(e){switch(T(e.placement)){case"top":return Object(g.d)(["transform:translateY(-100%);top:-","px;"],F-5);case"right":return Object(g.d)(["transform:translateX(100%);right:-","px;"],F-5);case"bottom":return Object(g.d)(["transform:translateY(100%);bottom:-","px;"],F-5);case"left":return Object(g.d)(["transform:translateX(-100%);left:-","px;"],F-5);default:return""}},B=function(e){switch(e.placement){case"top center":case"top middle":return Object(g.d)(["transform:translate(-50%,-100%);left:50%;"]);case"bottom middle":case"bottom center":return Object(g.d)(["transform:translate(-50%,100%);left:50%;"]);case"left center":case"left middle":return Object(g.d)(["transform:translate(-100%,-50%);top:50%;"]);case"right center":case"right middle":return Object(g.d)(["transform:translate(100%,-50%);top:50%;"]);default:return""}},z=function(e){var t=e.placement;return Object(g.d)(["",";",";",""],L({placement:t}),D({placement:t}),B({placement:t}))},U=g.e.div.withConfig({displayName:"VizExTooltipBody",componentId:"qy3p0o-0"})(["border-radius:3px;font-size:13px;max-width:232px;display:block;position:absolute;visibility:visible;box-shadow:0 3px 8px rgba(0,0,0,0.1);line-height:1.5;padding:10px 16px;text-decoration:none;word-wrap:break-word;",";white-space:nowrap;background-color:",";color:",";pointer-events:",";"],z,function(e){var t=e.theme;return N(t)},function(e){var t=e.theme;return q(t)},function(e){return e.open?"all":"none"}),H=n("ZVA3"),V=n("3L1q"),Q=g.e.div.withConfig({displayName:"VizExTooltip__Popover",componentId:"qngada-0"})(["transition-property:",";transition-duration:","ms;opacity:",";transform:",";position:absolute;pointer-events:none;width:100%;height:100%;"],function(e){return e.transitioning?"opacity ease-out, transform ease-out":"none"},function(e){return e.duration},function(e){return e.open?"1":"0"},function(e){var t=e.open,n=e.transitioning;return t&&!n?"none":t?"scale(1)":"scale(.75)"}),W=g.e.div.withConfig({displayName:"VizExTooltip__PopoverWrapper",componentId:"qngada-1"})(["display:inline-block;position:relative;"]),Z=function(e){var t=e.content,n=e.backgroundColor,a=e.textColor,r=e.placement,i=e.children,o=e.theme,s=e.onOpenChange,c=e.open,u=Object(j.a)(e,["content","backgroundColor","textColor","placement","children","theme","onOpenChange","open"]),l=Object(h.useState)(!1),d=Object(O.a)(l,2),p=d[0],b=d[1];if(!t)return i;var f="boolean"==typeof c,g=function(){if(!f){Object(V.a)(s,!0);b(!0)}},v=function(){if(!f){Object(V.a)(s,!1);b(!1)}},y=f?c:p;return m.a.createElement(W,Object.assign({},u,{onMouseEnter:g,onMouseLeave:v}),m.a.createElement(Q,{open:y,duration:250,transitioning:!0},m.a.createElement(U,{textColor:a,backgroundColor:n,placement:r,open:y,theme:o,"data-test-open":y},t),m.a.createElement(_,{backgroundColor:n,placement:r,theme:o})),i)};Z.propTypes={backgroundColor:p.a.string,children:p.a.node,content:p.a.node,onOpenChange:p.a.func,open:p.a.bool,placement:p.a.oneOf(x),textColor:p.a.string,theme:H.a};Z.displayName="VizExTooltip";Z.defaultProps={placement:"top right"};var G=Z,K=n("SxW6"),X=n("S8ql"),Y=g.e.input.withConfig({displayName:"AttachmentPickerButton__HiddenInput",componentId:"mj74yt-0"})(["display:none;"]),J=function(e){Object(s.a)(t,e);function t(e){var n;Object(a.a)(this,t);(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).inputRefCallback=function(e){n.inputRef=e};n.findInputNode=function(){return n.inputRef?f.a.findDOMNode(n.inputRef):null};n.clearInputNode=function(){var e=n.findInputNode();e&&(e.value="")};n.handlePickerClick=function(e){var t=n.findInputNode();t&&t.click();n.props.onClick(e)};n.onInputChange=function(e){var t=e.target.files;n.props.onSelectFiles({files:t});n.clearInputNode()};n.renderMaxFileSizeTooltip=function(){if(!n.props.mobile)return m.a.createElement(l.a,{message:"conversations-visitor-ui.fileSizeLimit",options:{size:u.a.formatSize(n.props.maxAttachmentFileSize)}})};n.inputRef=null;return n}Object(r.a)(t,[{key:"render",value:function(){var e=this.props.disabled;return m.a.createElement(m.a.Fragment,null,m.a.createElement(G,{content:this.renderMaxFileSizeTooltip(),placement:"top center"},m.a.createElement(v.a,{disabled:e,onClick:this.handlePickerClick,use:"transparent-on-background","aria-label":u.a.text("conversations-visitor-ui.visitorExperienceAriaLabels.attachment"),shape:"circle"},m.a.createElement(K.a,{icon:m.a.createElement(X.a,null)}))),m.a.createElement(Y,{accept:this.props.accept.join(","),"data-selenium-test":"visitor-attachment-file-input",disabled:this.props.disabled,ref:this.inputRefCallback,type:"file",multiple:this.props.allowMultiple,onChange:this.onInputChange}))}}]);return t}(m.a.PureComponent);J.displayName="AttachmentPickerButton";J.propTypes={accept:p.a.arrayOf(p.a.string).isRequired,allowMultiple:p.a.bool.isRequired,disabled:p.a.bool,maxAttachmentFileSize:p.a.number.isRequired,mobile:p.a.bool,onClick:p.a.func,onSelectFiles:p.a.func.isRequired};J.defaultProps={accept:[],allowMultiple:!1,onClick:function(){}};t.a=J},DyWv:function(e,t,n){"use strict";var a=n("gjBT"),r=n("u1T7"),i=n("2hC2"),o=n("8PIh"),s=n("G/XJ"),c=n("ibZn"),u=n("y4Zp"),l=n.n(u),d=n("E7sj"),p=n.n(d),h=n("ZQ2w"),m=n.n(h),b=n("u9LH"),f=n("OCxt"),g=n("g99b"),v=n("Kb5M"),O=n("NiVr"),j=n("GME8"),y=n("y9R5"),C=n("zbXb"),x=n("KUC+"),T=f.e.div.withConfig({displayName:"ConsentModal__ConsentModalContainer",componentId:"tnptns-0"})(["position:absolute;display:flex;align-items:flex-start;justify-content:center;height:calc(100% - ","px);top:","px;width:100%;background-color:rgba(45,62,80,0.79);backdrop-filter:blur(2px);padding-top:20%;border-bottom-left-radius:","px;border-bottom-right-radius:","px;overflow-y:hidden;"],C.d,C.d,y.a,y.a),k=f.e.div.withConfig({displayName:"ConsentModal__ContentContainer",componentId:"tnptns-1"})(["display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;padding:12px 24px;background-color:white;border-radius:3px;box-shadow:0 2px 4px -1px rgba(0,0,0,0.75);margin:0 20px;"]),E=Object(f.e)(x.a).withConfig({displayName:"ConsentModal__SmallNoParagraphPadding",componentId:"tnptns-2"})(["display:block;word-break:break-word;word-wrap:break-word;-ms-word-break:break-all;p{margin-bottom:0;}"]),w=Object(f.e)(g.a).withConfig({displayName:"ConsentModal__FullWidthButton",componentId:"tnptns-3"})(["padding:9px 16px;flex:0 1 100%;&:not(:first-child){margin-left:8px;}"]),I=f.e.div.withConfig({displayName:"ConsentModal__ButtonsContainer",componentId:"tnptns-4"})(["display:flex;flex-direction:row;margin:12px 0 0 0;width:100%;"]),R=f.e.p.withConfig({displayName:"ConsentModal__Header",componentId:"tnptns-5"})(["text-transform:none;font-size:18px;font-weight:500;margin-top:18px;margin-bottom:12px;line-height:normal;"]),S=function(e){var t=e.headerMessage,n=e.message,a=e.onClick,r=e.onDeclineClick,i=Object(h.useState)({isEntering:!0,shouldRender:!0,callback:function(){}}),o=Object(b.a)(i,2),s=o[0],c=o[1],u=function(){if(!s.isEntering){s.callback();c(Object.assign({},s,{shouldRender:!1}))}},l=function(e){c(Object.assign({},s,{isEntering:!1,callback:e}))};return s.shouldRender?m.a.createElement(T,{style:{animation:(s.isEntering?"consent-modal-background-fadeIn":"consent-modal-background-fadeOut")+" .3s"},"data-test-id":"gdpr-consent-prompt-container",onAnimationEnd:u,key:Math.random+"-consent-modal-container"},m.a.createElement(j.a,null,function(e){return m.a.createElement(k,{key:"consent-modal-content-container","data-test-id":"gdpr-consent-prompt",style:{animation:(s.isEntering?"consent-modal-content-fadeIn":"consent-modal-content-fadeOut")+" .3s"}},t&&m.a.createElement(R,null,t),m.a.createElement(E,{use:"help","data-test-id":"gdpr-consent-text",dangerouslySetInnerHTML:{__html:Object(O.a)(n)}}),m.a.createElement(I,null,m.a.createElement(w,{onClick:function(){l(a)},"data-test-id":"gdpr-consent-agree-button",use:"primary"},m.a.createElement(v.a,{message:"conversations-visitor-experience-components.buttons.agree",options:{locale:e}})),m.a.createElement(w,{onClick:function(){l(r)},"data-test-id":"gdpr-consent-dismiss-button"},m.a.createElement(v.a,{message:"conversations-visitor-experience-components.buttons.disagree",options:{locale:e}}))))})):null};S.defaultProps={animationTimeMs:300,onClick:function(){},onDeclineClick:function(){}};S.propTypes={headerMessage:l.a.node,message:l.a.string.isRequired,onClick:l.a.func.isRequired,onDeclineClick:l.a.func.isRequired};S.displayName="ConsentModal";var A=S,M=n("p7yW"),P=n("nncj"),N=n("lEuo"),q=n("CWLX"),_=n("gmfO"),F=n("QaKq");function D(){return function(e,t){(Object(_.gdprCookieConsentOnExitIntentEnabled)(t())||Object(F.getAPIEnableWidgetCookieBannerOnExitIntent)(t()))&&e(Object(q.a)(!1));e(Object(P.trackInteraction)("widget-interaction",{action:"clicked decline cookies button"}))}}var L=n("zC+/"),B=n("+UqK"),z=n("qeXV"),U=n("Yuqq"),H=function(e){Object(s.a)(t,e);function t(){Object(a.a)(this,t);return Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}Object(r.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.trackInteraction)("widget-interaction",{action:"view consent to cookies"})}},{key:"render",value:function(){var e=this;return m.a.createElement(j.a,null,function(t){return e.props.isExitIntentPrompt?m.a.createElement(A,{headerMessage:m.a.createElement(v.a,{message:"conversations-visitor-ui.gdpr.consentToCookies.promptHeader",options:{locale:t}}),message:p.a.text("conversations-visitor-ui.gdpr.consentToCookies.exitIntentCookieConsent",{locale:t}),onDeclineClick:e.props.declineCookies,onClick:e.props.consentToCookies,coloring:e.props.coloring}):m.a.createElement(M.a,{message:p.a.text("conversations-visitor-ui.gdpr.consentToCookies.pageLoadCookieConsent",{locale:t}),onDeclineClick:e.props.declineCookies,onClick:e.props.consentToCookies,coloring:e.props.coloring,showButton:!0})})}}]);return t}(h.Component);H.displayName="CookieConsentPrompt";H.propTypes={coloring:Object(B.a)("ColoringRecord"),consentToCookies:l.a.func.isRequired,declineCookies:l.a.func.isRequired,isExitIntentPrompt:l.a.bool.isRequired,trackInteraction:l.a.func.isRequired};var V={consentToCookies:N.a,declineCookies:D,trackInteraction:P.trackInteraction},Q=function(e){return{coloring:Object(L.a)(e),widgetData:Object(z.getLatestWidgetData)(e),isExitIntentPrompt:Object(_.gdprCookieConsentOnExitIntentEnabled)(e)&&!Object(U.getAPIEnableWidgetCookieBanner)(e)}};t.a=Object(c.b)(Q,V)(H)},"E+Od":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n("wjj1"),r=n("Wjp6"),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){n(Object(a.postExternalApiEvent)({eventType:r.d,payload:{visitorMessageData:e,isEmptyInput:t}}))}}},E53m:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n("ib5I"),r=n("KGLF"),i=n("PZjN"),o=n("hjlb"),s=n("pfqe"),c=n("Aomi"),u=Object(a.a)([r.historyDataForThread],function(e){if(!e||!Object(c.hasMessages)(e))return!0;var t=Object(o.a)(e).filter(function(e){return Object(i.isChatMessage)(e)||Object(i.isInitialMessage)(e)}).last();return Object(s.c)(t)})},E6l7:function(e,t,n){"use strict";var a=n("gjBT"),r=n("u1T7"),i=n("2hC2"),o=n("8PIh"),s=n("Cdni"),c=n("G/XJ"),u=n("y+AS"),l=n.n(u),d=n("0U3V"),p=n("O1Zz"),h=n("+UqK"),m=n("gwgA"),b=n("E7sj"),f=n.n(b),g=n("6+o1"),v=n("y4Zp"),O=n.n(v),j=n("ZQ2w"),y=n.n(j),C=n("nU4D"),x=n.n(C),T=n("OCxt"),k=T.e.div.withConfig({displayName:"MessageComposer__FullWidth",componentId:"hqlj4f-0"})(["width:100%;"]),E=T.e.div.withConfig({displayName:"MessageComposer__InputWrapper",componentId:"hqlj4f-1"})(["display:flex;width:100%;align-items:center;justify-content:space-between;flex-wrap:nowrap;"]),w=function(e){Object(c.a)(t,e);function t(){Object(a.a)(this,t);return Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}Object(r.a)(t,[{key:"render",value:function(){var e="input-container m-bottom-2"+(this.props.showingHsBranding?"":" no-branding");return y.a.createElement("div",{className:e},this.props.fileUploads&&y.a.createElement(k,null,this.props.fileUploads()),y.a.createElement(E,null,this.props.inputToRender(),this.props.children&&y.a.createElement("div",{className:"display-flex flex-row m-left-1 no-shrink"},this.props.children)))}}]);return t}(j.Component);w.propTypes={children:O.a.node,fileUploads:O.a.func,inputToRender:O.a.func.isRequired,showingHsBranding:O.a.bool};w.defaultProps={fileUploads:null,showingHsBranding:!1};w.displayName="MessageComposer";var I=w,R=n("TlSS"),S=y.a.createContext(void 0),A=S.Consumer,M=(S.Provider,n("u9LH")),P=n("PvDV"),N=function(e){Object(j.useEffect)(function(){var t=function(t){if(e(t)){t.stopPropagation();t.preventDefault()}};document.addEventListener("touchmove",t,{passive:!1});return function(){document.removeEventListener("touchmove",t)}},[e])},q=function(){},_=function(e){var t=y.a.forwardRef(function(t,n){var a=t.onBlur,r=t.onFocus,i=Object(P.a)(t,["onBlur","onFocus"]),o=n||Object(j.useRef)(),s=Object(j.useState)(null),c=Object(M.a)(s,2),u=c[0],l=c[1];N(function(e){if(u&&e.target!==u){o.current&&o.current.blur();l(null);return!1}return Boolean(u)});var d=function(e){l(null);a(e)},p=function(e){e.target&&l(e.target);r(e)};return y.a.createElement(e,Object.assign({},i,{ref:o,onFocus:p,onBlur:d}))});t.propTypes={onBlur:O.a.func,onFocus:O.a.func};t.defaultProps={onBlur:q,onFocus:q};t.displayName="Component";return t};_.propTypes={innerRef:O.a.func.isRequired,onBlur:O.a.func.isRequired,onFocus:O.a.func.isRequired};var F=_,D=n("ZVA3"),L=n("KUC+"),B=T.e.div.withConfig({displayName:"VizExFormControl__FormControlWrapper",componentId:"unxire-0"})(["width:100%;flex-basis:100%;"]),z=function(e){Object(c.a)(t,e);function t(){var e,n;Object(a.a)(this,t);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];(n=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(s)))).getChildProps=function(e){var t=e.ariaLabel,n=e.newError,a=e.newRequired,r=e.validationMessage,i=e.fallbackId,o={"aria-label":t,required:a,"aria-invalid":n,"aria-required":a,ref:e.ref};i&&(o.id=i);n&&(o.error=r);return o};return n}Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e["aria-label"],n=e.error,a=e.validationMessage,r=e.required,i=e.theme,o=e.children,s=Object(P.a)(e,["aria-label","error","validationMessage","required","theme","children"]),c=o(Object.assign({},this.getChildProps({ariaLabel:t,newError:n,newRequired:r,validationMessage:a})));return y.a.createElement(B,s,c,a?y.a.createElement(L.a,{use:n?"error":"default",theme:i},a):null)}}]);return t}(y.a.Component);z.displayName="VizExFormControl";z.propTypes={"aria-label":O.a.string,children:O.a.func.isRequired,error:O.a.bool,required:O.a.bool.isRequired,theme:D.a,validationMessage:O.a.node};z.defaultProps={error:!1,required:!1};var U=z,H=n("3L1q"),V=n("10Vg"),Q=V.f,W=V.e,Z=V.c,G=V.a,K=V.b,X=V.g,Y="unstyled",J="default",$=function(e){return(new DOMParser).parseFromString(e,"text/html").body.textContent||""},ee=window.navigator?navigator.userAgent.toLowerCase():"",te=function(){return ee.includes("trident/")},ne=function(e){return""===e.trim()||"<br />"===e.trim()||"<br>"===e.trim()||"<br/>"===e.trim()},ae=function(){return Object(T.d)(["outline:none;"])},re=function(e){var t=e.use,n=e.theme;switch(t){case Y:return Object(T.d)(["border:none;background-color:transparent;"]);case J:default:return Object(T.d)(["border:2px solid;border-color:",";background-color:",";"],Q(n),W(n))}},ie=function(e){var t=e.theme;return Object(T.d)(["cursor:not-allowed;background-color:",";color:",";&[contenteditable][placeholder]:empty::after{color:",";cursor:not-allowed;}"],G(t),K(t),K(t))},oe=function(e){var t=e.theme;return Object(T.d)(["border:2px solid;border-color:",";"],Z(t))},se=T.e.div.withConfig({displayName:"VizExExpandingInput__StyledInput",componentId:"sc-17oasje-0"})(["border-radius:3px;font-size:16px;line-height:22px;min-height:40px;max-height:",";overflow-x:hidden;overflow-y:auto;padding:8px;position:relative;width:100%;flex-basis:100%;word-break:break-word;cursor:text;",";",";@supports (-webkit-touch-callout:none){cursor:pointer;}&[contenteditable][placeholder]:empty{overflow-y:hidden;}&[contenteditable][placeholder]:empty::after{display:block;content:attr(placeholder);position:relative;color:",";background-color:transparent;cursor:text;user-select:none;font-size:16px;line-height:22px;height:22px;}@media all and (-ms-high-contrast:none){&[contenteditable][placeholder]:empty::after{position:absolute;top:50%;transform:translateY(-50%);}}:focus{",";}",";",";"],function(e){var t=e.maxHeight;return"number"==typeof t?t+"px":t||"150px"},function(e){return e.focus&&ae()},re,function(e){var t=e.theme;return X(t)},ae,function(e){return e.disabled&&ie(e)},function(e){return e.error&&oe(e)}),ce=y.a.forwardRef(function(e,t){var n=t||Object(j.useRef)(),a=e.onInput,r=e.placeholder,i=e.onChange,o=e.value,s=e.maxHeight,c=e.disabled,u=e.shouldAutofocus,l=Object(P.a)(e,["onInput","placeholder","onChange","value","maxHeight","disabled","shouldAutofocus"]),d=function(e){e.persist();n.current.innerHTML&&ne(n.current.innerHTML)&&(n.current.innerHTML="");e.target.value=e.target.innerText;for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];H.a.apply(void 0,[i,e].concat(r));H.a.apply(void 0,[a,e].concat(r))},p=function(e){e.preventDefault();var t;try{t=e.clipboardData.getData("text/plain")}catch(n){t=$(e.clipboardData.getData("text"))}document.queryCommandSupported("insertText")?document.execCommand("insertText",!1,t):document.execCommand("paste",!1,t)};Object(j.useLayoutEffect)(function(){null!==o&&void 0!==o&&o!==n.current.innerText&&(n.current.innerText=o)},[n,o]);Object(j.useEffect)(function(){u&&n&&n.current&&n.current.focus()},[]);var h=te()?{onKeyUp:d}:{onInput:d};return y.a.createElement(se,Object.assign({},l,{ref:n,placeholder:r},h,{onPaste:p,contentEditable:!c,maxHeight:s,disabled:c,"aria-disabled":c}))});ce.displayName="VizExExpandingInput";ce.propTypes={disabled:O.a.bool,error:O.a.bool,maxHeight:O.a.number,onChange:O.a.func,onInput:O.a.func,placeholder:O.a.string,shouldAutofocus:O.a.bool,theme:D.a,use:O.a.oneOf([Y,J]),value:O.a.string};var ue=F(ce);function le(e){var t=e.disabled,n=e.error,a=e.messageText,r=e.onChange,i=e.onInputBlur,o=e.onInputFocus,s=e.onKeyDown,c=e.setEditorRef,u=e.validationMessage,l=e.showQuickReplyPlaceholder;return y.a.createElement(A,null,function(e){return y.a.createElement(U,{"aria-label":f.a.text(l?"conversations-visitor-ui.chatTextArea.forceQuickReplyPlaceholder":"conversations-visitor-ui.chatTextArea.placeholder",{locale:e}),validationMessage:u,error:n,required:!0},function(u){return y.a.createElement(ue,Object.assign({},u,{use:"unstyled",error:n,className:"widget-textarea message-box","data-test-id":"widget-textarea",tabIndex:"0",innerRef:c,maxHeight:100,placeholder:f.a.text(l?"conversations-visitor-ui.chatTextArea.forceQuickReplyPlaceholder":"conversations-visitor-ui.chatTextArea.placeholder",{locale:e}),disabled:t,onChange:r,onKeyDown:s,value:a,onFocus:o,onBlur:i,shouldAutofocus:!0}))})})}le.propTypes={disabled:O.a.bool.isRequired,error:O.a.bool.isRequired,messageText:O.a.string.isRequired,onChange:O.a.func.isRequired,onInputBlur:O.a.func,onInputFocus:O.a.func,onKeyDown:O.a.func.isRequired,setEditorRef:O.a.func.isRequired,showQuickReplyPlaceholder:O.a.bool.isRequired,validationMessage:O.a.string.isRequired};le.displayName="TextInput";var de=le,pe=n("rYJd"),he=n("DZ7b"),me=n("9F9a"),be=n("Ogsy"),fe=n("DM3q"),ge=n("T0Ay"),ve=n("SxW6"),Oe=n("pdRT"),je=13,ye=T.e.div.withConfig({displayName:"MessageEditor__FileUploadWrapper",componentId:"sc-8t1ye7-0"})(["display:flex;overflow:auto;& > *:not(:last-child){margin-right:8px;}"]),Ce=function(e){Object(c.a)(t,e);function t(e){var n;Object(a.a)(this,t);(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={messageText:e.stagedMessageEditorText||""};n.handleChange=n.handleChange.bind(Object(s.a)(n));n.handlePublish=n.handlePublish.bind(Object(s.a)(n));n.handleKeyDown=n.handleKeyDown.bind(Object(s.a)(n));n.setEditorRef=n.setEditorRef.bind(Object(s.a)(n));n.focusEditor=n.focusEditor.bind(Object(s.a)(n));n.renderTextInput=n.renderTextInput.bind(Object(s.a)(n));n.renderFileUploads=n.renderFileUploads.bind(Object(s.a)(n));n.handleSelectAttachmentFiles=n.handleSelectAttachmentFiles.bind(Object(s.a)(n));n.editorRef=null;n.onInputFocus=n.onInputFocus.bind(Object(s.a)(n));n.onInputBlur=n.onInputBlur.bind(Object(s.a)(n));return n}Object(r.a)(t,[{key:"componentDidMount",value:function(){this.focusEditor()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){!e.disabled&&this.props.disabled&&this.focusEditor()}},{key:"focusEditor",value:function(){var e=this.editorRef;e&&setTimeout(function(){e.focus()})}},{key:"getMessageText",value:function(){return this.state.messageText}},{key:"messageTextIsWithinLimit",value:function(){return this.getMessageText().length<m.a}},{key:"hasAttachments",value:function(){return this.props.stagedAttachments&&this.props.stagedAttachments.size}},{key:"attachmentsAreValid",value:function(){return!this.props.stagedAttachments||this.props.stagedAttachments.every(p.isUploadCompleted)}},{key:"canUploadAttachment",value:function(){return!this.props.hasUnansweredQuickReplyMessage&&(!this.props.stagedAttachments||!this.props.stagedAttachments.size)}},{key:"messageContentsAreValid",value:function(){var e=this.getMessageText()&&""!==this.getMessageText().trim();return this.messageTextIsWithinLimit()&&this.attachmentsAreValid()&&(e||this.hasAttachments())}},{key:"canPublish",value:function(){var e=this.props,t=e.disabled,n=e.networkOffline,a=e.disablePublish;return this.messageContentsAreValid()&&!n&&!t&&!a}},{key:"handleChange",value:function(e){var t=this.props,n=t.chatInputChanged,a=t.shouldSendInputStagingEvent,r=t.inputStaging,i=e.target.value;this.setState({messageText:i});a&&!i&&r(i,!0);""!==i&&n(i)}},{key:"handleKeyDown",value:function(e){if(e.keyCode===je&&!1===e.shiftKey){this.handlePublish();e.preventDefault();e.stopPropagation();return!1}return!0}},{key:"handlePublish",value:function(){var e=this.props.inputStaging;if(this.canPublish()){var t=this.getMessageText();this.props.publishMessage({text:t,richText:"<div>"+l.a.link(Object(Oe.a)(t),{stripPrefix:!1})+"</div>"});this.setState({messageText:""});e("",!0);var n=this.props,a=n.mobile,r=n.isOnFocus;if(a&&Object(pe.isIOSDevice)()&&!r)return;this.focusEditor()}}},{key:"getValidationMessage",value:function(){return this.messageTextIsWithinLimit()?"":f.a.text("conversations-visitor-ui.chatTextArea.validationMessage")}},{key:"setEditorRef",value:function(e){var t=x.a.findDOMNode(e);this.editorRef=t}},{key:"handleSelectAttachmentFiles",value:function(e){var t=e.files;this.props.onSelectAttachmentFiles({files:t});this.focusEditor()}},{key:"onInputFocus",value:function(){var e=this.props,t=e.toggleOnAndOffInputFocus;e.disabled||t(!0)}},{key:"onInputBlur",value:function(){(0,this.props.toggleOnAndOffInputFocus)(!1)}},{key:"renderTextInput",value:function(){return y.a.createElement(de,{disabled:this.props.disabled||this.props.networkOffline,error:!this.messageTextIsWithinLimit(),messageText:this.state.messageText,onChange:this.handleChange,onKeyDown:this.handleKeyDown,showQuickReplyPlaceholder:this.props.showQuickReplyPlaceholder,setEditorRef:this.setEditorRef,showingHsBranding:this.props.showingHsBranding,validationMessage:this.getValidationMessage(),onInputFocus:this.onInputFocus,onInputBlur:this.onInputBlur})}},{key:"renderFileUploads",value:function(){var e=this;return this.props.stagedAttachments&&this.props.stagedAttachments.size?y.a.createElement(ye,{className:"m-bottom-2"+(this.props.showingHsBranding?" m-top-2":"")},this.props.stagedAttachments.map(function(t){return y.a.createElement(R.a,{key:Object(d.getLocalId)(t),attachment:t,onRemove:function(){e.props.onRemoveAttachment({attachment:t})}})})):null}},{key:"render",value:function(){var e=Object(me.c)(this.props.coloring)?null:Object(me.a)(this.props.coloring),t=!this.canPublish();return y.a.createElement(I,{inputToRender:this.renderTextInput,fileUploads:this.renderFileUploads,showingHsBranding:this.props.showingHsBranding},y.a.createElement(y.a.Fragment,null,this.props.supportsAttachments&&!this.props.shouldDisableAttachment?y.a.createElement("div",{className:this.props.mobile?"m-right-3":""},y.a.createElement(he.a,{accept:this.props.fileTypes,color:e,disabled:!this.canUploadAttachment(),mobile:this.props.mobile,onClick:this.props.onAttachmentButtonClick,onSelectFiles:this.handleSelectAttachmentFiles,maxAttachmentFileSize:this.props.maxAttachmentFileSize})):null,y.a.createElement(fe.a,{className:"chat-send-button","data-test-id":"chat-send-button",disabled:t,shape:"circle",onClick:this.handlePublish,use:"transparent-on-background","aria-label":f.a.text("conversations-visitor-ui.visitorExperienceAriaLabels.send")},y.a.createElement(ve.a,{icon:y.a.createElement(ge.a,null)}))))}}]);return t}(j.Component);Ce.propTypes={chatInputChanged:O.a.func.isRequired,coloring:Object(h.a)("ColoringRecord"),disablePublish:O.a.bool.isRequired,disabled:O.a.bool.isRequired,fileTypes:O.a.arrayOf(O.a.string).isRequired,hasUnansweredQuickReplyMessage:O.a.bool.isRequired,inputStaging:O.a.func.isRequired,isOnFocus:O.a.bool,maxAttachmentFileSize:O.a.number.isRequired,mobile:O.a.bool,networkOffline:O.a.bool.isRequired,onAttachmentButtonClick:O.a.func,onRemoveAttachment:O.a.func.isRequired,onSelectAttachmentFiles:O.a.func.isRequired,publishMessage:O.a.func.isRequired,shouldDisableAttachment:O.a.bool,shouldSendInputStagingEvent:O.a.bool.isRequired,showQuickReplyPlaceholder:O.a.bool.isRequired,showingHsBranding:O.a.bool,stagedAttachments:O.a.instanceOf(g.List),stagedMessageEditorText:O.a.string,supportsAttachments:O.a.bool.isRequired,toggleOnAndOffInputFocus:O.a.func};Ce.displayName="MessageEditor";Ce.defaultProps={hasUnansweredQuickReplyMessage:!1,isThreadStarted:!0,disablePublish:!1,onRemoveAttachment:function(){},onSelectAttachmentFiles:function(){},createNewThread:function(){},supportsAttachments:!1,fileTypes:be.a};t.a=Ce},FSCz:function(e,t,n){"use strict";n.r(t);n.d(t,"sendVisitorEmailAddress",function(){return r});var a=n("kMAx");function r(e){var t=e.threadId,n=e.email,r=e.sessionId,i=e.hubspotUtk;return a.a.post("livechat-public/v1/visitor/public",{query:{threadId:t,email:n,sessionId:r,hubspotUtk:i}})}},FT30:function(e,t,n){"use strict";n.r(t);var a=n("N7U+"),r=n("6+o1"),i=Object(r.Record)({senderId:null,senderType:null},"SenderLocator");n.d(t,"buildSenderLocator",function(){return s});var o=[a.a,a.b,a.d,a.e,a.c],s=function(e,t){o.includes(e)||console.warn("buildSenderLocator recevied invalid sender type "+e+" expected one of: "+o);return e===a.e?i({senderType:a.e}):i({senderType:e,senderId:t?""+t:null})}},GAhl:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n("ib5I"),r=n("pfqe"),i=n("PZjN"),o=n("KGLF"),s=n("Aomi"),c=n("hjlb"),u=Object(a.a)(o.historyDataForThread,function(e){if(!e||!Object(s.hasMessages)(e))return!1;var t=Object(c.a)(e).filter(function(e){return Object(i.isChatMessage)(e)||Object(i.isInitialMessage)(e)}).last();return Boolean(Object(r.a)(t))})},Gbx4:function(e,t,n){"use strict";n.d(t,"a",function(){return C});var a=n("rkDb"),r=n("BX77"),i=n("BvgU"),o=n("QWZm"),s=n("ivel"),c=n("tkdj"),u=n("+Tc3"),l=n("4scq"),d=n("Z0PP"),p=n("cep6"),h=n("7+AW"),m=n("B948"),b=n("tLtU"),f=n("TUZh"),g=n("L6i2"),v=n("2NeP"),O=n("WQ6g"),j=n("O3Qn"),y=n("08NH");function C(e){var t=e.text,n=e.richText,C=e.quickReply,x=e.fileAttachment;return function(e,T){var k=Object(p.a)(T()),E=Object(u.isPersistedThread)(k),w=Object(a.getChannelName)(k),I=Object(a.getThreadId)(k),R=Object(l.getMessagesUtk)(T()),S=Object(g.getMessagesPageUri)(T()),A=Object(m.buildVisitorCommonMessage)({clientType:r.a,fileAttachment:x,quickReply:C,richText:n,senderId:R,text:t,thread:k});e(Object(d.a)(I));e(Object(h.trackSendMessage)({threadId:I}));if(!E){e(Object(b.stageMessageOnStubbedThread)(A));return e(Object(o.createNewThread)())}if(Object(v.shouldRecordUrlContextUpdate)(T(),{threadId:I})){e(Object(c.publishMessage)({channel:w,message:Object(f.a)(S),threadId:I})).done();e(Object(O.a)({threadId:I,currentUrl:S}))}Object(y.getMostRecentMessageIsEmailPrompt)(T())&&i.a.test(t)&&e(Object(j.sendVisitorEmailAddress)({email:t,consentToCommunicate:!1,threadId:I}));return e(Object(c.publishMessage)({channel:w,message:A,threadId:I})).then(function(){return e(Object(s.applyGdprConsent)())})}}},Gcf9:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n("BjQQ"),r=Object(a.a)("resolvedAttachments")},GqXo:function(e,t,n){"use strict";var a=n("6+o1"),r=n("tuJS"),i=Object(a.Record)({width:"auto",minHeight:36,borderColor:r.h,whiteSpace:"normal",lineHeight:"1rem",color:r.h},"QuickReplyTheme");t.a=i},HmhQ:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n("CRij"),r=n("2n97"),i=Object(a.createAction)(r.J,function(e){return{widgetInputIsOnFocus:e}});function o(e){return function(t){t(i(e))}}},HopT:function(e,t,n){var a=n("d9q4"),r=n("UI7R"),i=n("y3MR"),o=n("cXje"),s=/[\\^$.*+?()[\]{}|]/g,c=/^\[object .+?Constructor\]$/,u=Function.prototype,l=Object.prototype,d=u.toString,p=l.hasOwnProperty,h=RegExp("^"+d.call(p).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function m(e){return!(!i(e)||r(e))&&(a(e)?h:c).test(o(e))}e.exports=m},I04N:function(e,t,n){var a=n("6uUH");function r(e,t){for(var n=e.length;n--;)if(a(e[n][0],t))return n;return-1}e.exports=r},InPC:function(e,t,n){"use strict";n.d(t,"a",function(){return i});n.d(t,"b",function(){return o});var a=n("CRij"),r=n("Dho5"),i=Object(a.createAction)(r.g);function o(){return function(e){e(i())}}},KMkU:function(e,t,n){"use strict";var a=n("tuJS"),r=n("6+o1"),i=n("4o4y"),o=Object(r.Record)({width:"auto",minHeight:36,borderColor:a.h,whiteSpace:"normal",lineHeight:"1rem",color:a.h},"QuickReplyTheme"),s=Object(r.Record)({alignItems:"flex-start",avatarWidth:"32px",backgroundColor:a.l,borderColor:a.a,borderRadius:"4px",borderWidth:"1px",messageSpacing:"8px",textColor:a.p,fileAttachmentTheme:Object(i.a)(),quickReplyTheme:o(),headerBackgroundColor:a.q,headerTextColor:a.p,avatarBackgroundColor:a.a,avatarBorderColor:a.a,avatarTextColor:a.p},"Theme");t.a=s},KOwh:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var a=n("qBhh"),r=n("9ETK"),i=n("ap58"),o=n("CPNZ"),s=n("OUFc"),c=n("6+o1"),u=n("ib5I"),l=n("6C5m"),d=n("VT1R"),p=n("2a3n"),h=n("8fPJ"),m=Object(u.a)([d.getResponders],function(e){return Object(s.getEntries)(e).reduce(function(e,t,n){var s,c=Object(o.a)(t);return Object(l.a)([Object(h.a)(n)],Object(r.a)((s={},Object(a.a)(s,i.a,c?Object(p.a)(c):null),Object(a.a)(s,i.c,Object(o.c)(t)),s)),e)},Object(c.Map)())})},"KUC+":function(e,t,n){"use strict";var a=n("OCxt"),r=n("10Vg"),i="help",o="default",s="error",c=n("avza"),u=function(e){var t=e.use,n=e.theme;switch(t){case s:return Object(a.d)(["color:",";"],Object(r.c)(n));case i:return Object(a.d)(["color:",";"],Object(r.d)(n));case o:default:return null}},l=a.e.small.withConfig({displayName:"VizExSmall",componentId:"f5rdak-0"})(["display:block;",";",";"],c.b,u);t.a=l},LI65:function(e,t,n){"use strict";n.r(t);n.d(t,"fileExceedsSizeLimit",function(){return r});var a=n("ZyKU"),r=function(e){return e.size>a.b}},LnAc:function(e,t,n){"use strict";var a=n("gNdb"),r=n.n(a);function i(){var e,t;return{promise:new r.a.Promise(function(n,a){t=n;e=a}),reject:e,resolve:t}}t.a=i},"M+r2":function(e,t,n){"use strict";n.r(t);n.d(t,"fetchAttachmentUploadUrlClient",function(){return i});var a=n("kMAx"),r="livechat-public/v1/attachment/upload-url",i=function(e){var t=e.sessionId,n=e.threadId;return a.a.get(r,{query:{sessionId:t,threadId:n}})}},NFcK:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n("va1P"),r=n("PZjN"),i=function(e){return Object(r.isTypingMessage)(e)&&Object(a.isFromVisitor)(e)}},O1Zz:function(e,t,n){"use strict";n.r(t);n.d(t,"isUploadCompleted",function(){return r});var a=n("0U3V"),r=function(e){return-1!==Object(a.getFileId)(e)}},O3Qn:function(e,t,n){"use strict";n.r(t);n.d(t,"sendVisitorEmailAddressRequested",function(){return h});n.d(t,"sendVisitorEmailAddressFailed",function(){return m});n.d(t,"sendVisitorEmailAddressSucceeded",function(){return b});n.d(t,"sendVisitorEmailAddress",function(){return f});var a=n("CRij"),r=n("xOvp"),i=n("2n97"),o=n("fS1x"),s=n("FSCz"),c=n("Wgd9"),u=n("nncj"),l=n("kJ+w"),d=n("/A3W"),p=n("rkDb"),h=Object(a.createAction)(i.B,function(e){return{email:e}}),m=Object(a.createAction)(i.C,function(e){return{error:e}}),b=Object(a.createAction)(i.D,function(e){return{email:e}});function f(e){var t=e.consentToCommunicate,n=void 0!==t&&t,a=e.email,i=e.threadId;return function(e,t){e(h(a));var f=Object(l.getThreadByThreadId)(t(),{threadId:i}),g=Object(p.getChannelName)(f),v=Object(r.getSessionId)(t()),O=Object(d.getHubspotUtk)(t()),j=function(){e(b(a));e(Object(o.default)({channel:g,email:a,threadId:i}));n&&e(Object(c.d)(n));e(Object(u.trackInteraction)("widget-interaction",{action:"submit email"}));return{error:null}},y=function(t){e(m(t));return{error:t}};return s.sendVisitorEmailAddress({threadId:i,email:a,sessionId:v,hubspotUtk:O}).then(j,y)}}},O7fF:function(e,t,n){"use strict";n.d(t,"b",function(){return a});n.d(t,"e",function(){return r});n.d(t,"a",function(){return i});n.d(t,"d",function(){return o});n.d(t,"c",function(){return s});var a="NETWORK_OFFLINE",r="THREAD_HISTORY_FAILED",i="CREATE_NEW_THREAD_FAILED",o="SUBSCRIPTIONS_FAILED",s="PUBSUB_FAILED"},Ogsy:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a=["video/*","audio/*","application/json","application/vnd.ms-excel","application/vnd.ms-powerpoint","application/msword","application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.oasis.opendocument.graphics","application/vnd.oasis.opendocument.presentation","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.text","image/gif","image/jpeg","image/jpg","image/png","image/tiff","text/calendar","text/css","text/csv","text/plain"]},P3KS:function(e,t,n){"use strict";n.r(t);n.d(t,"createVisitorThread",function(){return o});var a=n("nDpY"),r=n.n(a),i=n("kMAx");function o(e){var t=e.sessionId,n=e.messageId,a=e.hubspotUtk,o=e.messagesPageUri,s=e.visitorThreadInitialHistory;return i.a.post("livechat-public/v1/thread/visitor",{query:{sessionId:t,welcomeMessageId:n,hubspotUtk:a,portalId:r.a.get(),expectedResponseType:"WRAPPER_V2"},data:{visitorThreadInitialHistory:s},headers:{"X-HubSpot-Messages-Uri":o}})}},PHMb:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n("wjj1"),r=n("Wjp6"),i=n("7ecw"),o=function(e){var t=e.thread;return function(e){e(Object(a.postExternalApiEvent)({eventType:r.c,payload:{conversation:Object(i.serializeThreadForExternalEvent)(t)}}))}}},PI7G:function(e,t,n){"use strict";n.r(t);var a=n("oDox"),r=n("b9ZA"),i=n("7Ypx"),o=n("iRI7"),s=n("PZjN"),c=n("XG8+"),u=n("b2e+"),l=function(e){Object(c.threadHistoryInvariant)(e);return Object(o.a)(u.b,Object(i.a)(s.isConversationalMessage),function(e){return e&&e.last()})(e)},d=n("9A/W");n.d(t,"buildCreatedThread",function(){return p});var p=function(e){var t=e.channelDetails,n=e.messagesPageUri,i=e.threadHistory,o=e.threadId;return Object(d.a)({channelDetails:t,currentUrl:n,source:r.a,status:a.a.STARTED,threadId:o}).set("latestMessage",l(i))}},PRHD:function(e,t,n){"use strict";var a=n("ib5I"),r=n("D1/i"),i=n("b5Ei"),o=Object(r.a)(i.a),s=n("BjQQ"),c=n("nRUj"),u=n("zFd5"),l=n("6uLX"),d=n("0v5j");n.d(t,"a",function(){return p});var p=Object(a.a)([d.a,l.a,u.a],function(e,t,n){var a=Object(c.getUserId)(n);return Object(s.a)(a,e)?n:t&&t.find(function(t){var n=Object(c.getUserId)(t);return o(n,e)})})},QWT7:function(e,t,n){var a=n("cbPM");function r(e,t){var n=e.__data__;return a(t)?n["string"==typeof t?"string":"hash"]:n.map}e.exports=r},QWZm:function(e,t,n){"use strict";n.r(t);n.d(t,"createNewThread",function(){return I});var a=n("u2Ms"),r=n("CRij"),i=n("6+o1"),o=n("BjQQ"),s=n("ED6b"),c=n("Jtvd"),u=n("ZjIF"),l=n("L6i2"),d=n("xOvp"),p=n("PI7G"),h=n("9VMc"),m=n("nncj"),b=n("/A3W"),f=n("4scq"),g=n("9H+j"),v=n("P3KS"),O=n("VfRw"),j=n("PHMb"),y=n("0UrN"),C=n("qeXV"),x=n("gmfO"),T=n("eBLR"),k=Object(r.createAction)(O.a.STARTED),E=Object(r.createAction)(O.a.SUCCEEDED),w=Object(r.createAction)(O.a.FAILED);function I(){return function(e,t){var n=Object(d.getSessionId)(t()),r=Object(u.getMessageId)(t()),O=Object(l.getMessagesPageUri)(t()),I=Object(b.getHubspotUtk)(t()),R=Object(C.getLatestWidgetData)(t());e(k());return Object(v.createVisitorThread)({sessionId:n,hubspotUtk:I,messageId:r,messagesPageUri:O,visitorThreadInitialHistory:Object(h.getVisitorInitialThreadHistory)(t()),widgetData:R}).then(function(n){var r=n.channelDetails,u=n.sessionId,l=n.id,d=n.history,h=new a.a(Object.assign({},d,{attachments:Object(i.Map)(Object(o.a)("attachments",d))})),b=Object(p.buildCreatedThread)({channelDetails:r,messagesPageUri:O,threadId:l,threadHistory:h});e(Object(g.updateSessionId)(u));e(Object(m.trackInteraction)("start-conversation",{action:"new conversation started",threadId:l}));e(E({channel:Object(y.a)(r),threadId:l,conversation:b,threadHistory:h}));e(Object(s.addAvailabilityMessage)({channel:Object(y.a)(r),threadId:l}));e(Object(j.a)({thread:b}));Object(x.gdprCookieConsentOnExitIntentEnabled)(t(),R)||Object(T.getIsPrivateLoad)(R)||e(Object(c.handleStoreMessagesCookie)(Object(f.getMessagesUtk)(t())))}).catch(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e(w({status:t.status,message:t.message,error:t}))})}}},QhGC:function(e,t,n){"use strict";var a=n("PvDV"),r=n("y4Zp"),i=n.n(r),o=n("M0MQ"),s=n.n(o),c=n("ZQ2w"),u=n.n(c),l=n("E7sj"),d=n.n(l);t.a=s()({displayName:"FormattedSize",propTypes:{value:i.a.number.isRequired},render:function(){var e=this.props,t=e.value,n=Object(a.a)(e,["value"]);return u.a.createElement("span",null,d.a.formatSize(t,n))}})},Qirt:function(e,t,n){"use strict";var a=n("ib5I"),r=n("qeXV"),i=n("30X/"),o=n("Uz3j"),s=n("Dg0F"),c=n("BjQQ"),u=Object(c.a)("cookieBannerOnExitVisible"),l=n("Yuqq"),d=n("gmfO");n.d(t,"a",function(){return p});var p=Object(a.a)([r.getLatestWidgetData,i.a,l.getAPIEnableWidgetCookieBanner,u],function(e,t,n,a){var r=Object(s.a)(t),i="yes"===r||"no"===r,c=Object(d.gdprCookieConsentOnWidgetLoadEnabled)(e);return!(!(n||c)&&!a)&&Object(o.getIsFirstVisitorSession)(t)&&!i})},Qu2R:function(e,t,n){"use strict";var a=n("UdXx"),r=n("nncj"),i=n("T7hB"),o=function(e){switch(e){case i.a:return"size limit exceeded";default:return null}},s=n("+rg3"),c=n("rkDb"),u=n("sToE"),l=n("rvWB");n.d(t,"a",function(){return d});var d=function(e){var t=e.file,n=e.thread;return function(e){var i=Object(c.getThreadId)(n);return Object(u.validateAttachmentFile)(t).then(function(){var n=new a.a({file:t,progress:0});return e(Object(l.uploadAttachment)({attachment:n,threadId:i}))}).catch(function(t){e(Object(s.attachmentError)(t,i));e(Object(r.trackInteraction)("failed-to-attach-file",{action:"failed to attach file","failure-type":o(t)}))})}}},QzTW:function(e,t,n){var a=n("QWT7");function r(e){var t=a(this,e).delete(e);this.size-=t?1:0;return t}e.exports=r},RPTv:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n("BjQQ"),r=n("ib5I"),i=n("qeXV"),o=Object(r.a)(i.getLatestWidgetData,Object(a.a)("showingHsBranding"))},"RSm/":function(e,t,n){var a=n("I04N");function r(e){var t=this.__data__,n=a(t,e);return n<0?void 0:t[n][1]}e.exports=r},RWBV:function(e,t){function n(){this.__data__=[];this.size=0}e.exports=n},RlAi:function(e,t,n){"use strict";var a,r,i=n("PvDV"),o=n("ZQ2w"),s=n.n(o),c=n("y4Zp"),u=n.n(c),l=n("OCxt"),d=n("CTrm"),p=n("qBhh"),h=n("0pNr"),m=n("jMtq"),b="primary",f="secondary",g={PRIMARY:b,SECONDARY:f},v=(a={},Object(p.a)(a,b,h.PRIMARY),Object(p.a)(a,f,h.SECONDARY),a),O=function(e){return v[e]},j=(r={},Object(p.a)(r,b,m.SECONDARY),Object(p.a)(r,f,m.PRIMARY),r),y=function(e){return j[e]},C=g,x=n("ZVA3"),T=Object(l.e)(d.a).withConfig({displayName:"VizExLoadingButton__Spinner",componentId:"ruu7j6-0"})(["height:0;position:absolute;top:50%;right:0;transition:opacity 0.2s;opacity:",";"],function(e){return e.show?1:0}),k=l.e.div.withConfig({displayName:"VizExLoadingButton__ReadyWrapper",componentId:"ruu7j6-1"})(["transition:opacity 0.2s;opacity:",";"],function(e){return e.show?1:0}),E=function(e){var t=e.children,n=e.Button,a=e.result,r=e.use,o=e.theme,c=e.currentState,u=e.onClick,l=Object(i.a)(e,["children","Button","result","use","theme","currentState","onClick"]),d="ready"===c,p="submitting"===c,h="done"===c;return s.a.createElement(n,Object.assign({theme:o,onClick:p||h?function(){}:u,use:O(r),style:{position:"relative"}},l),s.a.createElement(k,{"data-testid":"VizExLoadingButton-Ready",show:d},t),s.a.createElement(T,{size:"xs",grow:!0,use:y(r),theme:o,showResult:h,show:p||h,"data-testid":"VizExLoadingButton-Spinner"},a))};E.propTypes={Button:u.a.node.isRequired,children:u.a.node.isRequired,currentState:u.a.oneOf(["ready","submitting","done"]),onClick:u.a.func,result:u.a.node,theme:x.a,use:u.a.oneOf(Object.values(C))};E.defaultProps={"data-test-id":"loading-button",use:C.PRIMARY,onClick:function(){}};E.displayName="VizExLoadingButton";t.a=E},S8ql:function(e,t,n){"use strict";var a=n("ZQ2w"),r=n.n(a),i=function(e){return r.a.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 24 24"},e),r.a.createElement("defs",null,r.a.createElement("path",{d:"M16.233 8.738c.564-.502.564-1.317 0-1.818-.564-.503-1.477-.503-2.04 0l-7.128 6.35c-1.374 1.223-1.374 3.213 0 4.436.686.612 1.587.918 2.49.918.9 0 1.802-.306 2.489-.918l10.318-9.193h.001c2.183-1.946 2.183-5.11 0-7.055-2.181-1.944-5.733-1.944-7.918 0l-12.2 10.87c-2.993 2.667-2.993 7.006 0 9.673C3.742 23.334 5.707 24 7.673 24c1.965 0 3.93-.666 5.427-2l9.01-8.027c.563-.501.563-1.316 0-1.818-.564-.503-1.478-.503-2.042 0l-9.009 8.027c-1.867 1.664-4.906 1.663-6.773 0-1.867-1.664-1.867-4.37 0-6.035l12.2-10.869c1.058-.944 2.779-.943 3.836-.001s1.057 2.475 0 3.417h-.002l-10.317 9.194c-.249.22-.651.22-.897 0-.248-.22-.248-.58 0-.8l7.127-6.35z",id:"attach__a"})),r.a.createElement("use",{xlinkHref:"#attach__a",fillRule:"evenodd"}))};i.displayName="SVGAttach";t.a=i},SWAX:function(e,t,n){"use strict";n.r(t);var a=n("a4p2"),r=n("ibZn"),i=n("ib5I"),o=n("HRPO"),s=n("qeXV"),c=Object(i.a)([s.getLatestWidgetData],function(e){return Object(o.gdprConsentToProcessEnabled)(e)}),u=n("Qirt"),l=n("3+Oy"),d=n("Zqdz"),p=n("cep6"),h=n("RPTv"),m=n("ZWy4"),b=n("8cQJ"),f=n("HmhQ");n.d(t,"WEBPACK_3_FORCE_MODULE_IMPORT",function(){return O});var g=function(e){return{shouldShowMeetingsLink:Object(b.a)(e),isThreadStarted:Object(a.a)(Object(p.a)(e)),requiresExplicitConsentToProcess:Object(d.a)(e),showingGdprProcess:c(e)&&!Object(l.a)(e),renderCookieConsentPrompt:Object(u.a)(e),showingHsBranding:Object(h.a)(e)}},v={toggleOnAndOffInputFocus:f.a},O=(t.default=Object(r.b)(g,v)(m.a),1)},T0Ay:function(e,t,n){"use strict";var a=n("ZQ2w"),r=n.n(a),i=function(e){return r.a.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 24 24"},e),r.a.createElement("defs",null,r.a.createElement("path",{d:"M21.158.222L2.568 11.815c-.8.498-.749 1.215.113 1.591l4.406 1.923 10.395-9.903c1.377-1.296 1.569-1.119.426.395L8.254 18.215v4.927c0 .953.5 1.141 1.113.418l4.473-5.282 5.055 2.207c.861.376 1.643-.092 1.736-1.04l1.81-18.404c.094-.949-.484-1.317-1.283-.819",id:"send__a"})),r.a.createElement("use",{xlinkHref:"#send__a",fillRule:"evenodd"}))};i.displayName="SVGSend";t.a=i},T7hB:function(e,t,n){"use strict";n.d(t,"a",function(){return a});n.d(t,"b",function(){return r});var a="SIZE_LIMIT_EXCEEDED",r="UPLOAD_ERROR"},TGEe:function(e,t,n){"use strict";var a=n("ib5I"),r=n("iRI7"),i=n("vIe5"),o=n("kd8B"),s=Object(r.a)(i.e,o.getGdprConsentToCommunicateEnabled),c=n("qeXV");n.d(t,"a",function(){return u});var u=Object(a.a)([c.getLatestWidgetData],function(e){return s(e)})},TUZh:function(e,t,n){"use strict";var a=n("qBhh"),r=n("E3/6"),i=n("12I0"),o="ENTRY_URL",s=n("mXvI");n.d(t,"a",function(){return c});function c(e){var t;return new r.a({contexts:Object(a.a)({},o,(t={},Object(a.a)(t,i.p,o),Object(a.a)(t,"url",e),t)),id:Object(s.generateUuid)(),timestamp:Date.now()})}},Ta4D:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n("6+o1"),r=n("ib5I"),i=n("BjQQ"),o=n("V/zO"),s=n("lBOe"),c=Object(r.a)([s.a,o.getCurrentThreadId],function(e,t){var n=Object(i.a)(t,e);return n?n.toList():Object(a.List)()})},TlSS:function(e,t,n){"use strict";var a=n("gjBT"),r=n("u1T7"),i=n("2hC2"),o=n("8PIh"),s=n("G/XJ"),c=n("y4Zp"),u=n.n(c),l=n("ZQ2w"),d=n.n(l),p=n("E7sj"),h=n.n(p),m=n("Kb5M"),b=n("QhGC"),f=["PNG","GIF","JPEG","JPG"],g=function(e){var t=e.name.split("."),n=t[t.length-1]||"";return-1!==f.indexOf(n.toUpperCase())},v=n("0U3V"),O=function(e){var t=Object(v.getFile)(e),n=Object(v.getUploadProgress)(e);return t&&n?n/100*t.size:0},j=n("m17H"),y=n("dQ1f"),C=n("O1Zz"),x=n("1an1"),T=function(e){Object(s.a)(t,e);function t(e){var n;Object(a.a)(this,t);(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={imageDataUrl:""};return n}Object(r.a)(t,[{key:"componentDidMount",value:function(){this.processImageFile(this.props.imageFile)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.imageFile!==this.props.imageFile&&this.processImageFile(e.imageFile)}},{key:"shouldComponentUpdate",value:function(e,t){return t.imageDataUrl!==this.state.imageDataUrl}},{key:"processImageFile",value:function(e){var t=this,n=new FileReader;n.addEventListener("load",function(){t.setState({imageDataUrl:n.result})});n.readAsDataURL(e)}},{key:"render",value:function(){return d.a.createElement(x.a,{src:this.state.imageDataUrl})}}]);return t}(d.a.Component);T.displayName="ImageAttachmentPreview";T.propTypes={imageFile:u.a.instanceOf(File).isRequired};var k=T,E=n("+UqK"),w=n("3mCc"),I=n("y+ws"),R=n("6Sck"),S=function(e){Object(s.a)(t,e);function t(){Object(a.a)(this,t);return Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}Object(r.a)(t,[{key:"customFilePreview",value:function(){var e=this.props.attachment,t=Object(v.getFile)(e);if(g(t))return d.a.createElement(k,{imageFile:t})}},{key:"fileInfo",value:function(){return Object(C.isUploadCompleted)(this.props.attachment)?d.a.createElement(b.a,{value:Object(y.getFileSize)(this.props.attachment)}):d.a.createElement(m.a,{message:"conversations-visitor-ui.stagedAttachment.uploadProgress",options:{uploadedBytes:h.a.formatSize(O(this.props.attachment),{precision:2,strip_insignificant_zeroes:!0}),totalBytes:h.a.formatSize(Object(y.getFileSize)(this.props.attachment))}})}},{key:"renderProgress",value:function(){return Object(C.isUploadCompleted)(this.props.attachment)?null:d.a.createElement(w.a,{value:Object(v.getUploadProgress)(this.props.attachment)})}},{key:"render",value:function(){return d.a.createElement(I.a,{processing:!Object(C.isUploadCompleted)(this.props.attachment),fileName:Object(j.getFileName)(this.props.attachment),fileInfo:this.fileInfo(),preview:this.customFilePreview(),style:{minWidth:220}},d.a.createElement(R.a,{size:"xs",onClick:this.props.onRemove}),this.renderProgress())}}]);return t}(d.a.Component);S.displayName="FileUpload";S.propTypes={attachment:Object(E.a)("FileUploadRecord").isRequired,onRemove:u.a.func.isRequired};t.a=S},UI7R:function(e,t,n){var a,r=n("YaGm"),i=(a=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+a:"";function o(e){return!!i&&i in e}e.exports=o},UaBW:function(e,t,n){"use strict";n.d(t,"b",function(){return a});n.d(t,"a",function(){return r});var a="@type",r="DATE_MESSAGE"},UdXx:function(e,t,n){"use strict";var a=n("gjBT"),r=n("2hC2"),i=n("8PIh"),o=n("G/XJ"),s=n("6+o1"),c=n("sxvv"),u=function(e){Object(o.a)(t,e);function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(a.a)(this,t);return Object(r.a)(this,Object(i.a)(t).call(this,Object.assign({},e,{localId:Object(c.generateIdForFile)({file:e.file,timestamp:Date.now()})})))}return t}(Object(s.Record)({file:null,localId:"",fileId:-1,uploadProgress:0},"FileUploadRecord"));t.a=u},UhTb:function(e,t,n){"use strict";var a=n("+UqK"),r=n("y4Zp"),i=n.n(r),o=n("AXPb"),s=n.n(o);t.a=s.a.mapOf(s.a.recordOf({data:Object(a.a)("Sender"),status:i.a.string.isRequired}),Object(a.a)("SenderLocator"))},W3K0:function(e,t,n){"use strict";n.r(t);n.d(t,"createFormDataForAttachment",function(){return a});var a=function(e){var t=e.file,n=new FormData;n.append("file",t);return n}},WQ6g:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n("CRij"),r=n("e+cU"),i=Object(a.createAction)(r.b,function(e){return{currentUrl:e.currentUrl,threadId:e.threadId}})},Wgd9:function(e,t,n){"use strict";n.d(t,"a",function(){return l});n.d(t,"c",function(){return d});n.d(t,"b",function(){return p});n.d(t,"d",function(){return h});var a=n("CRij"),r=n("Dho5"),i=n("mluK"),o=n("9H+j"),s=n("xOvp"),c=n("bz7q"),u=n("/A3W"),l=Object(a.createAction)(r.a),d=Object(a.createAction)(r.c),p=Object(a.createAction)(r.b,function(e){return{error:e}});function h(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?function(e,t){var n=Object(s.getSessionId)(t()),a=Object(c.getSelectedThreadId)(t()),r=Object(u.getHubspotUtk)(t());e(l());var h=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).sessionId;e(Object(o.updateSessionId)(t));e(d())},m=function(t){e(p(t))};Object(i.sendConsentToCommunicate)({sessionId:n,hubspotUtk:r,threadId:a}).then(h,m).done()}:null}},XuUM:function(e,t,n){var a=n("igt9"),r=n("00xA"),i=n("9J2q");function o(){this.size=0;this.__data__={hash:new a,map:new(i||r),string:new a}}e.exports=o},YDXn:function(e,t,n){"use strict";var a=n("4o4y"),r=n("tuJS"),i=n("6+o1"),o=n("GqXo"),s=Object(i.Record)({alignItems:"flex-start",avatarWidth:"32px",backgroundColor:r.l,borderColor:r.a,borderRadius:"4px",borderWidth:"1px",messageSpacing:"8px",textColor:r.k,fileAttachmentTheme:Object(a.a)(),quickReplyTheme:Object(o.a)(),widgetAccent:r.k},"Theme");t.a=s},YaGm:function(e,t,n){var a=n("QN3r")["__core-js_shared__"];e.exports=a},Z0PP:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n("CRij"),r=n("bDpH"),i=Object(a.createAction)(r.e,function(e){return{threadId:e}})},ZI8J:function(e,t,n){"use strict";n.d(t,"a",function(){return a});n.d(t,"b",function(){return r});n.d(t,"d",function(){return i});n.d(t,"c",function(){return o});var a="FIRST",r="FIRST_IN_GROUP",i="LAST_IN_GROUP",o="LAST"},ZWy4:function(e,t,n){"use strict";var a=n("gjBT"),r=n("u1T7"),i=n("2hC2"),o=n("8PIh"),s=n("G/XJ"),c=n("y4Zp"),u=n.n(c),l=n("ZQ2w"),d=n.n(l),p=n("OCxt"),h=n("BBNf"),m=n("gXxc"),b=n("ibZn"),f=n("cep6"),g=n("vGzS"),v=n("nncj"),O=n("+UqK"),j=n("T7hB"),y=n("O7fF"),C=n("pBhj"),x=n("E7sj"),T=n.n(x),k=n("Kb5M"),E=n("Ogsy"),w=n("oT5E"),I=n("PvDV"),R=n("3L1q"),S=p.e.input.withConfig({displayName:"VizExFileButton__FilePickerInput",componentId:"sc-1p4t8gi-0"})(["display:none;"]),A=function(e){var t=e.children,n=e.multiple,a=e.accept,r=e.onChange,i=e.onClick,o=Object(I.a)(e,["children","multiple","accept","onChange","onClick"]),s=Object(l.useRef)(),c=function(e){s.current.click();Object(R.a)(i,e)};return d.a.createElement(l.Fragment,null,t({onClick:c}),d.a.createElement(S,Object.assign({},o,{ref:s,type:"file",accept:a.join(","),multiple:n,onChange:r})))};A.displayName="VizExFileButton";A.defaultProps={accept:[]};A.propTypes={accept:u.a.arrayOf(u.a.string),children:u.a.func.isRequired,multiple:u.a.bool,onChange:u.a.func,onClick:u.a.func};var M=A,P=function(e){return d.a.createElement(M,{accept:E.a,use:"unstyled",onClick:e.onClick,onChange:e.onChange},function(t){return d.a.createElement(w.a,Object.assign({use:"on-bright"},t),e.children)})};P.displayName="FilePickerLink";P.propTypes={children:u.a.node.isRequired,onChange:u.a.func.isRequired,onClick:u.a.func};var N=P,q=n("ZyKU"),_=n("rkDb"),F=function(e){var t=e.attachmentsError,n=e.dismissAttachmentsError,a=e.selectAttachmentFile,r=e.thread,i=e.trackInteraction,o=function(){n({threadId:Object(_.getThreadId)(r)})},s=function(e){var t=e.target.files;if(t&&t.length){var n=t.item(0);a({file:n,thread:r})}},c=function(){i("retry-attachment-upload",{action:"retry attachment upload"})},u=function(){switch(t){case j.a:return d.a.createElement(k.a,{message:"cvVisitorUIAttachments.errors.fileSizeExceeded",options:{maxSize:T.a.formatSize(q.b)}});case j.b:return d.a.createElement(k.a,{message:"cvVisitorUIAttachments.errors.uploadError"});default:return null}}();return d.a.createElement(C.a,{title:u,onClose:o,link:d.a.createElement(N,{onChange:s,onClick:c},d.a.createElement(k.a,{message:"cvVisitorUIAttachments.tryAgain"}))})};F.displayName="AttachmentErrorAlerts";F.propTypes={attachmentsError:u.a.oneOf([j.a,j.b]),dismissAttachmentsError:u.a.func.isRequired,selectAttachmentFile:u.a.func.isRequired,thread:Object(O.a)("Thread").isRequired,trackInteraction:u.a.func.isRequired};var D=F,L=n("RK3k"),B=n("u9LH"),z=function(e){var t=e.createNewThread,n=e.fetchOlderThreadHistory,a=e.networkError,r=e.startPubSub,i=e.resubscribe,o=Object(l.useState)([]),s=Object(B.a)(o,2),c=s[0],u=s[1],p=function(){u([].concat(Object(L.a)(c),[a]))};if(c.includes(a))return null;var h=function(){switch(a){case y.b:case y.c:case y.d:return d.a.createElement(k.a,{message:"conversations-visitor-ui.network.offline.title"});case y.e:return d.a.createElement(k.a,{message:"conversations-visitor-ui.network.pubSubFailure.title"});case y.a:return d.a.createElement(k.a,{message:"conversations-visitor-ui.network.newThreadFailure.title"});default:return null}}(),m=function(){switch(a){case y.e:return d.a.createElement(w.a,{use:"on-bright",onClick:n},d.a.createElement(k.a,{message:"conversations-visitor-ui.network.pubSubFailure.retry"}));case y.a:return d.a.createElement(w.a,{use:"on-bright",onClick:t},d.a.createElement(k.a,{message:"conversations-visitor-ui.network.pubSubFailure.retry"}));case y.d:return d.a.createElement(w.a,{use:"on-bright",onClick:i},d.a.createElement(k.a,{message:"conversations-visitor-ui.network.pubSubFailure.retry"}));case y.c:return d.a.createElement(w.a,{use:"on-bright",onClick:r},d.a.createElement(k.a,{message:"conversations-visitor-ui.network.pubSubFailure.retry"}));default:return null}}();return d.a.createElement(C.a,{title:h,onClose:p,link:m})};z.displayName="NetworkErrorAlerts";z.propTypes={createNewThread:u.a.func.isRequired,fetchOlderThreadHistory:u.a.func.isRequired,networkError:u.a.oneOf([y.b,y.e,y.a,y.c,y.d]).isRequired,resubscribe:u.a.func.isRequired,startPubSub:u.a.func.isRequired};var U=z,H=function(e){Object(s.a)(t,e);function t(){Object(a.a)(this,t);return Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.attachmentsError,n=e.createNewThread,a=e.dismissAttachmentsError,r=e.fetchOlderThreadHistory,i=e.networkError,o=e.resubscribe,s=e.selectAttachmentFile,c=e.startPubSub,u=e.thread,l=e.trackInteraction;return t?d.a.createElement(D,{attachmentsError:t,dismissAttachmentsError:a,selectAttachmentFile:s,thread:u,trackInteraction:l}):i?d.a.createElement(U,{createNewThread:n,fetchOlderThreadHistory:r,networkError:i,resubscribe:o,startPubSub:c}):null}}]);return t}(l.Component);H.displayName="ChatAreaAlertContainer";H.propTypes={attachmentsError:u.a.oneOf([j.a,j.b]),createNewThread:u.a.func.isRequired,dismissAttachmentsError:u.a.func.isRequired,fetchOlderThreadHistory:u.a.func.isRequired,networkError:u.a.oneOf([y.b,y.e,y.a,y.c,y.d]),resubscribe:u.a.func.isRequired,selectAttachmentFile:u.a.func.isRequired,startPubSub:u.a.func.isRequired,thread:Object(O.a)("Thread").isRequired,trackInteraction:u.a.func.isRequired};var V=H,Q=n("tRLC"),W=n("zF3W"),Z=n("Qu2R"),G=n("eqno"),K=n("bz7q"),X=n("xOvp"),Y=n("sjvu"),J=n("KGLF"),$=n("p0mF"),ee=n("b2e+"),te=function(){return function(e,t){var n=t(),a=Object(X.getSessionId)(n),r=Object(K.getSelectedThreadId)(n);if(null!==r&&r!==Y.a){var i=Object(f.a)(n),o=Object(J.historyDataForThread)(n,{thread:i}),s=Object(ee.c)(o),c=Object(ee.d)(o);e(Object($.fetchThreadHistory)({offsetOrdinal:s,offsetTimestamp:c,threadId:r,sessionId:a}))}}},ne=n("QWZm"),ae=n("LlPi"),re=function(e,t){var n=t.thread;return{attachmentsError:Object(Q.a)(e,{thread:n}),networkError:Object(G.a)(e)}},ie={createNewThread:ne.createNewThread,dismissAttachmentsError:W.a,fetchOlderThreadHistory:te,selectAttachmentFile:Z.a,trackInteraction:v.trackInteraction,startPubSub:ae.startPubSub,resubscribe:g.resubscribe},oe=Object(b.b)(re,ie)(V),se=function(e){return{thread:Object(f.a)(e)}},ce=Object(b.b)(se)(oe),ue=n("DHw3"),le=n("InPC"),de=n("ib5I"),pe=n("qeXV"),he=n("vIe5"),me=Object(de.a)([pe.getLatestWidgetData],function(e){return Object(he.d)(e)}),be=n("Zqdz"),fe=n("t2YF"),ge=n("zC+/"),ve=n("BjQQ"),Oe=Object(ve.a)("gdpr"),je=Object(de.a)([Oe],Object(ve.a)("consentToProcessError")),ye=function(e){return{consentToProcessMessage:me(e),showGdprConsentToProcessButton:Object(be.a)(e),coloring:Object(ge.a)(e),consentToProcessError:je(e)}},Ce={consentToProcess:ue.consentToProcess,dismissConsentToProcessError:le.b,trackInteraction:v.trackInteraction},xe=Object(b.b)(ye,Ce)(fe.a),Te=n("DyWv"),ke=n("W2UC"),Ee=n("tuJS"),we=n("SsR0"),Ie=n("3GID"),Re=function(e){var t=e.ariaLabel,n=e.children,a=e.onClick,r=e.href;r||(r=void 0);return d.a.createElement(w.a,{theme:Object(we.a)(Object(Ie.e)(Ee.m)),onClick:a,href:r,external:!0,"aria-label":t},n)};Re.propTypes={ariaLabel:u.a.string,children:u.a.node.isRequired,href:u.a.string,onClick:u.a.func};Re.defaultProps={href:"",onClick:function(){}};Re.displayName="BrandingLink";var Se=Re,Ae=n("SxW6"),Me=function(e){return d.a.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 24 24"},e),d.a.createElement("defs",null,d.a.createElement("path",{d:"M17 16c-1.38 0-2.5-1.12-2.5-2.5S15.62 11 17 11s2.5 1.12 2.5 2.5S18.38 16 17 16m.906-8.43V4.832c.716-.338 1.218-1.061 1.218-1.9v-.064c0-1.158-.95-2.105-2.11-2.105h-.064c-1.161 0-2.111.947-2.111 2.105v.064c0 .839.503 1.562 1.219 1.9V7.57c-1.067.164-2.042.603-2.846 1.249L5.676 2.97c.05-.191.085-.387.085-.594C5.762 1.067 4.698.001 3.384 0 2.069-.001 1 1.06 1 2.372.998 3.683 2.063 4.748 3.378 4.75c.428 0 .825-.121 1.172-.318l7.413 5.753c-.63.95-1 2.087-1 3.311 0 1.282.406 2.467 1.093 3.443L9.8 19.188c-.178-.053-.363-.091-.56-.091-1.08 0-1.956.874-1.956 1.952 0 1.078.876 1.951 1.956 1.951 1.081 0 1.957-.873 1.957-1.95 0-.196-.038-.381-.091-.559l2.23-2.225c1.012.772 2.273 1.235 3.645 1.235 3.324 0 6.018-2.69 6.018-6.005 0-3.002-2.21-5.482-5.094-5.926",id:"sprocket__a"})),d.a.createElement("use",{xlinkHref:"#sprocket__a",fillRule:"evenodd"}))};Me.displayName="SVGSprocket";var Pe=Me,Ne=n("1geb"),qe=n("KUC+"),_e=function(e){Object(s.a)(t,e);function t(){Object(a.a)(this,t);return Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.liveChatHref,n=e.onLinkClick;return d.a.createElement("div",{className:"m-bottom-2 align-center justify-center"},d.a.createElement(Ae.a,{theme:Object(we.a)(Object(Ne.b)(Ee.m)),icon:d.a.createElement(Pe,null),className:"m-right-1"}),d.a.createElement(qe.a,{use:"help"},d.a.createElement(ke.a,{message:"conversations-visitor-experience-components.chatArea.branding_jsx",elements:{Link:Se},options:{ariaLabel:T.a.text("conversations-visitor-experience-components.chatArea.brandingAriaLabel"),href:t,onClick:n}})))}}]);return t}(d.a.PureComponent);_e.propTypes={liveChatHref:u.a.string,onLinkClick:u.a.func};_e.displayName="WidgetBranding";var Fe=_e,De=n("/wcQ"),Le=n("yybq"),Be=function(e){return{liveChatHref:Object(De.a)(e),onLinkClick:Le.clickedViralLink}},ze=Object(b.b)(Be)(Fe),Ue=n("sNjR"),He=1e3,Ve=p.e.div.withConfig({displayName:"UnifiedThreadView__UnifiedThreadViewWrapper",componentId:"sc-7c4u6b-0"})(["display:flex;flex-direction:column;height:",";"],function(e){return e.shouldShowMeetingsLink?"calc(100% - 44px)":"100%"}),Qe=function(e){Object(s.a)(t,e);function t(e){var n;Object(a.a)(this,t);(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={renderNewThreadPrompt:!e.isThreadStarted};return n}Object(r.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this,n=this.props,a=n.isThreadStarted,r=n.toggleOnAndOffInputFocus,i=e.isThreadStarted;a||a===i||setTimeout(function(){t.setRenderNewThreadPromptTrue();r(!1)},He);a&&this.state.renderNewThreadPrompt&&this.setRenderNewThreadPromptFalse()}},{key:"setRenderNewThreadPromptTrue",value:function(){this.setState({renderNewThreadPrompt:!0})}},{key:"setRenderNewThreadPromptFalse",value:function(){this.setState({renderNewThreadPrompt:!1})}},{key:"renderMessageEditor",value:function(){var e=this.props,t=e.requiresExplicitConsentToProcess,n=e.renderCookieConsentPrompt,a=this.state.renderNewThreadPrompt;return t||n||a?null:d.a.createElement(l.Fragment,null,d.a.createElement(ce,null),d.a.createElement(h.a,null))}},{key:"renderError",value:function(){var e=d.a.createElement(k.a,{message:"conversations-visitor-ui.network.pubSubFailure.title"});return d.a.createElement(C.a,{title:e,onClose:function(){}})}},{key:"render",value:function(){var e=this.props,t=e.shouldShowMeetingsLink,n=e.showingGdprProcess,a=e.showingHsBranding,r=e.renderCookieConsentPrompt,i=this.state.renderNewThreadPrompt;return d.a.createElement(Ve,{shouldShowMeetingsLink:t},d.a.createElement(Ue.a,{renderError:this.renderError,errorLoggingTitle:"ConnectedThreadHistory"},d.a.createElement(m.a,{shouldRenderNewThreadPrompt:i})),r&&d.a.createElement(Te.a,null),n&&!r&&d.a.createElement(xe,null),this.renderMessageEditor(),a&&d.a.createElement(ze,null))}}]);return t}(l.PureComponent);Qe.displayName="UnifiedThreadView";Qe.propTypes={isThreadStarted:u.a.bool.isRequired,renderCookieConsentPrompt:u.a.bool.isRequired,requiresExplicitConsentToProcess:u.a.bool.isRequired,shouldShowMeetingsLink:u.a.bool.isRequired,showingGdprProcess:u.a.bool.isRequired,showingHsBranding:u.a.bool.isRequired,toggleOnAndOffInputFocus:u.a.func.isRequired};t.a=Qe},ZjIF:function(e,t,n){"use strict";n.r(t);n.d(t,"getMessageId",function(){return i});var a=n("ib5I"),r=n("qeXV"),i=Object(a.a)([r.getLatestWidgetData],function(e){return e.message.id})},Zqdz:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n("ib5I"),r=n("HRPO"),i=n("ecbq"),o=n("qeXV"),s=n("3+Oy"),c=Object(a.a)([o.getLatestWidgetData,s.a],function(e,t){return Object(r.gdprConsentToProcessEnabled)(e)&&!t&&Object(i.gdprExplicitConsentRequired)(e)})},ZyKU:function(e,t,n){"use strict";n.d(t,"a",function(){return a});n.d(t,"b",function(){return r});n.d(t,"c",function(){return i});var a="filemanager/api",r=10485760,i=95},aiou:function(e,t,n){"use strict";var a=n("M0MQ"),r=n.n(a),i=n("ZQ2w"),o=n.n(i),s=n("/rKf");t.a=r()({displayName:"FormattedHTMLMessage",mixins:[s.a],propTypes:s.c,render:function(){this.props.message;var e=Object(s.b)(Object(s.d)(this.props));return o.a.createElement("i18n-string",Object.assign({},e,{dangerouslySetInnerHTML:{__html:this._getValue()}}))}})},b55K:function(e,t,n){"use strict";n("E7sj");var a=n("xq+X"),r=(n("N7U+"),["avatar"]),i=["data"],o=["email"],s=["firstName"],c=["id"],u=["lastName"],l=["senderType"],d=["status"];n.d(t,"a",function(){return p});n.d(t,"c",function(){return h});n.d(t,"d",function(){return m});n.d(t,"e",function(){return b});n.d(t,"f",function(){return f});n.d(t,"g",function(){return g});n.d(t,"b",function(){return v});n.d(t,"h",function(){return O});var p=Object(a.a)(r),h=Object(a.a)(o),m=Object(a.a)(s),b=Object(a.a)(c),f=Object(a.a)(u),g=Object(a.a)(l),v=Object(a.a)(i),O=Object(a.a)(d)},cXje:function(e,t){var n=Function.prototype.toString;function a(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}e.exports=a},cbPM:function(e,t){function n(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}e.exports=n},ce3V:function(e,t,n){var a=n("I04N");function r(e){return a(this.__data__,e)>-1}e.exports=r},d9q4:function(e,t,n){var a=n("XITf"),r=n("y3MR"),i="[object AsyncFunction]",o="[object Function]",s="[object GeneratorFunction]",c="[object Proxy]";function u(e){if(!r(e))return!1;var t=a(e);return t==o||t==s||t==i||t==c}e.exports=u},dIiL:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n("BjQQ"),r=Object(a.a)("currentUrl")},dQ1f:function(e,t,n){"use strict";n.r(t);n.d(t,"getFileSize",function(){return i});var a=n("BjQQ"),r=n("0U3V"),i=function(e){var t=Object(r.getFile)(e);return Object(a.a)("size",t)||0}},ecbq:function(e,t,n){"use strict";n.r(t);n.d(t,"gdprExplicitConsentRequired",function(){return o});var a=n("iRI7"),r=n("vIe5"),i=n("kd8B"),o=Object(a.a)(r.e,i.getGdprExplicitConsentRequired)},enlW:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n("xq+X"),r=function(e){return Object(a.a)(["id"],e)||Object(a.a)(["message","id"],e)||-1}},eqno:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var a=n("ib5I"),r=n("BjQQ"),i=n("O7fF"),o=n("eg8c"),s=n("CPNZ"),c=n("9VMc"),u=n("RS+R"),l=n("pnsR"),d=function(e){return e.clientData.isPubNubClientConnected},p=Object(r.a)("subscriptions"),h=Object(a.a)([l.a,c.getAsyncStagedThread,p,u.getAsyncPubSubClient,d],function(e,t,n,a,r){if(Object(o.isFailed)(e))return i.e;if(Object(o.isFailed)(t)){var c=Object(s.b)(t),u=c&&418===c.status;if(!c||!u)return i.a}return Object(o.isFailed)(n)?i.d:Object(o.isFailed)(a)?i.c:r?null:i.b})},fS1x:function(e,t,n){"use strict";n.r(t);n.d(t,"default",function(){return b});n.d(t,"publishEmailCaptureResponseMessage",function(){return b});var a=n("N7U+"),r=n("8GGp"),i=n("DR58"),o=n("K+6c"),s=n("tttP"),c=n("8JFU"),u=n("3ins"),l=n("pWAE"),d=n("mXvI"),p=n("rkDb"),h=n("Ybsy"),m=n("cep6"),b=function(e){var t=e.channel,n=e.email,b=e.threadId;return function(e,f){var g,v=Object(p.getSource)(Object(m.a)(f())),O=u.SYSTEM_SENDER;g=Object(l.isUngatedForPersistedMessages)(f())?new s.a({id:Object(d.generateUuid)(),text:n,sender:{"@type":O},status:{source:v,messageStatus:h.b}}):Object(r.buildUnpublishedMessage)({descriptor:{},metadata:new i.a({email:n}),senderId:o.a,senderType:a.d,threadId:b});e(Object(c.publishMessageToConversation)({channel:t,message:g,threadId:b}))}}},fwVr:function(e,t,n){var a=n("wzyz")(Object,"create");e.exports=a},"g+7s":function(e,t,n){var a=n("QWT7");function r(e){return a(this,e).has(e)}e.exports=r},g99b:function(e,t,n){"use strict";var a=n("PvDV"),r=n("y4Zp"),i=n.n(r),o=n("ZQ2w"),s=n.n(o),c=n("OCxt"),u=n("zw6w"),l=n("ZVA3"),d=n("PBb8"),p=n("0pNr"),h=n("10Vg"),m=h.h,b=h.j,f=(h.b,h.a,n("57xV")),g=function(e){var t=e.theme;switch(e.use){case p.PRIMARY:var n=m(t);return Object(c.d)(["background-color:",";"],Object(f.a)(n,20));case p.SECONDARY:default:var a=m(t);return Object(c.d)(["background-color:",";"],Object(f.a)(a,95))}},v=function(e){var t=e.theme;switch(e.use){case p.PRIMARY:var n=m(t);return Object(c.d)(["background-color:",";"],Object(f.a)(n,-10));case p.SECONDARY:default:var a=m(t);return Object(c.d)(["background-color:",";"],Object(f.a)(a,90))}},O=function(e){var t,n=e.theme,a=e.use,r=e.active,i=e.hover,o=e.disabled,s=e.isSubmitting;if(o&&!s)return Object(c.d)(["background-color:",";border:none;"],Object(h.a)(n));r&&(t=v({theme:n,use:a}));i&&(t=g({theme:n,use:a}));switch(a){case p.PRIMARY:return Object(c.d)(["background-color:",";border:none;",""],m(n),t);case p.SECONDARY:default:return Object(c.d)(["background-color:transparent;border-color:",";",""],m(n),t)}},j=function(e){var t=e.theme,n=e.use,a=e.disabled,r=e.isSubmitting;if(a&&!r)return Object(c.d)(["color:",";"],Object(h.b)(t));switch(n){case p.PRIMARY:return Object(c.d)(["color:",";"],b(t));case p.SECONDARY:default:return Object(c.d)(["color:",";"],m(t))}},y=Object(c.d)(["&:hover{","}&:active{","}"],g,v),C=c.e.button.withConfig({displayName:"VizExButton__AbstractVizExButton",componentId:"sc-1hxibsz-0"})(["flex-shrink:0;border-radius:3px;padding:",";font-size:",";line-height:16px;outline:none;transition:background-color 150ms ease-out;border-style:solid;border-width:1px;cursor:",";user-select:",";text-align:center;"," "," ",";&:focus{outline:0;}"],function(e){var t=e.size;return d.b[t]},function(e){var t=e.size;return d.a[t]},function(e){return e.disabled?"not-allowed":"pointer"},function(e){return e.disabled?"none":null},j,O,function(e){return e.disabled?null:y}),x=c.e.div.withConfig({displayName:"VizExButton__NoSelect",componentId:"sc-1hxibsz-1"})(["user-select:none;"]),T=function(e){var t=e.children,n=e.onClick,r=e.use,i=e.theme,o=e.hover,c=e.active,u=e.disabled,l=Object(a.a)(e,["children","onClick","use","theme","hover","active","disabled"]);return s.a.createElement(C,Object.assign({},l,{theme:i,use:r,onClick:n,hover:o,active:c,disabled:u}),s.a.createElement(x,null,t))};T.displayName="VizExButton";T.propTypes={active:i.a.bool,children:i.a.node,disabled:i.a.bool,hover:i.a.bool,onClick:i.a.func,size:i.a.oneOf(Object.keys(d.c)),theme:l.a,use:i.a.oneOf(Object.values(p))};T.defaultProps={use:p.SECONDARY,disabled:!1,size:u.e};t.a=T},gXf6:function(e,t,n){"use strict";var a=n("6+o1"),r=Object(a.Record)({avatar:null,email:null,firstName:null,id:null,lastName:null,senderType:null},"Sender");t.a=r},gXxc:function(e,t,n){"use strict";var a,r=n("nDpY"),i=n.n(r),o=n("ibZn"),s=n("gjBT"),c=n("u1T7"),u=n("2hC2"),l=n("8PIh"),d=n("G/XJ"),p=n("6+o1"),h=n("y4Zp"),m=n.n(h),b=n("ZQ2w"),f=n.n(b),g=n("OCxt"),v=n("4Oo9"),O=n("qBhh"),j=n("tuJS"),y=n("+wbG"),C=n("KMkU"),x=(a={},Object(O.a)(a,y.b,Object(C.a)()),Object(O.a)(a,y.a,Object(C.a)()),Object(O.a)(a,y.c,Object(C.a)({backgroundColor:j.c,borderColor:j.d})),a),T=Object(b.createContext)(x),k=n("UhTb"),E=n("12I0"),w=n("fWsJ"),I=function(e,t){return Object(v.getSenderId)(e)===Object(v.getSenderId)(t)&&Object(v.getSenderType)(e)===Object(v.getSenderType)(t)},R=function(e,t){return Object(v.getType)(e)===Object(v.getType)(t)},S=function(e){return function(t,n){var a=Object(v.getTimestamp)(t),r=Object(v.getTimestamp)(n);return Math.abs(a-r)>=e}}(6e4),A=function(e,t){e=Object(w.a)(e)||e;t=Object(w.a)(t)||t;return I(e,t)&&R(e,t)&&!S(e,t)},M=function(e){return Object(w.a)(e)||e},P=n("SRO8"),N=n("N8bW"),q=Object(P.a)(function(e,t){e=M(e);return Object(N.fileAttachmentIdsInMessage)(e).reduce(function(e,n){return t.has(""+n)?e.push(t.get(""+n)):e},Object(p.List)())}),_=n("enlW"),F=n("ZI8J"),D=function(e,t,n,a){var r,i=!t,o=!A(e,t),s=!a&&!A(e,n),c=!n,u=(r={},Object(O.a)(r,F.a,i),Object(O.a)(r,F.b,o),Object(O.a)(r,F.d,s),Object(O.a)(r,F.c,c),r);return Object.keys(u).reduce(function(e,t){return u[t]?e.add(t):e},Object(p.Set)())},L=n("mJQX"),B=n("iYCd"),z=function(e,t){return!Object.keys(e).some(function(n){return"fileAttachments"===n||"positionDescriptors"===n||"senders"===n?!Object(p.is)(e[n],t[n]):e[n]!==t[n]})},U=Object(b.memo)(function(e){var t=e.fileAttachments,n=e.historyConfig,a=e.message,r=e.portalId,i=e.positionDescriptors,o=e.presentSenderLocators,s=e.senders,c=e.visitorLastReadTimestamp,u=e.lastMessageId,l=Object(O.a)({},B.a,Object(_.a)(a)),d=n[Object(v.getType)(a)];return d?f.a.createElement("div",l,f.a.createElement(d,{fileAttachments:t,message:a,portalId:r,positionDescriptors:i,senders:s,presentSenderLocators:o,visitorLastReadTimestamp:c,lastMessageId:u})):null},z);U.displayName="MessageHistoryItem";U.propTypes={fileAttachments:m.a.instanceOf(p.List),historyConfig:m.a.object.isRequired,lastMessageId:m.a.string,message:m.a.instanceOf(p.Record).isRequired,portalId:m.a.number.isRequired,positionDescriptors:L.a.isRequired,presentSenderLocators:m.a.instanceOf(p.Set),senders:k.a,visitorLastReadTimestamp:m.a.number};U.defaultProps={innerRef:function(){},positionDescriptors:[]};var H=U,V=g.e.div.withConfig({displayName:"MessageHistory__ReflowElement",componentId:"sc-8u77yf-0"})(["z-index:0;padding-top:4px;padding-left:16px;padding-right:16px;flex-shrink:0;@media screen and (max-width:900px){padding-left:8px;padding-right:8px;}"]),Q=function(e){Object(d.a)(t,e);function t(){Object(s.a)(this,t);return Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}Object(c.a)(t,[{key:"getDontIncludeLastInGroup",value:function(e,t){var n=this.props.messages.get(t+2);return!(!n||!A(e,n))}},{key:"renderHistory",value:function(){var e=this,t=this.props,n=t.fileAttachments,a=t.getAdditionalPositionDescriptors,r=t.historyConfig,i=t.lastMessageId,o=t.messages,s=t.portalId,c=t.presentSenderLocators,u=t.senders,l=t.visitorLastReadTimestamp,d=a(o);return o.map(function(t,a){var h,m=a>0?o.get(a-1):void 0,b=o.get(a+1);Object(v.getType)(b)===E.v&&(h=e.getDontIncludeLastInGroup(t,a));var g=q(t,n),O=D(t,m,b,h),j=Object(v.getId)(t);O=O.merge(d.get(j,Object(p.Set)()));return f.a.createElement(H,{historyConfig:r,fileAttachments:g,portalId:s,positionDescriptors:O,key:Object(_.a)(t),message:t,senders:u,presentSenderLocators:c,visitorLastReadTimestamp:l,lastMessageId:i})})}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.themeConfig;return f.a.createElement(V,{className:t},f.a.createElement(T.Provider,{value:n},this.renderHistory()))}}]);return t}(f.a.PureComponent);Q.displayName="MessageHistory";Q.propTypes={className:m.a.string,fileAttachments:m.a.instanceOf(p.Map),getAdditionalPositionDescriptors:m.a.func,historyConfig:m.a.object.isRequired,lastMessageId:m.a.string,messages:m.a.instanceOf(p.List),portalId:m.a.number.isRequired,presentSenderLocators:m.a.instanceOf(p.Set),senders:k.a,themeConfig:m.a.object,visitorLastReadTimestamp:m.a.number};Q.defaultProps={getAdditionalPositionDescriptors:function(){return Object(p.Map)()},fileAttachments:Object(p.Map)(),preventAutoscroll:!1,presentSenderLocators:Object(p.Set)(),scrollContainerToBottom:function(){},displayEmailDeleteBanner:!1};var W=Q,Z=n("+UqK"),G=n("tFCq"),K=Object(b.memo)(function(e){var t=e.themeConfig,n=e.children;return f.a.createElement(G.a.Provider,{value:t},n)});K.displayName="ThemeConfigProvider";K.propTypes={children:m.a.node.isRequired,themeConfig:m.a.objectOf(Object(Z.a)("Theme"))};var X=K,Y=n("PhfE").a,J=n("u70c"),$=n("eg8c"),ee=n("xOvp"),te=n("p0mF"),ne=n("znLu"),ae=n("6uLn"),re=n("pnsR"),ie=n("V/zO"),oe=n("Pett"),se=function(e){var t=Object(re.a)(e);return{isLoadingHistory:Object($.isStarted)(t),loadingHistoryFailed:Object($.isFailed)(t),sessionId:Object(ee.getSessionId)(e),threadHistory:Object(ae.a)(e),threadId:Object(ie.getCurrentThreadId)(e),isOnFocus:Object(oe.a)(e)}},ce={fetchThreadHistory:te.fetchThreadHistory},ue=Object(o.b)(se,ce)(ne.a),le=n("9F9a"),de=Object(p.Record)({tileBackgroundColor:"rgba(255, 255, 255, 0.5)"},"FileAttachmentTheme"),pe=n("GqXo"),he=n("YDXn"),me=de({tileBackgroundColor:j.j}),be=function(e){var t,n=e.coloring;return t={},Object(O.a)(t,y.b,Object(he.a)({borderRadius:"0px 8px 8px 8px",borderWidth:"0px",fileAttachmentTheme:me})),Object(O.a)(t,y.a,Object(he.a)({borderRadius:"0px 8px 8px 8px",borderWidth:"0px",fileAttachmentTheme:me,widgetAccent:Object(le.c)(n)?j.k:Object(le.a)(n),quickReplyTheme:Object(pe.a)({borderColor:Object(le.c)(n)?j.h:Object(le.a)(n),color:Object(le.c)(n)?j.k:Object(le.b)(n)})})),Object(O.a)(t,y.c,Object(he.a)({alignItems:"flex-end",backgroundColor:Object(le.c)(n)?j.l:Object(le.a)(n),borderColor:"rgba(0, 0, 0, 0.2)",borderRadius:"8px 0px 8px 8px",borderWidth:"0px",textColor:Object(le.c)(n)?j.k:Object(le.b)(n),fileAttachmentTheme:me,widgetAccent:Object(le.c)(n)?j.k:Object(le.a)(n)})),t},fe=n("Kb5M"),ge=n("GME8"),ve=n("oT5E"),Oe=g.e.div.withConfig({displayName:"NewThreadPrompt__NewThreadpromptContainer",componentId:"efoo07-0"})(["padding:32px 20px 12px 20px;text-align:center;width:100%;"]);function je(e){var t=e.createNewThread;return f.a.createElement(ge.a,null,function(e){return f.a.createElement(Oe,null,f.a.createElement("p",{className:"m-bottom-0"},f.a.createElement(fe.a,{message:"conversations-visitor-ui.newThreadPrompt.newHeading",options:{locale:e}})),f.a.createElement(ve.a,{"data-test-id":"visitor-widget-start-new-thread-button",onClick:t},f.a.createElement(fe.a,{message:"conversations-visitor-ui.newThreadPrompt.newButton",options:{locale:e}})))})}je.propTypes={createNewThread:m.a.func.isRequired};je.displayName="NewThreadPrompt";var ye=je,Ce=n("xI+G"),xe=n("zC+/"),Te=function(e){return{accentColor:Object(le.a)(Object(xe.a)(e))}},ke={createNewThread:Ce.a},Ee=Object(o.b)(Te,ke)(ye),we=function(e){Object(d.a)(t,e);function t(){Object(s.a)(this,t);return Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.coloring,n=e.fileAttachments,a=e.messagesList,r=e.portalId,i=e.senders,o=e.shouldRenderNewThreadPrompt;return f.a.createElement(ue,{messageCount:Y(a),shouldScrollToBottom:o},f.a.createElement(X,{themeConfig:be({coloring:t})},f.a.createElement(W,{fileAttachments:n,historyConfig:J.a,messages:a,portalId:r,senders:i}),o&&f.a.createElement(Ee,null)))}}]);return t}(b.Component);we.propTypes={coloring:Object(Z.a)("ColoringRecord").isRequired,fileAttachments:m.a.instanceOf(p.Map).isRequired,messagesList:m.a.instanceOf(p.List),portalId:m.a.number.isRequired,senders:m.a.instanceOf(p.Map).isRequired,shouldRenderNewThreadPrompt:m.a.bool.isRequired};we.displayName="ThreadHistory";var Ie=we,Re=n("5EC7"),Se=n("KOwh"),Ae=n("oMfq"),Me=n("scsE"),Pe=n("H/O0"),Ne=function(e){var t;try{t=Object(Re.a)(e)}catch(e){Object(Me.reportError)({error:Object(Pe.a)("ConnectedChatHistoryGetMessagesList selector threw: "+e.message,e)});throw e}return{coloring:Object(xe.a)(e),fileAttachments:Object(Ae.a)(e),messagesList:t,portalId:i.a.get(),senders:Object(Se.a)(e)}},qe={};t.a=Object(o.b)(Ne,qe)(Ie)},gwgA:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a=1024},h8ap:function(e,t,n){var a=n("I04N");function r(e,t){var n=this.__data__,r=a(n,e);if(r<0){++this.size;n.push([e,t])}else n[r][1]=t;return this}e.exports=r},iKkD:function(e,t,n){"use strict";n.r(t);n.d(t,"attachmentUploadComplete",function(){return i});var a=n("CRij"),r=n("bDpH"),i=Object(a.createAction)(r.b)},iYCd:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a="data-cv-message-history-id"},ifQL:function(e,t,n){var a=n("QWT7");function r(e,t){var n=a(this,e),r=n.size;n.set(e,t);this.size+=n.size==r?0:1;return this}e.exports=r},igt9:function(e,t,n){var a=n("wxZq"),r=n("5EvN"),i=n("2aGJ"),o=n("7RMX"),s=n("/Zaq");function c(e){var t=-1,n=null==e?0:e.length;this.clear();for(;++t<n;){var a=e[t];this.set(a[0],a[1])}}c.prototype.clear=a;c.prototype.delete=r;c.prototype.get=i;c.prototype.has=o;c.prototype.set=s;e.exports=c},"ilp/":function(e,t,n){"use strict";var a=n("gjBT"),r=n("u1T7"),i=n("2hC2"),o=n("8PIh"),s=n("Cdni"),c=n("G/XJ"),u=n("E6l7"),l=n("aVsq"),d=n.n(l),p=n("y4Zp"),h=n.n(p),m=n("ZQ2w"),b=n.n(m),f=n("zYvt"),g=n("+Tc3"),v=n("+UqK"),O=n("ZyKU"),j=n("6+o1"),y=n("prD3"),C=n("Ogsy"),x=1e3,T=function(e){Object(c.a)(t,e);function t(e){var n;Object(a.a)(this,t);(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).publishTypingMessage=d()(n.props.publishTypingMessage,f.a,{leading:!0,trailing:!1,maxWait:f.a});n.onChatInputChanged=n.onChatInputChanged.bind(Object(s.a)(n));n.onPublishMessage=n.onPublishMessage.bind(Object(s.a)(n));n.onSelectAttachmentFiles=n.onSelectAttachmentFiles.bind(Object(s.a)(n));n.onRemoveAttachment=n.onRemoveAttachment.bind(Object(s.a)(n));n.inputStagingEvent=d()(n.props.inputStagingEvent,x);return n}Object(r.a)(t,[{key:"onChatInputChanged",value:function(e){var t=this.props,n=t.currentConversation,a=t.disablePublish,r=t.shouldSendInputStagingEvent,i=t.showInitialMessageBubble;(0,t.setMessageEditorStagingText)(e);a||this.publishTypingMessage({thread:n});r&&this.inputStagingEvent(e,!1);i&&this.props.closeInitialMessageBubble()}},{key:"onPublishMessage",value:function(e){var t=e.text,n=e.richText,a=e.quickReply,r=this.props,i=r.messagesPageUri,o=r.publishMessage,s=r.stagedAttachments,c=r.removeMessageEditorStagingText;this.publishTypingMessage.cancel();o({text:t,richText:n,quickReply:a,url:i,fileAttachment:Object(y.a)(s)});c()}},{key:"onSelectAttachmentFiles",value:function(e){var t=e.files;if(t&&t.length){var n=this.props,a=n.onSelectAttachmentFile,r=n.currentConversation;a({file:t.item(0),thread:r})}}},{key:"onRemoveAttachment",value:function(e){var t=e.attachment,n=this.props,a=n.currentConversation,r=n.onRemoveAttachment;r({attachment:t,thread:a})}},{key:"render",value:function(){var e=this.props,t=e.coloring,n=e.currentConversation,a=e.disablePublish,r=e.disableTextInput,i=e.isOnFocus,o=e.mobile,s=e.networkOffline,c=e.shouldDisableAttachment,l=e.shouldSendInputStagingEvent,d=e.showingHsBranding,p=e.stagedAttachments,h=e.toggleOnAndOffInputFocus,m=e.stagedMessage,f=e.showQuickReplyPlaceholder;return b.a.createElement(u.a,{coloring:t,chatInputChanged:this.onChatInputChanged,disabled:r,disablePublish:a,isOnFocus:i,maxAttachmentFileSize:O.b,mobile:o,networkOffline:s,onSelectAttachmentFiles:this.onSelectAttachmentFiles,onRemoveAttachment:this.onRemoveAttachment,publishMessage:this.onPublishMessage,shouldDisableAttachment:c,showingHsBranding:d,stagedAttachments:p,stagedMessageEditorText:m,supportsAttachments:Object(g.isPersistedThread)(n),toggleOnAndOffInputFocus:h,fileTypes:C.a,showQuickReplyPlaceholder:f,shouldSendInputStagingEvent:l,inputStaging:this.inputStagingEvent})}}]);return t}(m.PureComponent);T.displayName="MessageEditorWrapper";T.propTypes={closeInitialMessageBubble:h.a.func.isRequired,coloring:Object(v.a)("ColoringRecord").isRequired,currentConversation:Object(v.a)("Thread"),disablePublish:h.a.bool.isRequired,disableTextInput:h.a.bool.isRequired,inputStagingEvent:h.a.func,isOnFocus:h.a.bool.isRequired,messagesPageUri:h.a.string,mobile:h.a.bool,networkOffline:h.a.bool.isRequired,onRemoveAttachment:h.a.func.isRequired,onSelectAttachmentFile:h.a.func.isRequired,publishMessage:h.a.func.isRequired,publishTypingMessage:h.a.func.isRequired,removeMessageEditorStagingText:h.a.func.isRequired,setMessageEditorStagingText:h.a.func.isRequired,shouldDisableAttachment:h.a.bool,shouldSendInputStagingEvent:h.a.bool.isRequired,showInitialMessageBubble:h.a.bool.isRequired,showQuickReplyPlaceholder:h.a.bool.isRequired,showingHsBranding:h.a.bool.isRequired,stagedAttachments:h.a.instanceOf(j.List),stagedMessage:h.a.string,toggleOnAndOffInputFocus:h.a.func};t.a=T},ivel:function(e,t,n){"use strict";n.r(t);n.d(t,"applyGdprConsent",function(){return i});var a=n("DHw3"),r=n("3ApS"),i=function(){return function(e,t){Object(r.shouldRecordImplicitConsentToProcess)(t())&&e(Object(a.consentToProcess)());return Promise.resolve()}}},jmu2:function(e,t){e.exports="//static.hsappstatic.net/salesImages/static-1.409/messages/bot-avatar.svg"},lBOe:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n("BjQQ"),r=Object(a.a)("fileUploads")},lEuo:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n("4scq"),r=n("Jtvd"),i=n("nncj");function o(){return function(e,t){e(Object(r.handleStoreMessagesCookie)(Object(a.getMessagesUtk)(t())));e(Object(i.trackInteraction)("widget-interaction",{action:"clicked consent to cookies button"}))}}},m17H:function(e,t,n){"use strict";n.r(t);n.d(t,"getFileName",function(){return i});var a=n("BjQQ"),r=n("0U3V"),i=function(e){var t=Object(r.getFile)(e);return Object(a.a)("name",t)||""}},mJQX:function(e,t,n){"use strict";var a=n("y4Zp"),r=n.n(a),i=n("AXPb");t.a=Object(i.setOf)(r.a.string)},mluK:function(e,t,n){"use strict";n.r(t);n.d(t,"sendConsentToCommunicate",function(){return s});var a=n("nDpY"),r=n.n(a),i=n("kMAx"),o="livechat-public/v1/privacy/consentToCommunicate";function s(e){var t=e.sessionId,n=e.hubspotUtk,a=e.threadId;return i.a.put(o,{query:{sessionId:t,hubspotUtk:n,threadId:a,portalId:r.a.get()}})}},nqur:function(e,t,n){var a=n("XuUM"),r=n("QzTW"),i=n("BOd2"),o=n("g+7s"),s=n("ifQL");function c(e){var t=-1,n=null==e?0:e.length;this.clear();for(;++t<n;){var a=e[t];this.set(a[0],a[1])}}c.prototype.clear=a;c.prototype.delete=r;c.prototype.get=i;c.prototype.has=o;c.prototype.set=s;e.exports=c},oDJb:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var a=n("BjQQ"),r=Object(a.a)("fileUploadsErrors")},oEjG:function(e,t,n){"use strict";n.r(t);n.d(t,"removeAttachment",function(){return i});var a=n("CRij"),r=n("bDpH"),i=Object(a.createAction)(r.g)},oLNr:function(e,t,n){"use strict";n.r(t);n.d(t,"uploadAttachmentClient",function(){return r});var a=n("SiYo"),r=function(e){var t=e.formData,n=e.uploadUrl,r=e.onProgress,i=void 0===r?function(){}:r;return a.a.post(n,{headers:{"content-type":!1},data:t,timeout:0,withXhr:function(e){e.upload.addEventListener("progress",i,!1)}})}},oMfq:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var a=n("CPNZ"),r=n("eg8c"),i=n("OUFc"),o=n("6+o1"),s=n("ib5I"),c=n("oEKk"),u=n("Gcf9"),l=Object(s.a)([u.a],function(e){return e&&Object(i.getEntries)(e).size?Object(i.getEntries)(e).reduce(function(e,t,n){return t&&n&&Object(r.isSucceeded)(t)?Object(c.a)(String(n),Object(a.a)(t),e):e},Object(o.Map)()):Object(o.Map)()})},ooj3:function(e,t,n){"use strict";var a=n("ZQ2w"),r=n.n(a),i=n("OCxt"),o=n("Kb5M"),s=i.e.div.withConfig({displayName:"ErrorState__ErrorWrapper",componentId:"sc-158c0d-0"})(["display:flex;justify-content:center;align-items:center;height:100%;flex-direction:column;"]),c=function(){return r.a.createElement(s,null,r.a.createElement("h5",null,r.a.createElement(o.a,{message:"conversations-visitor-ui.asyncError.body"})),r.a.createElement("div",{className:"m-top-3"},r.a.createElement(o.a,{message:"conversations-visitor-ui.asyncError.noRetry"})))};c.displayName="ErrorState";var u=c,l=i.e.div.withConfig({displayName:"ThreadHistoryError__ThreadHistoryErrorWrapper",componentId:"sc-73lsqe-0"})(["text-align:center;flex-grow:1;"]),d=function(){return r.a.createElement(l,null,r.a.createElement(u,null))};d.displayName="ThreadHistoryError";t.a=d},p7yW:function(e,t,n){"use strict";var a=n("u9LH"),r=n("y4Zp"),i=n.n(r),o=n("ZQ2w"),s=n.n(o),c=n("OCxt"),u=n("RlAi"),l=n("g99b"),d=n("Kb5M"),p=n("tuJS"),h=n("NiVr"),m=n("GME8"),b=n("KUC+"),f=c.e.div.withConfig({displayName:"ConsentPrompt__Container",componentId:"j5knsa-0"})(["border-top:2px solid ",";display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;padding:12px 24px;"],p.f),g=Object(c.e)(b.a).withConfig({displayName:"ConsentPrompt__SmallNoParagraphPadding",componentId:"j5knsa-1"})(["display:block;word-break:break-word;word-wrap:break-word;-ms-word-break:break-all;p{margin-bottom:0;}"]),v=Object(c.e)(l.a).withConfig({displayName:"ConsentPrompt__FullWidthButton",componentId:"j5knsa-2"})(["flex:0 1 100%;"]),O=c.e.div.withConfig({displayName:"ConsentPrompt__FlexWrapper",componentId:"j5knsa-3"})(["display:flex;flex-direction:row;width:100%;margin:12px 0 8px 0;"]),j=function(e){var t=e.message,n=e.onClick,r=e.showButton,i=Object(o.useState)(!1),c=Object(a.a)(i,2),l=c[0],p=c[1],b=function(){n();p(!0)};return s.a.createElement(f,{"data-test-id":"gdpr-consent-prompt"},s.a.createElement(g,{use:"help","data-test-id":"gdpr-consent-text",dangerouslySetInnerHTML:{__html:Object(h.a)(t)}}),s.a.createElement(O,null,r&&s.a.createElement(u.a,{currentState:l?"submitting":"ready",Button:v,"data-test-id":"gdpr-consent-agree-button",onClick:b},s.a.createElement(m.a,null,function(e){return s.a.createElement(d.a,{message:"conversations-visitor-experience-components.buttons.agree",options:{locale:e}})}))))};j.propTypes={message:i.a.string.isRequired,onClick:i.a.func.isRequired,showButton:i.a.bool.isRequired};j.displayName="ConsentPrompt";t.a=j},pBhj:function(e,t,n){"use strict";var a=n("gjBT"),r=n("u1T7"),i=n("2hC2"),o=n("8PIh"),s=n("G/XJ"),c=n("y4Zp"),u=n.n(c),l=n("ZQ2w"),d=n.n(l),p=n("OCxt"),h=n("DM3q"),m=n("SxW6"),b=n("Ec4V"),f=n("SsR0"),g=n("AZVQ"),v=n("tuJS"),O=p.e.div.withConfig({displayName:"ChatAreaAlert__Wrapper",componentId:"sc-1m12dm2-0"})(["width:100%;display:flex;justify-content:center;background-color:transparent;"]),j=p.e.div.withConfig({displayName:"ChatAreaAlert__Alert",componentId:"sc-1m12dm2-1"})(["display:flex;justify-content:flex-end;align-items:center;padding:7px 14px;min-width:85%;background-color:",";border:1px solid ",";font-weight:500;font-size:12px;"],v.n,v.o),y=p.e.div.withConfig({displayName:"ChatAreaAlert__Title",componentId:"sc-1m12dm2-2"})(["flex:0 1 100%;"]),C=p.e.div.withConfig({displayName:"ChatAreaAlert__LinkWrapper",componentId:"sc-1m12dm2-3"})(["flex:0 0 auto;"]),x=Object(p.e)(h.a).withConfig({displayName:"ChatAreaAlert__StyledCloseButton",componentId:"sc-1m12dm2-4"})(["position:static;flex:0 0 12px;margin-left:20px;"]),T=function(e){Object(s.a)(t,e);function t(){Object(a.a)(this,t);return Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}Object(r.a)(t,[{key:"render",value:function(){return d.a.createElement(O,null,d.a.createElement(j,null,d.a.createElement(y,null,this.props.title),d.a.createElement(C,null,this.props.link),d.a.createElement(x,{use:"transparent-on-background",theme:Object(g.i)(v.p,Object(f.a)()),onClick:this.props.onClose},d.a.createElement(m.a,{icon:d.a.createElement(b.a,null)}))))}}]);return t}(d.a.Component);T.propTypes={link:u.a.node,onClose:u.a.func.isRequired,title:u.a.node.isRequired};T.defaultProps={onClose:function(){}};T.displayName="ChatAreaAlert";t.a=T},pnsR:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var a=n("OUFc"),r=n("ib5I"),i=n("AAJh"),o=n("V/zO"),s=Object(r.a)([i.a,o.getCurrentThreadId],function(e,t){return"number"!=typeof t?null:Object(a.getEntry)(t,e)||null})},prD3:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n("0U3V"),r=n("O1Zz"),i=n("wP5o"),o=function(e){if(!e)return null;var t=e.filter(r.isUploadCompleted).map(a.getFileId);return t.size?Object(i.a)({fileIds:t}):null}},qENm:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n("CPNZ"),r=n("OUFc"),i=n("ib5I"),o=n("V/zO"),s=n("aCdO"),c=n("gupl"),u=Object(i.a)([c.a,o.getCurrentThreadId],function(e,t){var n=Object(r.getEntries)(e).map(a.a);return Object(s.getSortedMessagesByThreadId)(n,t)})},rXC1:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var a=n("qBhh"),r=n("3ins"),i=n("rkDb"),o=n("8JFU"),s=n("4scq"),c=n("SXe/"),u=n("mXvI"),l=n("DbbD"),d=n("Ybsy"),p=function(e){var t=e.thread;return function(e,n){var p=Object(i.getChannelName)(t),h=Object(i.getThreadId)(t),m=Object(i.getSource)(t),b=r.VISITOR_SENDER,f=Object(l.a)(b),g=Object(s.getMessagesUtk)(n()),v=new c.a({id:Object(u.generateUuid)(),typingState:null,sender:Object(a.a)({"@type":b},f,g),status:{source:m,messageStatus:d.b}});e(Object(o.publishMessageToConversation)({channel:p,message:v,threadId:h}))}}},rvWB:function(e,t,n){"use strict";n.r(t);n.d(t,"uploadAttachment",function(){return f});var a=n("u9LH"),r=n("0U3V"),i=n("nncj"),o=n("xOvp"),s=n("M+r2"),c=n("oLNr"),u=n("W3K0"),l=n("32t3"),d=n("iKkD"),p=n("T7hB"),h=n("wVuR"),m=n("+rg3"),b=n("ZyKU"),f=function(e){var t=e.attachment,n=e.threadId;return function(e,f){var g=Date.now();e(Object(l.attachmentUploadStart)({attachment:t,threadId:n}));var v=Object(o.getSessionId)(f()),O=Object(r.getLocalId)(t),j=Object(r.getFile)(t),y=Object(u.createFormDataForAttachment)({file:j});return Object(s.fetchAttachmentUploadUrlClient)({sessionId:v,threadId:n}).then(function(t){var a=t.uploadUrl;return Object(c.uploadAttachmentClient)({formData:y,onProgress:function(t){var a=t.loaded,r=t.total;e(Object(h.handleAttachmentUploadProgress)({localId:O,threadId:n,loaded:a,total:r}))},uploadUrl:b.a+"/"+a})}).then(function(t){var r=Object(a.a)(t.objects,1)[0],o=Date.now();e(Object(d.attachmentUploadComplete)({localId:O,threadId:n,fileId:r.id,uploadedFile:r}));e(Object(i.trackInteraction)("attached-file",{action:"attached file","attachment-type":r.extension,"attachment-size-bytes":j.size,"upload-time-ms":o-g}))}).catch(function(){e(Object(m.attachmentError)(p.b,n));e(Object(i.trackInteraction)("failed-to-attach-file",{action:"failed to attach file","failure-type":"upload error"}))})}}},sToE:function(e,t,n){"use strict";n.r(t);n.d(t,"validateAttachmentFile",function(){return o});var a=n("T7hB"),r=n("LI65"),i=n("LnAc"),o=function(e){var t=Object(i.a)();Object(r.fileExceedsSizeLimit)(e)?t.reject(a.a):t.resolve();return t.promise}},sxvv:function(e,t,n){"use strict";n.r(t);n.d(t,"generateIdForFile",function(){return a});var a=function(e){var t=e.file,n=e.timestamp;return t.name+"-"+n}},t2YF:function(e,t,n){"use strict";var a=n("gjBT"),r=n("u1T7"),i=n("2hC2"),o=n("8PIh"),s=n("G/XJ"),c=n("y4Zp"),u=n.n(c),l=n("ZQ2w"),d=n.n(l),p=n("OCxt"),h=n("tuJS"),m=n("p7yW"),b=n("+UqK"),f=n("pBhj"),g=n("Kb5M"),v=p.e.div.withConfig({displayName:"ProcessConsentPrompt__ConsentPromptWrapper",componentId:"sc-9lwhbi-0"})(["border-top:2px solid ",";"],h.f),O=p.e.div.withConfig({displayName:"ProcessConsentPrompt__AlertWrapper",componentId:"sc-9lwhbi-1"})(["margin:10px;"]),j=function(e){Object(s.a)(t,e);function t(){Object(a.a)(this,t);return Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}Object(r.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.trackInteraction)("widget-interaction",{action:"view consent to process"})}},{key:"render",value:function(){var e=this.props,t=e.coloring,n=e.consentToProcess,a=e.consentToProcessError,r=e.consentToProcessMessage,i=e.dismissConsentToProcessError,o=e.showGdprConsentToProcessButton;return d.a.createElement(v,null,a?d.a.createElement(O,null,d.a.createElement(f.a,{title:d.a.createElement(g.a,{message:"conversations-visitor-ui.network.offline.title"}),onClose:i})):d.a.createElement(m.a,{showButton:o,message:r,onClick:n,coloring:t}))}}]);return t}(l.Component);j.displayName="ProcessConsentPrompt";j.propTypes={coloring:Object(b.a)("ColoringRecord"),consentToProcess:u.a.func,consentToProcessError:u.a.bool,consentToProcessMessage:u.a.string,dismissConsentToProcessError:u.a.func,showGdprConsentToProcessButton:u.a.bool,trackInteraction:u.a.func};t.a=j},tFCq:function(e,t,n){"use strict";n.d(t,"b",function(){return u});var a,r=n("qBhh"),i=n("tuJS"),o=n("ZQ2w"),s=n("+wbG"),c=n("YDXn"),u=(a={},Object(r.a)(a,s.b,Object(c.a)()),Object(r.a)(a,s.a,Object(c.a)()),Object(r.a)(a,s.c,Object(c.a)({backgroundColor:i.c,borderColor:i.d,alignment:"flex-end"})),a),l=Object(o.createContext)(u);t.a=l},tRLC:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n("ib5I"),r=n("BjQQ"),i=n("oDJb"),o=n("rkDb"),s=n("Xqh6"),c=Object(a.a)([i.a,s.a],function(e,t){var n=Object(o.getThreadId)(t);return Object(r.a)(n,e)||null})},u70c:function(e,t,n){"use strict";var a,r=n("qBhh"),i=n("UaBW"),o=n("gjBT"),s=n("u1T7"),c=n("2hC2"),u=n("8PIh"),l=n("G/XJ"),d=n("y4Zp"),p=n.n(d),h=n("Cdni"),m=n("+UqK"),b=n("OCxt"),f=n("tuJS"),g="default",v="blank",O="on-shade",j="on-dark",y=(a={},Object(r.a)(a,g,{primary:f.j,secondary:f.l}),Object(r.a)(a,O,{primary:f.l,secondary:f.j}),Object(r.a)(a,j,{primary:f.k,secondary:f.r}),a),C="\n  background: "+f.q+";\n",x=function(e){var t=e.primary;return"\n  background: "+t+";\n  background: linear-gradient(to right, "+t+", "+e.secondary+" 20%, "+t+" 40%);\n  background-size: 1200px;\n"},T=function(e){return y[e]},k=function(e){var t=e.use;return t===v?C:x(T(t))},E=function(e){return"number"==typeof e},w=function(e){return E(e)?e+"px":e},I="1s",R="linear",S="0s",A="infinite",M="forwards",P=700,N=Object(b.f)(["0%{background-position:-","px 0}100%{background-position:","px 0}"],P,P),q=Object(b.d)(["animation:"," "," "," "," "," ",";"],N,I,R,S,A,M),_=b.e.div.withConfig({displayName:"SkeletonBase",componentId:"naonl1-0"})(["margin:",";padding:",";",";",";"],function(e){var t=e.margin;return t?w(t):void 0},function(e){var t=e.padding;return t?w(t):void 0},function(e){var t=e.use;return k({use:t})},function(e){return e.use!==v&&q});_.defaultProps={use:g};_.propTypes={margin:p.a.oneOfType([p.a.number,p.a.string]),padding:p.a.oneOfType([p.a.number,p.a.string]),use:p.a.oneOf([g,O,j,v])};var F=_,D=32,L=Object(b.e)(F).withConfig({displayName:"SkeletonCircle",componentId:"sc-1a3tugc-0"})(["border-radius:50%;width:",";height:",";min-width:",";"],function(e){var t=e.size;return w(t)},function(e){var t=e.size;return w(t)},function(e){var t=e.size;return w(t)});L.defaultProps={size:D};L.propTypes={size:p.a.number};var B=L,z=n("ZQ2w"),U=n.n(z),H=n("OiaJ"),V=n("lY+d"),Q=n("b55K"),W=n("jmu2"),Z=n.n(W),G=n("N7U+"),K=function(){},X=function(e){Object(l.a)(t,e);function t(e){var n;Object(o.a)(this,t);(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleClick=n.handleClick.bind(Object(h.a)(n));return n}Object(s.a)(t,[{key:"handleClick",value:function(){var e=this.props;(0,e.onClick)(e.sender)}},{key:"render",value:function(){var e=this.props,t=e.isLoading,n=e.sender,a=e.size;if(t)return U.a.createElement(B,{size:32});if(!n)return U.a.createElement(H.a,{size:a});switch(Object(V.getSenderType)(n)){case G.b:case G.d:return U.a.createElement(H.a,{size:a,src:Object(Q.a)(n)||Z.a});default:return U.a.createElement("span",{onClick:this.handleClick},U.a.createElement(H.a,{size:a,src:Object(Q.a)(n)}))}}}]);return t}(z.PureComponent);X.displayName="SenderAvatar";X.propTypes={isLoading:p.a.bool,onClick:p.a.func.isRequired,sender:Object(m.a)("Sender"),size:H.a.propTypes.size};X.defaultProps={onClick:K,size:"sm"};var Y=n("+wbG"),J=n("mJQX"),$=n("UhTb"),ee=n("SRO8"),te=n("FT30"),ne=Object(ee.a)(function(e,t,n){return t?n.get(Object(te.buildSenderLocator)(t,e)):null}),ae="STARTED",re=Object(ee.a)(function(e){return!Object(Q.b)(e)&&Object(Q.h)(e)===ae}),ie="#cbd6e2",oe="#00a4bd",se=window.navigator?navigator.userAgent.toLowerCase():"",ce=function(){return se.includes("trident/")>=0},ue=n("BjQQ"),le=Object(ue.a)("alignItems"),de=Object(ue.a)("avatarWidth"),pe=Object(ue.a)("backgroundColor"),he=Object(ue.a)("borderColor"),me=Object(ue.a)("borderRadius"),be=Object(ue.a)("borderWidth"),fe=(Object(ue.a)("messageSpacing"),Object(ue.a)("textColor")),ge=Object(ue.a)("fileAttachmentTheme"),ve=(Object(ue.a)("quickReplyTheme"),Object(ue.a)("widgetAccent")),Oe=n("YDXn"),je=Object(z.createContext)(Object(Oe.a)()),ye=Object(b.f)(["25%{background-color:",";}75%{background-color:",";}"],ie,ie),Ce=Object(b.f)(["0%,100%{transform:translateY(0);}25%{transform:translateY(.25em);}50%{transform:translateY(0);}75%{transform:translateY(-.25em);}"]);ce()&&(Ce=Object(b.f)(["0%,100%{top:0;}25%{top:.25em;}50%{top:0}75%{top:-.25em;}"]));var xe=b.e.div.withConfig({displayName:"TypingDots__Dot",componentId:"sc-6x71qk-0"})(["position:relative;background-color:currentColor;color:",";border-radius:50%;height:1em;width:1em;animation:",",",";animation-duration:1s;animation-timing-function:linear;animation-iteration-count:infinite;&:not(:last-child){margin-right:0.75em;}&:nth-child(2){animation-delay:-0.66s;}&:nth-child(3){animation-delay:-0.33s;}"],function(e){return e.color?e.color:oe},Ce,ye),Te=b.e.div.withConfig({displayName:"TypingDots__TypingDotsWrapper",componentId:"sc-6x71qk-1"})(["display:flex;align-items:center;justify-content:center;height:24px;font-size:8px;width:4.5em;"]),ke=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"render",value:function(){var e=ve(this.context);return U.a.createElement(Te,null,U.a.createElement(xe,{color:e,className:"dot-1"}),U.a.createElement(xe,{color:e,className:"dot-2"}),U.a.createElement(xe,{color:e,className:"dot-3"}))}}]);return t}(z.Component);ke.contextType=je;ke.displayName="TypingDots";var Ee=ke,we=n("4Oo9"),Ie=b.e.div.withConfig({displayName:"SpacingWrapper",componentId:"sc-6qwhxh-0"})(["padding-top:4px;padding-bottom:4px;padding-left:10px;padding-right:10px;width:100%;"]),Re=p.a.oneOf([Y.b,Y.a,Y.c]),Se=n("tFCq"),Ae=n("I5v7"),Me=function(e){Object(Ae.a)(void 0===e||"object"==typeof e,"Invalid config type given");e&&Object.values(e).forEach(function(e){Object(Ae.a)(e instanceof Oe.a,"All themes in the configuration must be a `Theme` record. Found %s",typeof e)})},Pe=Object(z.memo)(function(e){var t=e.themeConfig,n=e.use,a=e.children;Me(t);t=Object.assign({},Se.b,t);var r=n?t[n]:t[Y.b]||Object(Oe.a)();return U.a.createElement(je.Provider,{value:r},a)});Pe.displayName="ThemeProvider";Pe.propTypes={children:p.a.node.isRequired,themeConfig:p.a.objectOf(Object(m.a)("Theme")),use:Re};var Ne=Pe,qe=b.e.div.withConfig({displayName:"PrimaryMessageAvatar__PrimaryMessageAvatarWrapper",componentId:"sc-1xszcry-0"})(["align-items:center;display:flex;flex-shrink:0;justify-items:center;margin-top:35px;"]),_e=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.className;return U.a.createElement(qe,{className:n},t)}}]);return t}(z.PureComponent);_e.displayName="PrimaryMessageAvatar";_e.propTypes={children:p.a.node.isRequired,className:p.a.string};var Fe=b.e.div.withConfig({displayName:"PrimaryMessageContentSection__PaddedArea",componentId:"muamdx-0"})(["padding:8px 16px;"]),De=b.e.div.withConfig({displayName:"PrimaryMessageContentSection__PrimaryMessageContentSectionWrapper",componentId:"muamdx-1"})(["width:100%;button{width:auto;}"]),Le=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"renderContent",value:function(){var e=this.props.children;return U.a.createElement(Fe,null,e)}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.className;return U.a.Children.count(t)>0?U.a.createElement(De,{className:n},U.a.createElement("div",{className:"width-100 padding-x-4 padding-y-2"},this.renderContent())):null}}]);return t}(z.PureComponent);Le.contextType=je;Le.displayName="PrimaryMessageContentSection";Le.propTypes={children:p.a.node,className:p.a.string};var Be=b.e.div.withConfig({displayName:"PrimaryMessageContent__PrimaryMessageContentWrapper",componentId:"j69wmt-0"})(["position:relative;min-height:32px;word-break:break-word;box-sizing:border-box;border-style:solid;border-width:",";border-color:",";background-color:",";color:",";display:inline-flex;align-items:center;flex-direction:column;border-radius:",";","{border-top-style:solid;border-top-width:1px;border-top-color:",";&:first-child{border-top:none;}}max-width:284px;"],function(e){return e.borderWidth},function(e){return e.borderColor},function(e){return e.backgroundColor},function(e){return e.textColor},function(e){return e.borderRadius},De,function(e){return e.borderColor}),ze=function(e){Object(l.a)(t,e);function t(e){var n;Object(o.a)(this,t);(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={expanded:!!e.isLastMessage};n.onCollapseButtonClick=n.onCollapseButtonClick.bind(Object(h.a)(n));n.expandMessage=n.expandMessage.bind(Object(h.a)(n));return n}Object(s.a)(t,[{key:"onCollapseButtonClick",value:function(){this.setState({expanded:!1})}},{key:"expandMessage",value:function(){this.state.expanded||this.setState({expanded:!0})}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.className;return U.a.createElement(Be,{className:n,backgroundColor:pe(this.context),borderColor:he(this.context),borderRadius:me(this.context),borderWidth:be(this.context),textColor:fe(this.context)},t)}}]);return t}(z.PureComponent);ze.contextType=je;ze.displayName="PrimaryMessageContent";ze.propTypes={children:p.a.node,className:p.a.string,isLastMessage:p.a.bool};var Ue=b.e.div.withConfig({displayName:"PrimaryMessageFooter__PrimaryMessageFooterWrapper",componentId:"c0h93a-0"})(["display:flex;margin-top:4px;max-width:284px;"]),He=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.className;return U.a.createElement(Ue,{className:n},t)}}]);return t}(z.PureComponent);He.displayName="PrimaryMessageFooter";He.propTypes={children:p.a.node.isRequired,className:p.a.string};var Ve=b.e.div.withConfig({displayName:"PrimaryMessageHeader__PrimaryMessageHeaderWrapper",componentId:"sc-1edpbhg-0"})(["display:flex;height:16px;align-items:center;margin-top:4px;margin-bottom:4px;width:100%;"]),Qe=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.className;return U.a.createElement(Ve,{className:n},t)}}]);return t}(z.PureComponent);Qe.displayName="PrimaryMessageHeader";Qe.propTypes={children:p.a.node.isRequired,className:p.a.string};var We=b.e.div.withConfig({displayName:"PrimaryMessageHeaderContent__PrimaryMessageHeaderContentWrapper",componentId:"nn2j4q-0"})(["margin-left:1px;min-width:0;"]),Ze=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.className;return U.a.createElement(We,{className:n},t)}}]);return t}(z.PureComponent);Ze.displayName="PrimaryMessageHeaderContent";Ze.propTypes={children:p.a.node.isRequired,className:p.a.string};var Ge="8px",Ke=b.e.div.withConfig({displayName:"PrimaryMessage__PrimaryMessageWrapper",componentId:"sc-1pvgcvg-0"})(["display:flex;flex-direction:column;align-items:",";padding-left:",";","{","{width:",";margin-left:-",";margin-right:",";}>:first-child{&","{margin-left:",";}}}","{margin-left:",";}","{margin-left:",";}"],function(e){return e.alignment||"flex-start"},Ge,Ve,qe,function(e){return e.avatarWidth},Ge,Ge,We,function(e){return e.avatarWidth},Be,function(e){return e.avatarWidth},Ue,function(e){return e.avatarWidth}),Xe=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.children,a=t.className,r=t.positionDescriptors,i=t.use;return n?U.a.createElement(Ne,{themeConfig:this.context,use:i},U.a.createElement(Ie,{positionDescriptors:r,className:a},U.a.createElement(je.Consumer,null,function(t){return U.a.createElement(Ke,{"data-test-id":e.props["data-test-id"],"data-test-use":i,alignment:le(t),avatarWidth:de(t)},n)}))):null}}]);return t}(z.PureComponent);Xe.contextType=Se.a;Xe.displayName="PrimaryMessage";Xe.propTypes={children:p.a.node,className:p.a.string,"data-test-id":p.a.string,positionDescriptors:J.a,use:Re};var Ye=n("PvDV"),Je=b.e.div.withConfig({displayName:"SkeletonText__SkeletonTextWrapper",componentId:"l81tz-0"})(["position:relative;width:",";"],function(e){var t=e.width;return w(t)}),$e=Object(b.e)(F).withConfig({displayName:"SkeletonText__SkeletonTextInner",componentId:"l81tz-1"})(["height:0.75em;left:0;position:absolute;top:50%;transform:translateY(-50%);width:100%;"]),et=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.width,n=Object(Ye.a)(e,["width"]);return U.a.createElement(Je,{width:t}," ",U.a.createElement($e,n))}}]);return t}(U.a.PureComponent);et.defaultProps={width:"100%"};et.propTypes={width:p.a.oneOfType([p.a.number,p.a.string])};var tt=et,nt=n("KUC+"),at=n("Kb5M"),rt=n("qcdW"),it=n("uAz/"),ot=["de","ja"],st=function(e,t){var n=e.givenName,a=e.familyName,r=e.email,i=t&&t.locale||Object(rt.a)();return ot.indexOf(i)>=0||!n?Object(it.a)({firstName:n,lastName:a,email:r},t):n},ct=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"getUnknownSenderText",value:function(){switch(Object(Q.g)(this.props.sender)){case G.b:return U.a.createElement(at.a,{message:"conversations-message-history.responder.bot"});case G.a:return U.a.createElement(at.a,{message:"conversations-message-history.responder.unknownResponder"});case G.e:return U.a.createElement(at.a,{message:"conversations-message-history.responder.unknownVisitor"});case G.d:return U.a.createElement(at.a,{message:"conversations-message-history.responder.automatic"});default:return U.a.createElement(at.a,{message:"conversations-message-history.responder.unknownSender"})}}},{key:"render",value:function(){var e=this.props,t=e.sender;return e.isLoading?U.a.createElement(tt,{width:100}):t&&st({givenName:Object(Q.d)(t),familyName:Object(Q.f)(t),email:Object(Q.c)(t)})||this.getUnknownSenderText()}}]);return t}(z.PureComponent);ct.displayName="SenderName";ct.propTypes={isLoading:p.a.bool,sender:Object(m.a)("Sender")};var ut=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isSenderLoading,n=e.sender;return t?U.a.createElement(tt,{width:150}):U.a.createElement(nt.a,{use:"help"},U.a.createElement("strong",null,U.a.createElement(ct,{sender:n})))}}]);return t}(z.PureComponent);ut.displayName="SenderHeaderContent";ut.propTypes={isSenderLoading:p.a.bool,sender:Object(m.a)("Sender")};var lt=ut,dt=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isSenderLoading,n=e.sender;return U.a.createElement(lt,{sender:n,isSenderLoading:t})}}]);return t}(z.PureComponent);dt.displayName="TypingHeaderContent";dt.propTypes={isSenderLoading:p.a.bool,sender:Object(m.a)("Sender")};var pt=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.message,n=e.positionDescriptors,a=e.senders,r=Object(we.getSenderId)(t),i=Object(we.getSenderType)(t),o=Object(we.getSenderType)(t)===G.e,s=ne(r,i,a),c=Object(Q.b)(s),u=re(s),l=o?Y.c:Y.a;return U.a.createElement(Xe,{positionDescriptors:n,use:l},U.a.createElement(Qe,null,U.a.createElement(_e,null,U.a.createElement(X,{sender:c,isLoading:u})),U.a.createElement(Ze,null,U.a.createElement(dt,{message:t,sender:c,isSenderLoading:u}))),U.a.createElement(ze,null,U.a.createElement(Le,null,U.a.createElement(Ee,null))))}}]);return t}(z.PureComponent);pt.displayName="TypingIndicatorMessage";pt.propTypes={message:p.a.oneOfType([Object(m.a)("PubNubMessageRecord"),Object(m.a)("TypingIndicatorMessage")]).isRequired,positionDescriptors:J.a.isRequired,senders:$.a.isRequired};var ht,mt=pt,bt=n("j5Uy"),ft=n("12I0"),gt=n("WaZK"),vt=n("CDTs"),Ot=b.e.div.withConfig({displayName:"DashedLabel__StyledBorder",componentId:"sc-1k0romg-0"})(["display:flex;flex-grow:1;border:solid 1px ",";"],f.i);function jt(e){var t=e.children,n=e.transparent,a=e["data-test-id"],r=e.labelPadding;return U.a.createElement("div",{className:Object(vt.a)("display-flex align-end",r,n&&"justify-center",!r&&"m-y-6"),"data-test-id":a||"dashed-label"},!n&&U.a.createElement(Ot,{className:"m-bottom-3"}),U.a.createElement("div",{className:"max-100 p-x-4"},U.a.createElement(nt.a,{use:"help",className:"m-bottom-1 align-center text-center word-break-break-word flex-column"},t)),!n&&U.a.createElement(Ot,{className:"m-bottom-3"}))}jt.displayName="DashedLabel";jt.propTypes=(ht={children:p.a.node.isRequired},Object(r.a)(ht,"data-test-id",p.a.string),Object(r.a)(ht,"transparent",p.a.bool),ht);var yt=jt,Ct=n("E7sj"),xt=n.n(Ct),Tt=n("eRgl"),kt=n("20rD"),Et=n("zCuc"),wt=n("+IKs"),It=n("wjpu"),Rt=["gmail_extra","gmail_quote","hs_reply","x_hs_reply_wrap"],St="divRplyFwdMsg",At=function(e,t){return t===St||e&&e.contains&&Rt.some(function(t){return e.contains(t)})},Mt=function(e){var t=e.node,n=t.classList,a=t.id,r=t.attributes,i=void 0===r?[]:r;if(At(n,a)){var o=Bt.createElement("span");Object.keys(i).forEach(function(e){var t=i[e];o.setAttribute(t.nodeName,t.nodeValue)});o.innerHTML="";o.setAttribute("data-email-reply","");return{node:o}}return null},Pt=["hs_signature"],Nt=function(e){return e&&e.contains&&Pt.some(function(t){return e.contains(t)})},qt=function(e){var t=e.node,n=t.classList,a=t.attributes,r=void 0===a?[]:a;if(Nt(n)){var i=Bt.createElement("span");Object.keys(r).forEach(function(e){var t=r[e];i.setAttribute(t.nodeName,t.nodeValue)});i.innerHTML="";i.setAttribute("data-email-signature","");return{node:i}}return null},_t=["position","top","bottom","left","right","z-index","clear","float","background-image","white-space"],Ft=function(e){var t=e.node;if(t&&t.style&&t.style.length>0&&t.style.removeProperty){_t.forEach(function(e){return t.style.removeProperty(e)});return{node:t}}return null},Dt=function(e){var t=e.node,n=e.node_name;if(t&&"img"===n&&t.attributes){t.attributes["data-original-height"]&&t.setAttribute("height",t.attributes["data-original-height"].value);t.attributes["data-original-width"]&&t.setAttribute("width",t.attributes["data-original-width"].value);t.attributes["data-full-size-src"]&&t.setAttribute("src",t.attributes["data-full-size-src"].value);return{node:t}}return null},Lt=function(e){var t=e.node;if("div"===e.node_name&&t&&t.classList&&t.classList.contains("gmail_default")){var n=Bt.createElement("span");Object.keys(t.attributes).forEach(function(e){var a=t.attributes[e];n.setAttribute(a.nodeName,a.nodeValue)});n.innerHTML=t.innerHTML.trim();return{node:n}}return null},Bt=document.implementation.createHTMLDocument(""),zt={transformers:[Wt,Mt,qt,Ft,Lt,Dt],dom:Bt,elements:["b","blockquote","br","caption","cite","code","col","colgroup","dd","dl","dt","em","figure","h1","h2","h3","h4","h5","h6","i","img","li","ol","p","pre","q","small","strike","strong","sub","sup","table","tbody","td","tfoot","th","thead","tr","u","ul","font","div","span","a"],attributes:{__ALL__:["style","align","valign","width","height"],blockquote:["cite"],col:["span"],colgroup:["span"],figure:["style"],ol:["start","type"],q:["cite"],img:["title","alt","src"],table:["summary","bgcolor"],td:["abbr","axis","colspan","rowspan","bgcolor"],th:["abbr","axis","colspan","rowspan","scope","bgcolor"],ul:["type"],font:["size"],a:["href","title"],span:["data-at-mention","data-owner-id","contenteditable","data-email-reply"]},add_attributes:{a:{target:"_blank"}},remove_contents:["script"],protocols:{a:{href:["http","https"]}}},Ut=function(e,t){return"p"===t&&e&&e.classList&&e.classList.contains("MsoNormal")&&e.children&&e.children.length},Ht=function(e){return e&&!e.children.legnth&&"o:p"===e.tagName.toLowerCase()&&e.innerHTML.includes("&nbsp;")},Vt=function(e){return e&&"span"===e.tagName.toLowerCase()&&Ht(e.firstElementChild)},Qt=function(e){return!!e.getElementsByTagName("img").length},Wt=function e(t){var n=t.node,a=t.node_name;if(Ut(n,a)){var r=n.firstElementChild;if(Ht(r)||Vt(r)){if(Qt(n)){n.removeChild(r);return e({node:n,node_name:"p"})}return{node:Bt.createElement("br")}}var i=Bt.createElement("div");Object.keys(n.attributes).forEach(function(e){var t=n.attributes[e];i.setAttribute(t.nodeName,t.nodeValue)});i.innerHTML=n.innerHTML.trim().replace(/&nbsp;/g,"");return{node:i}}return null},Zt=n("JuOs"),Gt=n.n(Zt),Kt=function(e){return new Gt.a(e)},Xt=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return Object.assign.apply(Object,[new Error].concat(n,[{message:e}]))},Yt=function(e){setTimeout(function(){throw e},0)},Jt=function(e){Array.from(e.querySelectorAll("br + [data-email-reply]")).forEach(function(e){var t=e.previousElementSibling;t&&t.nodeName&&"br"===t.nodeName.toLowerCase()&&t.classList&&t.classList.add("display-none")})},$t=Bt.body,en=Object(ee.a)(function(e,t){var n=Bt.createElement("div");try{$t.innerHTML=e;var a=Object.assign({},zt);a.transformers=t;var r=Kt(a).clean_node($t).cloneNode(!0);n.appendChild(r);Jt(n)}catch(e){var i=Xt("Error sanitizing email message: "+e.message,e);Yt(i)}return n.innerHTML}),tn=Object(ee.a)(function(e){return en(e,[Wt,Lt,Ft,Dt])}),nn=Object(ee.a)(function(e){if(!e)return null;var t=document.createElement("div");t.innerHTML=tn(e);document.body.appendChild(t);var n=t.innerText;document.body.removeChild(t);return n}),an=n("FHdS"),rn=[wt.a,kt.a,Et.a,It.a],on=Object(ee.a)(function(e){setTimeout(function(){Object(Ae.a)(rn.some(function(t){return e instanceof t}),"hasTextContent: Unsupported message record type %s supplied",Object(Tt.a)(e))},0);var t=Object(an.f)(e),n=Object(we.getRichText)(e)||Object(we.getPlainText)(e);return t||Boolean(n&&n.length&&nn(n))}),sn=n("NiVr"),cn=b.e.div.withConfig({displayName:"ContentText__ContentTextWrapper",componentId:"sc-18nutdh-0"})(["word-wrap:break-word;box-sizing:border-box;width:100%;white-space:pre-wrap;a{font-weight:inherit;text-decoration:underline;}"]),un=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e["aria-label"],n=e.contentText,a=e.onClickAction;return U.a.createElement(cn,null,U.a.createElement("div",{"aria-label":t,"data-test-id":"primary-message-content",dangerouslySetInnerHTML:{__html:Object(sn.a)(n,{shouldPreserveNewlines:!0})},onClick:a}))}}]);return t}(z.PureComponent);un.displayName="ContentText";un.propTypes={"aria-label":p.a.string,contentText:p.a.string.isRequired,onClickAction:p.a.func};un.defaultProps={onClickAction:function(){}};var ln=n("xq+X"),dn=function(e){return Object(ln.a)(["metadata","officeHoursStartTime"],e)},pn=function(e){return Object(ln.a)(["officeHoursStartTime"],e)},hn=function(e){return e["@type"]===ft.q?pn(e)&&pn(e)-(new Date).getTime()<0:dn(e)&&dn(e)-(new Date).getTime()<0},mn=function(e){var t=e.message;return t["@type"]===ft.q||on(t)?hn(t)?null:U.a.createElement(yt,{transparent:!0,labelPadding:"m-y-1"},U.a.createElement(un,{"aria-label":xt.a.text("conversations-visitor-message-history.systemMessage"),contentText:Object(we.getRichText)(t)||Object(we.getPlainText)(t)})):null};mn.displayName="AvailabilityMessage";mn.propTypes={message:p.a.oneOfType([Object(m.a)("PubNubMessageRecord"),Object(m.a)("TypicalResponseTimeMessage"),Object(m.a)("OfficeHoursMessage")]).isRequired};var bn=mn,fn=["id"],gn=["timestamp"],vn=(Object(ln.a)(fn),Object(ln.a)(gn)),On={MY:"i18n.dateTime.monthAndYear",MD:"i18n.dateTime.monthAndDay",QY:"i18n.dateTime.quarterAndYear",WMDY:"i18n.dateTime.weekDayAndMonthAndDayAndYear"},jn=function(e){var t=e.value,n=e.type,a=e.format,r=e.length,i=n?xt.a.moment[n](t):t,o="",s="",c="";if("s"===r){var u=Object.keys(xt.a.translations.en.i18n.dateTime.shortForm.months)[i.month()];o=xt.a.text("i18n.dateTime.shortForm.months."+u,{locale:xt.a.locale});s=i.format("ddd");c=i.format("ll")}else{o=i.format("MMMM");s=i.format("dddd");c=i.format("LL")}var l={monthName:o,locale:xt.a.locale};switch(a){case"MD":l.dayNumber=i.date();break;case"QY":l.quarterNumber=i.quarter();l.yearNumber=i.year().toString();break;case"WMDY":l.weekDay=s;l.fullDate=c;break;default:l.yearNumber=i.year().toString()}return xt.a.text(On[a],l)},yn=function(e,t){return jn({value:e,type:t,format:"MD",length:"m"})},Cn=Object(z.memo)(function(e){var t=e.message,n=e.labelPadding,a=vn(t),r=yn(a,"userTz");return U.a.createElement(yt,{labelPadding:n},U.a.createElement(nt.a,{use:"help"},r))});Cn.displayName="DateLabelMessage";Cn.propTypes={labelPadding:p.a.string,message:Object(m.a)("DateMessage").isRequired};var xn=Cn,Tn=b.e.div.withConfig({displayName:"DateLabel__StyleWrapper",componentId:"sc-1czoaa2-0"})(["","{border-color:",";}"],Ot,f.f),kn=function(e){return U.a.createElement(Tn,null,U.a.createElement(xn,Object.assign({},e,{labelPadding:"m-y-3"})))};kn.displayName="DateLabel";kn.propTypes=xn.propTypes;var En=kn,wn=n("ZI8J"),In=n("fWsJ"),Rn=n("aiou"),Sn=n("6+o1"),An=function(){return U.a.createElement("i",null,U.a.createElement(at.a,{message:"conversations-message-history.noContent"}))};An.displayName="NoContentLabel";var Mn=An,Pn=n("nU4D"),Nn=["fileId"],qn=["fileMetadata"],_n=["thumbnailMetadata"],Fn=(Object(ln.a)(Nn),Object(ln.a)(qn)),Dn=(Object(ln.a)(_n),["expiresAt"]),Ln=["url"],Bn=["name"],zn=["extension"],Un=["type"],Hn=["fileSize"],Vn=["width"],Qn=["height"],Wn=(Object(ln.a)(Dn),Object(ln.a)(Ln)),Zn=Object(ln.a)(Bn),Gn=Object(ln.a)(zn),Kn=Object(ln.a)(Un),Xn=Object(ln.a)(Hn),Yn=Object(ln.a)(Vn),Jn=Object(ln.a)(Qn),$n=function(e){var t=Zn(e),n=Gn(e);return n?t+"."+n:t},ea=n("1an1"),ta=n("oT5E"),na=b.e.div.withConfig({displayName:"InlineImageAttachment__InlineImageAttachmentWrapper",componentId:"sc-1md8p9e-0"})(["display:block;max-width:100%;"]),aa=function(e){Object(l.a)(t,e);function t(e){var n;Object(o.a)(this,t);(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).hasLoadedImage=function(){n.setState({hasLoaded:!0})};n.state={hasLoaded:!1};return n}Object(s.a)(t,[{key:"getDimensions",value:function(){var e=this.props,t=e.maxWidth,n=e.width,a=e.height;return!this.state.hasLoaded&&t&&n&&a?n<=t?{width:n,height:a}:{width:t,height:a*(t/n)}:{}}},{key:"render",value:function(){var e=this.props,t=e.name,n=e.url,a=this.getDimensions(),r=a.width,i=a.height;return U.a.createElement(na,null,U.a.createElement(ta.a,{href:n,target:"_blank","data-test-id":"inline-image-attachment"},U.a.createElement(ea.a,{alt:t,src:n,width:r,height:i,style:{minHeight:i},onLoad:this.hasLoadedImage})))}}]);return t}(z.PureComponent);aa.displayName="InlineImageAttachment";aa.propTypes={height:p.a.number,maxWidth:p.a.number,name:p.a.string.isRequired,url:p.a.string.isRequired,width:p.a.number};var ra=aa,ia="IMG",oa=function(e){return e.filter(function(e){var t=Fn(e),n=Kn(t),a=Gn(t);return Boolean(n===ia&&"svg"!==a)})},sa=function(e){return e.filter(function(e){var t=Fn(e),n=Kn(t),a=Gn(t);return Boolean(n!==ia||"svg"===a)})},ca=function(e){return e.some(function(e){var t=Fn(e),n=Kn(t),a=Gn(t);return Boolean(n===ia&&"svg"!==a)})},ua=300,la=b.e.div.withConfig({displayName:"InlineImageAttachments__FileAttachmentsWrapper",componentId:"sc-1llh32t-0"})(["cursor:pointer;box-sizing:border-box;width:100%;max-width:","px;display:block;margin-bottom:16px;margin-top:8px;"],ua),da=function(e){Object(l.a)(t,e);function t(e){var n;Object(o.a)(this,t);(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={maxWidth:ua};n.wrapperRef=Object(z.createRef)();return n}Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=Object(Pn.findDOMNode)(this.wrapperRef.current);e&&e.offsetWidth&&e.offsetWidth!==this.state.maxWidth&&this.setState({maxWidth:e.offsetWidth})}},{key:"render",value:function(){var e=this,t=this.props.fileAttachments;return U.a.createElement(la,{ref:this.wrapperRef},oa(t).map(function(t,n){var a=Fn(t),r=$n(a),i=Wn(a),o=Yn(a),s=Jn(a);return U.a.createElement(ra,{key:"image-"+n,name:r,url:i,width:o,height:s,maxWidth:e.state.maxWidth})}))}}]);return t}(z.PureComponent);da.displayName="InlineImageAttachments";da.propTypes={fileAttachments:p.a.instanceOf(Sn.List)};var pa=da,ha=n("jPg9"),ma=n("QhGC"),ba=n("KMkU"),fa=Object(z.createContext)(Object(ba.a)()),ga=n("y+ws"),va=n("SxW6"),Oa=function(e){return U.a.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 20 24"},e),U.a.createElement("defs",null,U.a.createElement("path",{d:"M14.466 0c.076 0 .153.008.233.023.1.02.196.059.288.104.023.011.046.023.068.037.09.052.177.111.252.187l6.345 6.4c.075.076.135.163.186.255.013.023.025.045.036.068.045.093.083.19.103.295.015.075.023.153.023.231v13.2c0 1.884-1.468 3.2-3.569 3.2H6.534c-2.1 0-3.568-1.316-3.568-3.2V3.6c0-1.985 1.6-3.6 3.568-3.6zm-1.133 2H6.25C5.56 2 5 2.56 5 3.25v17.917c0 .689.68.833 1.25.833h12.5c.57 0 1.25-.144 1.25-.833v-12.5h-4.583c-1.149 0-2.084-.935-2.084-2.084V2z",id:"file__a"})),U.a.createElement("use",{xlinkHref:"#file__a"}))};Oa.displayName="SVGFile";var ja=Oa,ya=b.e.div.withConfig({displayName:"FileAttachmentTile__FileAttachmentTileWrapper",componentId:"nhs20w-0"})(["max-width:300px;"]),Ca=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"render",value:function(){var e=this.props.fileMetadata,t=$n(e),n=Wn(e),a=Xn(e);return U.a.createElement(ya,null,U.a.createElement(ga.a,{onClick:function(){return window.open(n)},fileName:t,fileInfo:U.a.createElement(ma.a,{value:a}),preview:U.a.createElement(va.a,{icon:U.a.createElement(ja,null),size:"sm"})}))}}]);return t}(z.PureComponent);Ca.contextType=fa;Ca.displayName="FileAttachmentTile";Ca.propTypes={fileMetadata:Object(m.a)("FileMetadataRecord").isRequired};var xa=Ca,Ta=Object(ue.a)("tileBackgroundColor"),ka=b.e.div.withConfig({displayName:"AttachmentsFooter__AttachmentsFooterWrapper",componentId:"dg8jzy-0"})(["cursor:pointer;box-sizing:border-box;display:block;background-color:",";"],function(e){return e.backgroundColor}),Ea=Object(b.e)(xa).withConfig({displayName:"AttachmentsFooter__StyledFileAttachmentTile",componentId:"dg8jzy-1"})(["background-color:",";"],function(e){return e.backgroundColor||"rgba(255, 255, 255, 0.5)"}),wa=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.fileAttachments;return U.a.createElement(ka,{backgroundColor:pe(this.context)},t.map(function(t,n){return U.a.createElement(Ea,{key:n,fileMetadata:Fn(t),backgroundColor:Ta(ge(e.context))})}))}}]);return t}(z.PureComponent);wa.contextType=je;wa.displayName="AttachmentsFooter";wa.propTypes={fileAttachments:p.a.instanceOf(Sn.List).isRequired};var Ia=wa,Ra=/^rgb/i,Sa=function(e){var t,n,a;try{if(Ra.test(e)){var r=e.match(/(\d+)\D+(\d+)\D+(\d+)/);t=parseInt(r[1],10);n=parseInt(r[2],10);a=parseInt(r[3],10)}else{var i=e.toLowerCase().replace(/^#/,"");3===i.length&&(i=i.replace(/([0-9a-f])/g,"$1$1"));t=parseInt(i.substring(0,2),16);n=parseInt(i.substring(2,4),16);a=parseInt(i.substring(4,6),16)}if([t,n,a].some(isNaN))return{}}catch(e){return{}}return{r:t,g:n,b:a}},Aa=function(e){var t=Sa(e),n=t.r,a=t.g,r=t.b;if([n,a,r].some(isNaN))return{hue:0,saturation:0,lightness:0};var i,o=n/255,s=a/255,c=r/255,u=Math.max(o,s,c),l=Math.min(o,s,c),d=(u+l)/2,p=u-l;if(0===p)return{hue:0,saturation:0,lightness:d};var h=d>.5?p/(2-u-l):p/(u+l);switch(u){case o:i=(s-c)/p+(s<c?6:0);break;case s:i=(c-o)/p+2;break;default:i=(o-s)/p+4}i*=60;return{hue:i=Math.round(i),saturation:h,lightness:d}},Ma=function(e){var t=e<0?0:e>1?1:e;return Math.round(100*t)+"%"},Pa=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,n=Aa(e),a=n.hue,r=n.saturation,i=n.lightness;return"hsl("+[a,Ma(r),Ma(i+t)].join(", ")+")"},Na=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return Pa(e,-t)},qa=n("y+AS"),_a=n.n(qa),Fa=b.e.div.withConfig({displayName:"CommonMessageContent__HyperlinkStyleWrapper",componentId:"sc-6v1j3m-0"})([""," a{color:",";&:hover{color:",";}&:active{color:",";}}"],Be,function(e){return e.hyperlinkColor},function(e){var t=e.hyperlinkColor;return t&&Na(t)},function(e){var t=e.hyperlinkColor;return t&&Na(t,.2)}),Da=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"isSentFromVisitor",value:function(){return Object(we.getSenderType)(this.props.message)===G.e}},{key:"isClickableLink",value:function(e){return new RegExp("([a-zA-Z0-9]+://)?([a-zA-Z0-9_]+:[a-zA-Z0-9_]+@)?([a-zA-Z0-9.-]+\\.[A-Za-z]{2,4})(:[0-9]+)?(/.*)?").test(e)}},{key:"handleOnClickEvent",value:function(e){e.persist();"A"===e.target.tagName&&this.props.toggleOpen(!1)}},{key:"renderContentText",value:function(){var e=this.props,t=e.message,n=e.mobile,a=Object(we.getRichText)(t)||Object(we.getPlainText)(t),r=n&&this.isClickableLink(a);if(!a)return null;var i=Object(we.getRichText)(t)&&_a.a.link(a,{stripPrefix:!1});return U.a.createElement(un,{contentText:i||a,"aria-label":this.isSentFromVisitor()?xt.a.text("conversations-visitor-message-history.myMessage"):xt.a.text("conversations-visitor-message-history.agentMessage"),onClickAction:r?this.handleOnClickEvent.bind(this):null})}},{key:"renderMessageSection",value:function(){var e=this.props,t=e.fileAttachments,n=e.isLastMessage,a=e.message,r=!Object(ha.b)(a)&&t&&ca(t),i=on(a);return r||i?U.a.createElement(Le,{isLastMessage:n},this.renderContentText(),r&&U.a.createElement(pa,{fileAttachments:t})):null}},{key:"renderAttachmentsSection",value:function(){var e=this.props,t=e.fileAttachments,n=e.message,a=Object(ha.b)(n)?t:sa(t);return a&&a.size?U.a.createElement(Le,null,U.a.createElement(Ia,{fileAttachments:a})):null}},{key:"render",value:function(){var e=this.renderMessageSection(),t=this.renderAttachmentsSection(),n=this.isSentFromVisitor();return U.a.createElement(Fa,{hyperlinkColor:n&&fe(this.context)},U.a.createElement(ze,null,e,t,!e&&!t&&U.a.createElement(Le,null,U.a.createElement(Mn,null)),this.props.quickReplySelect&&this.props.quickReplySelect()))}}]);return t}(z.PureComponent);Da.contextType=je;Da.displayName="CommonMessageContent";Da.propTypes={fileAttachments:p.a.instanceOf(Sn.List),isLastMessage:p.a.bool,message:p.a.oneOfType([Object(m.a)("PubNubMessageRecord"),Object(m.a)("CommonMessage")]).isRequired,mobile:p.a.bool,quickReplySelect:p.a.oneOfType([p.a.bool,p.a.func]),toggleOpen:p.a.func};var La=Da,Ba=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.fileAttachments,n=e.message,a=e.positionDescriptors,r=Object(In.a)(n),i=a.includes(wn.c);return U.a.createElement(Xe,{positionDescriptors:a,use:Y.c},U.a.createElement(La,{fileAttachments:t,isLastMessage:i,message:r}),i&&U.a.createElement(He,null,U.a.createElement(nt.a,{use:"help"},U.a.createElement(Rn.a,{message:"conversations-visitor-message-history.status.publishing.UNPUBLISHED"}))))}}]);return t}(z.PureComponent);Ba.displayName="ActivelyPublishingMessage";Ba.propTypes={fileAttachments:p.a.instanceOf(Sn.List),message:Object(m.a)("ActivelyPublishing").isRequired,positionDescriptors:J.a.isRequired};var za=Ba,Ua=n("BvgU"),Ha=n("g99b"),Va=n("RlAi"),Qa=n("T0Ay"),Wa=n("ylAb"),Za=Object(b.e)(Ha.a).withConfig({displayName:"EmailCaptureInput__StyledVizExButton",componentId:"sc-178sjxh-0"})(["padding:0;width:100% !important;height:100%;"]),Ga=b.e.div.withConfig({displayName:"EmailCaptureInput__LoadingButtonContainer",componentId:"sc-178sjxh-1"})(["width:38px;height:32px;margin:4px 4px 4px 0;"]),Ka={disabled:p.a.bool,locale:p.a.string,onChange:p.a.func.isRequired,onKeyPress:p.a.func.isRequired,onSubmit:p.a.func,submissionState:p.a.oneOf(["ready","submitting","done"]),value:p.a.string},Xa=function(e){var t=e.disabled,n=e.value,a=e.onChange,r=e.onKeyPress,i=e.onSubmit,o=e.locale,s=e.submissionState;return U.a.createElement(Wa.a,{"aria-label":xt.a.text("conversations-visitor-message-history.email-capture.placeholderText",{locale:o}),value:n,placeholder:xt.a.text("conversations-visitor-message-history.email-capture.placeholderText",{locale:o}),"data-test-id":"email-capture-input",onChange:a,onKeyPress:r,suffix:U.a.createElement(Ga,null,U.a.createElement(Va.a,{currentState:s,onClick:i,disabled:t,"aria-label":xt.a.text("conversations-visitor-message-history.email-capture.sendEmail",{locale:o}),"data-test-id":"email-capture-submit-button",Button:Za},U.a.createElement(va.a,{icon:U.a.createElement(Qa.a,{color:f.q})})))})};Xa.displayName="EmailCaptureInput";Xa.propTypes=Ka;var Ya=Xa,Ja=b.e.span.withConfig({displayName:"CaptureSection__ErrorMessage",componentId:"sc-1efxvqx-0"})(["color:",";font-size:12px;line-height:18px;text-align:left;margin-top:9px;display:flex;"],f.e),$a=function(e){var t=e.message,n=e.email,a=e.errorMessage,r=e.onChange,i=e.onKeyPress,o=e.onSubmit,s=e.submissionState;return U.a.createElement(Le,{key:"email-prompt-capture-section"},U.a.createElement(un,{"aria-label":xt.a.text("conversations-visitor-message-history.agentMessage"),contentText:Object(we.getPlainText)(t)}),U.a.createElement(Ya,{disabled:!n,value:n,onChange:r,onKeyPress:i,onSubmit:o,submissionState:s}),U.a.createElement(Ja,{"aria-live":"assertive"},a))};$a.displayName="CaptureSection";$a.propTypes={email:p.a.string,errorMessage:p.a.string,message:Object(m.a)("PubNubMessageRecord").isRequired,onChange:p.a.func.isRequired,onKeyPress:p.a.func.isRequired,onSubmit:p.a.func.isRequired,submissionState:p.a.string.isRequired};var er=n("ZVA3"),tr=n("10Vg"),nr=tr.a,ar=tr.f,rr=tr.h,ir=n("57xV"),or=function(e){var t=e.theme;return Object(b.d)(["box-shadow:0 0 0 1px ",";"],Object(ir.a)(rr(t),40))},sr=function(e){var t=e.checked,n=e.theme;return Object(b.d)(["background-color:",";color:",";"],nr(n),!t&&Object(ir.a)(rr(n),40))},cr=b.e.div.withConfig({displayName:"VizExCheckbox__CheckboxBox",componentId:"sc-1so4h75-0"})(["flex-shrink:0;height:16px;width:16px;transition:color 0.15s ease-out,background-color 0.15s ease-out;color:",";border-color:currentColor;border:2px solid;border-radius:3px;position:relative;",";",";"],function(e){var t=e.checked,n=e.theme;return t?rr(n):ar(n)},function(e){var t=e.hover,n=e.theme,a=e.checked;return t&&sr({theme:n,checked:a})},function(e){var t=e.focus,n=e.theme;return t&&or({theme:n})}),ur=b.e.label.withConfig({displayName:"VizExCheckbox__CheckboxWrapper",componentId:"sc-1so4h75-1"})(["position:relative;display:inline-flex;flex-direction:row;align-items:center;font-size:16px;cursor:pointer;:hover ","{","}input:focus + ","{","}"],cr,sr,cr,or),lr=b.e.input.withConfig({displayName:"VizExCheckbox__CheckboxInput",componentId:"sc-1so4h75-2"})(["position:absolute;top:0;width:1px;height:1px;margin:-1px;padding:0;overflow:hidden;clip:rect(0,0,0,0);border:0;"]),dr=b.e.svg.withConfig({displayName:"VizExCheckbox__Indicator",componentId:"sc-1so4h75-3"})(["height:100%;width:100%;top:0;left:0;position:absolute;pointer-events:none;"]),pr=b.e.div.withConfig({displayName:"VizExCheckbox__ContentWrapper",componentId:"sc-1so4h75-4"})(["padding-left:8px;user-select:none;cursor:pointer;"]),hr=function(e){var t=e.onChange,n=e.theme,a=e.children,r=e.checked,i=e.focus,o=e.hover,s=Object(Ye.a)(e,["onChange","theme","children","checked","focus","hover"]),c=Object(z.useRef)(null);return U.a.createElement(ur,Object.assign({},s,{onClick:function(){c.current.focus()},"data-testid":"VizExCheckbox",checked:r,theme:n}),U.a.createElement(lr,{ref:c,"data-testid":"VizExCheckbox-input",type:"checkbox",onChange:t}),U.a.createElement(cr,{theme:n,checked:r,focus:i,hover:o},r&&U.a.createElement(dr,{viewBox:"0 0 15 15.343"},U.a.createElement("path",{d:"M1.013 8.11c0-.223.078-.412.234-.568l1.14-1.14c.155-.155.345-.233.568-.233s.413.077.57.233l2.46 2.47 5.492-5.5c.156-.156.346-.234.568-.234.224 0 .413.077.57.233l1.138 1.14c.156.155.234.345.234.568 0 .224-.078.414-.234.57l-6.06 6.06-1.14 1.14c-.155.155-.345.233-.568.233s-.413-.078-.57-.234l-1.138-1.14-3.03-3.03c-.156-.156-.234-.346-.234-.57z",fill:"currentColor"}))),a&&U.a.createElement(pr,null,a))};hr.displayName="VizExCheckbox";hr.propTypes={checked:p.a.bool,children:p.a.node,focus:p.a.bool,hover:p.a.bool,onChange:p.a.func,theme:er.a};var mr=hr,br=b.e.div.withConfig({displayName:"ConsentToCommunicate__BreakString",componentId:"sc-2s4xla-0"})(["-ms-word-break:break-all;display:block;word-break:break-word;word-wrap:break-word;"]),fr=Object(b.e)(nt.a).withConfig({displayName:"ConsentToCommunicate__SmallNoParagraphPadding",componentId:"sc-2s4xla-1"})(["p{margin-bottom:0;}"]),gr=function(e){var t=e.message,n=e.companyName,a=e.consentToCommunicate,r=e.onChange,i=Object(sn.a)(t)||xt.a.text("conversations-visitor-message-history.email-capture.consentToCommunicate",{accountName:n});return U.a.createElement(mr,{checked:a,onChange:r},U.a.createElement(fr,{use:"help"},U.a.createElement(br,null,U.a.createElement("span",{dangerouslySetInnerHTML:{__html:i}}))))};gr.displayName="ConsentToCommunicate";gr.propTypes={companyName:p.a.string,consentToCommunicate:p.a.bool.isRequired,message:p.a.string.isRequired,onChange:p.a.func.isRequired};var vr=gr,Or=/\s|@.{0,}@/,jr=function(e){Object(l.a)(t,e);function t(e){var n;Object(o.a)(this,t);(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).onConsentChange=function(){n.setState({hasConsentedToCommunicate:!n.state.hasConsentedToCommunicate})};n.state={email:"",emailError:!1,hasConsentedToCommunicate:!1,submitFailure:!1,submissionState:"ready"};n.handleChange=n.handleChange.bind(Object(h.a)(n));n.handleKeyPress=n.handleKeyPress.bind(Object(h.a)(n));n.handleSubmit=n.handleSubmit.bind(Object(h.a)(n));return n}Object(s.a)(t,[{key:"handleChange",value:function(e){this.setState({email:e.target.value,emailError:!1,submitFailure:!1,submissionState:"ready"})}},{key:"handleKeyPress",value:function(e){var t=13;e.which===t&&this.handleSubmit()}},{key:"handleSubmit",value:function(){var e=this,t=this.props,n=t.sendVisitorEmailAddress,a=t.threadId,r=this.state,i=r.email,o=r.hasConsentedToCommunicate,s=i.trim();Ua.a.test(s)&&!s.match(Or)?this.setState({submissionState:"submitting"},function(){n({email:s,consentToCommunicate:o,threadId:a}).then(function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).error;e.setState({submitFailure:Boolean(t),submissionState:"done"})}).done()}):this.setState({emailError:!0,submissionState:"ready"})}},{key:"getValidationMessage",value:function(){switch(!0){case this.state.emailError:return U.a.createElement(Rn.a,{message:"conversations-visitor-message-history.email-capture.invalid"});case this.state.submitFailure:return U.a.createElement(Rn.a,{message:"conversations-visitor-message-history.email-capture.failed"});default:return null}}},{key:"render",value:function(){var e=this.props,t=e.companyName,n=e.consentToCommunicateMessage,a=e.hasVisitorEmail,r=e.message,i=e.positionDescriptors,o=e.requiresConsentToCommunicate,s=this.state,c=s.email,u=s.hasConsentedToCommunicate,l=this.getValidationMessage();return U.a.createElement(Xe,{positionDescriptors:i,use:Y.a},U.a.createElement(ze,null,a?U.a.createElement(Le,null,U.a.createElement(Rn.a,{"data-test-id":"email-capture-success",message:"conversations-visitor-message-history.email-capture.thanks"})):U.a.createElement(U.a.Fragment,null,U.a.createElement($a,{message:r,email:c,errorMessage:l,onChange:this.handleChange,onKeyPress:this.handleKeyPress,onSubmit:this.handleSubmit,submissionState:this.state.submissionState}),o&&U.a.createElement(Le,{key:"email-prompt-content-section"},U.a.createElement(vr,{message:n,companyName:t,consentToCommunicate:u,onChange:this.onConsentChange})))))}}]);return t}(z.PureComponent);jr.displayName="EmailCapturePromptMessage";jr.propTypes={companyName:p.a.string,consentToCommunicateMessage:p.a.string,hasVisitorEmail:p.a.bool.isRequired,message:p.a.oneOfType([Object(m.a)("PubNubMessageRecord"),Object(m.a)("EmailCapturePromptMessage")]).isRequired,positionDescriptors:J.a.isRequired,requiresConsentToCommunicate:p.a.bool,sendVisitorEmailAddress:p.a.func.isRequired,threadId:p.a.number.isRequired};var yr=jr,Cr=n("ibZn"),xr=n("zC+/"),Tr=n("TGEe"),kr=n("ib5I"),Er=n("vIe5"),wr=n("qeXV"),Ir=Object(kr.a)(wr.getLatestWidgetData,function(e){return Object(Er.c)(e)}),Rr=Object(kr.a)(wr.getLatestWidgetData,Object(ue.a)("companyName")),Sr=n("GfCx"),Ar=n("O3Qn"),Mr=n("V/zO"),Pr=function(e){return{coloring:Object(xr.a)(e),companyName:Rr(e),consentToCommunicateMessage:Ir(e),hasVisitorEmail:Object(Sr.a)(e),requiresConsentToCommunicate:Object(Tr.a)(e),threadId:Object(Mr.getCurrentThreadId)(e)}},Nr={sendVisitorEmailAddress:Ar.sendVisitorEmailAddress},qr=Object(Cr.b)(Pr,Nr)(yr),_r=function(e){return U.a.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 28 25"},e),U.a.createElement("path",{d:"M12 7.663c-.042-.286.044-.577.234-.796.192-.218.469-.344.76-.344h2.011c.292 0 .57.126.76.344.192.22.277.51.236.796l-1.006 6.992c-.07.492-.494.857-.995.857-.5 0-.925-.365-.995-.857l-1.006-6.992zm2 13.841c-1.11 0-2.01-.894-2.01-1.997 0-1.103.9-1.998 2.01-1.998 1.111 0 2.01.895 2.01 1.998s-.899 1.997-2.01 1.997zm3.001-19.783C16.375.643 15.253 0 14 0s-2.374.643-3 1.72L.47 19.838c-.627 1.078-.627 2.365 0 3.442C1.096 24.357 2.217 25 3.47 25H24.53c1.253 0 2.374-.643 3-1.72.627-1.078.627-2.365 0-3.443L17.001 1.721z",fillRule:"evenodd"}))};_r.displayName="SVGWarning";var Fr=_r,Dr=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.fileAttachments,n=e.message,a=e.onRepublish,r=e.positionDescriptors,i=Object(In.a)(n);return U.a.createElement(Xe,{positionDescriptors:r,use:Y.c},U.a.createElement(La,{fileAttachments:t,isLastMessage:!0,message:i}),U.a.createElement(He,null,U.a.createElement(nt.a,{use:"error"},U.a.createElement(va.a,{icon:U.a.createElement(Fr,null),className:"m-right-1"}),U.a.createElement(ta.a,{onClick:function(){return a(i)},use:"error"},U.a.createElement(Rn.a,{message:"conversations-visitor-message-history.status.publishing.PUBLISH_FAILED"})))))}}]);return t}(z.PureComponent);Dr.displayName="FailedToPublishMessage";Dr.propTypes={fileAttachments:p.a.instanceOf(Sn.List),message:Object(m.a)("FailedToPublish").isRequired,onRepublish:p.a.func.isRequired,positionDescriptors:J.a.isRequired};var Lr=Dr,Br={onRepublish:n("AnBI").a},zr=Object(Cr.b)(null,Br)(Lr),Ur=n("FeYA");function Hr(e){return"string"==typeof e}function Vr(e){return Hr(e)?e:e.has("label")?e.get("label"):e.get("value")}function Qr(e){return Hr(e)?e:e.get("value")}var Wr=n("pfqe"),Zr=n("RK3k"),Gr=n("DM3q"),Kr=function(e){return U.a.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 32 32"},e),U.a.createElement("path",{d:"M29.92 2.58L11.33 21.17l-9.25-9.25c-.362-.362-.862-.586-1.415-.586-1.105 0-2.001.896-2.001 2.001 0 .553.224 1.053.586 1.415L9.92 25.41c.362.362.862.587 1.415.587s1.053-.224 1.415-.587l20-20c.362-.362.586-.862.586-1.415 0-1.105-.896-2.001-2.001-2.001-.553 0-1.053.224-1.415.586z"}))};Kr.displayName="SVGSuccess";var Xr=Kr,Yr=b.e.div.withConfig({displayName:"QuickReplyGroup__ButtonWrapper",componentId:"sc-12914tr-0"})(["margin-bottom:12px;> *{margin-right:8px;margin-bottom:8px;}> *:last-child{margin-right:0;}padding:8px;display:inline-block;"]),Jr=Object(b.e)(Ha.a).withConfig({displayName:"QuickReplyGroup__LeftAlignButton",componentId:"sc-12914tr-1"})(["text-align:left;"]),$r=function(e){Object(l.a)(t,e);function t(e){var n;Object(o.a)(this,t);(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleSendMulti=n.handleSendMulti.bind(Object(h.a)(n));n.handleQuickReplySend=n.handleQuickReplySend.bind(Object(h.a)(n));n.handleSendIndividual=n.handleSendIndividual.bind(Object(h.a)(n));n.handleSelect=n.handleSelect.bind(Object(h.a)(n));n.state={selected:Object(Sn.Set)()};return n}Object(s.a)(t,[{key:"hasSelected",value:function(){return this.state.selected.size>0}},{key:"handleSelect",value:function(e){this.setState(function(t){var n=t.selected;return{selected:n.includes(e)?n.delete(e):n.add(e)}})}},{key:"handleSendMulti",value:function(){var e=this.props.multiSelect,t=this.state.selected;if(e&&this.hasSelected()){var n=t.map(Vr).join(", ");this.handleQuickReplySend(n,t)}}},{key:"handleSendIndividual",value:function(e){if(!this.props.multiSelect){var t=Object(Sn.List)([e]),n=Vr(e);this.handleQuickReplySend(n,t)}}},{key:"handleQuickReplySend",value:function(e,t){var n=this.props,a=n.message;(0,n.publishMessage)({text:e,quickReply:Object(Wr.a)(a).set("quickReplies",t.toJS())})}},{key:"renderOptions",value:function(){var e=this.props,t=e.options,n=e.multiSelect,a=e.disabled,r=this.state.selected,i=n?this.handleSelect:this.handleSendIndividual;return t.map(function(e){var t=function(){return i(e)},o=r.includes(e),s=Qr(e),c=Vr(e);if(!s||!c)return null;var u=n&&U.a.createElement(mr,{className:"m-right-2",checked:o,onChange:t},c);return U.a.createElement(Jr,{key:"quickreply."+s,onClick:t,disabled:a,size:"sm"},u||c)})}},{key:"renderSendButton",value:function(){var e=this.props,t=e.disabled;if(!e.multiSelect)return null;var n=!this.hasSelected()||t;return U.a.createElement(Gr.a,{disabled:n,onClick:this.handleSendMulti,key:"send-button",size:"sm"},U.a.createElement(va.a,{icon:U.a.createElement(Xr,null),size:"sm"}))}},{key:"render",value:function(){return U.a.createElement(Yr,{"data-test-id":"quick-reply-group"},[].concat(Object(Zr.a)(this.renderOptions()),[this.renderSendButton()]))}}]);return t}(U.a.Component);$r.contextType=je;$r.defaultProps={multiSelect:!1,hasSentReply:!1};$r.displayName="QuickReplyGroup";$r.propTypes={disabled:p.a.bool.isRequired,message:p.a.oneOfType([Object(m.a)("CommonMessage"),Object(m.a)("PubNubMessageRecord"),Object(m.a)("InitialMessage")]).isRequired,multiSelect:p.a.bool.isRequired,options:p.a.instanceOf(Sn.Set).isRequired,publishMessage:p.a.func};var ei=$r,ti=7,ni=(n("XMjd"),tr.f),ai=tr.e,ri=(tr.a,tr.b,tr.g,tr.f,tr.h,tr.h),ii=(tr.h,"__PLACEHOLDER_VALUE__"),oi=b.e.select.withConfig({displayName:"VizExMobileSelect__StyledSelect",componentId:"y7f1s9-0"})(["appearance:none;background:none;border-radius:3px;border:1px solid transparent;color:inherit;cursor:inherit;font-size:16px;margin:0;outline:none;padding:8px 32px 10px 10px;width:100%;height:40px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;&::-ms-expand{display:none;}:focus::-ms-value{color:",";background:transparent;}"],function(e){var t=e.theme;return Object(tr.i)(t)}),si=b.e.div.withConfig({displayName:"VizExMobileSelect__SelectContainer",componentId:"y7f1s9-1"})(["background-color:",";border-radius:3px;border:1px solid ",";cursor:pointer;display:block;font-size:16px;height:40px;line-height:22px;padding:0;position:relative;text-align:left;transition:all 0.15s ease-out;width:100%;&::after{border-color:transparent;border-style:solid;border-width:0.375em;display:inline-block;vertical-align:middle;border-top-color:",";margin-top:0.375em;margin-top:-3px;content:' ';position:absolute;top:50%;right:1em;z-index:2;pointer-events:none;}"],function(e){var t=e.theme;return ai(t)},function(e){var t=e.theme;return ni(t)},function(e){var t=e.theme;return ri(t)}),ci=function(e){var t=e.options,n=e.disabled,a=e.value,r=e.onChange,i=e.placeholder,o=e.theme,s=Object(Ye.a)(e,["options","disabled","value","onChange","placeholder","theme"]),c=t.map(function(e){var t=e.value,n=e.text;return U.a.createElement("option",{value:t,key:t},n)});return U.a.createElement(si,{theme:o},U.a.createElement(oi,Object.assign({},s,{"data-testid":"VizExSelect",disabled:n,defaultValue:ii,value:a,onChange:r,theme:o}),i&&U.a.createElement("option",{disabled:!0,value:ii},i),c))};ci.displayName="VizExMobileSelect";ci.propTypes={disabled:p.a.bool,onChange:p.a.func.isRequired,options:p.a.arrayOf(p.a.shape({text:p.a.string,value:p.a.string})).isRequired,placeholder:p.a.string,theme:er.a,value:p.a.string};var ui=ci,li="__PLACEHOLDER_VALUE__",di=function(e){var t=e.quickReplyOptions,n=e.onChange,a=e.disabled,r=e.value,i=e.placeholder,o=Object(z.useMemo)(function(){return t.map(function(e){var t=Qr(e);return{text:Vr(e),value:t}}).toJS()},[t]);return U.a.createElement(ui,{options:o,onChange:n,disabled:a,defaultValue:li,value:r,placeholder:i})};di.displayName="QuickReplySelect";di.propTypes={disabled:p.a.bool,onChange:p.a.func.isRequired,placeholder:p.a.string,quickReplyOptions:p.a.instanceOf(Sn.OrderedSet).isRequired,value:p.a.string};var pi=di,hi=n("1TtD"),mi=n("dbfG"),bi=n("va1P"),fi=n("A3tK"),gi=n("gXf6"),vi=Object(ee.a)(function(e){var t=e.companyLogo,n=e.customChatName;return new gi.a({avatar:t,firstName:n,senderType:G.a})}),Oi=n("Txxr"),ji=n("nRUj"),yi=Object(ee.a)(function(e,t,n){var a=Object(Oi.agentTypeToSenderType)(Object(ji.getAgentType)(e)||n);return new gi.a({id:Object(ji.getUserId)(e)||t,avatar:Object(ji.getAvatar)(e),firstName:Object(ji.getFirstName)(e),email:Object(ji.getEmail)(e),lastName:Object(ji.getLastName)(e),senderType:a})}),Ci=b.e.div.withConfig({displayName:"InitialMessageAvatar__MultiAvatarWrapper",componentId:"d1ygmg-0"})(["width:100%;height:100%;display:flex;justify-content:center;flex-wrap:wrap;margin-right:4px;margin-left:-4px;& > *{flex:1;line-height:1;position:relative;& > *{position:absolute;left:0;bottom:-8px;}div{background-color:white;}}"]),xi=function(e){Object(l.a)(t,e);function t(){Object(o.a)(this,t);return Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}Object(s.a)(t,[{key:"getSenderAvatars",value:function(){var e=this.props,t=e.chatHeadingConfig,n=e.sender,a=e.sendFromResponders;if(Object(bi.isFromBot)(n))return Object(Sn.List)([n]);if(a.size)return Object(fi.a)(yi,a);var r=Object(hi.a)(t);return r?Object(Sn.List)([vi({companyLogo:r,customChatName:Object(mi.a)(t)})]):Object(Sn.List)()}},{key:"renderAvatars",value:function(){var e=this.getSenderAvatars();if(!e.size)return U.a.createElement(X,null);if(1===e.size){var t=e.get(0);return U.a.createElement(X,{sender:t})}var n=2===e.size;return U.a.createElement(Ci,null,e.map(function(e,t){return U.a.createElement(X,{key:t,sender:e,size:n?"xs":"xxs"})}))}},{key:"render",value:function(){return U.a.createElement(_e,null,this.renderAvatars())}}]);return t}(z.PureComponent);xi.displayName="InitialMessageAvatar";xi.propTypes={chatHeadingConfig:p.a.oneOfType([Object(m.a)("CompanyChatHeadingConfig"),Object(m.a)("OwnerChatHeadingConfig"),Object(m.a)("UsersAndTeamsChatHeadingConfig")]),sendFromResponders:p.a.instanceOf(Sn.List).isRequired,sender:Object(m.a)("Sender")};var Ti=xi,ki=function(e){Object(l.a)(t,e);function t(e){var n;Object(o.a)(this,t);(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleQuickReplySend=function(){var e=n.props,t=e.message,a=e.publishMessage,r=n.state.selectedQuickReply;a({text:Vr(r),quickReply:Object(Wr.a)(t).set("quickReplies",[r])})};n.handleQuickReplySelect=function(e){var t=e.target.value,a=n.props.message,r=Object(Wr.d)(a).filter(function(e){return Qr(e)===t}).first();n.setState({selectedQuickReply:r})};n.showQuickReplySelection=function(){var e=n.props.message,t=Object(Wr.d)(e),a=Object(Wr.b)(e);return n.showQuickReplies()&&t.count()>ti&&!a};n.renderQuickReplySelect=function(){var e=n.props,t=e.message,a=e.isThreadStarted,r=e.requiresExplicitConsentToProcess,i=n.state.selectedQuickReply,o=Object(Wr.d)(t);return U.a.createElement("div",{className:"m-y-2"},U.a.createElement(pi,{quickReplyOptions:o,disabled:r||!a,onChange:n.handleQuickReplySelect,value:Qr(i),placeholder:xt.a.text("conversations-visitor-message-history.quickReply.selectionPlaceholder")}))};n.renderQuickReplySendButton=function(){var e=n.props.isThreadStarted,t=n.state.selectedQuickReply;return U.a.createElement(He,null,U.a.createElement(Ha.a,{disabled:!e||!Qr(t),onClick:n.handleQuickReplySend,size:"sm",use:"primary"},U.a.createElement(at.a,{message:"conversations-visitor-message-history.quickReply.selectionComplete"})))};n.state={selectedQuickReply:Object(Sn.Map)()};return n}Object(s.a)(t,[{key:"hasQuickReplyOptions",value:function(){var e=this.props.message,t=Object(we.getSenderType)(e);return Object(Wr.a)(e)&&t===G.b}},{key:"showQuickReplies",value:function(){var e=this.props,t=e.hasUnansweredQuickReplyMessage,n=e.positionDescriptors,a=t&&n.get(wn.c);return this.hasQuickReplyOptions()&&a}},{key:"renderAvatar",value:function(){var e=this.props,t=e.chatHeadingConfig,n=e.message,a=e.senders,r=e.sendFromResponders,i=Object(we.getSenderId)(n),o=Object(we.getSenderType)(n),s=ne(i,o,a),c=Object(Q.b)(s);return U.a.createElement(Ti,{chatHeadingConfig:t,sender:c,sendFromResponders:r})}},{key:"renderQuickReplyGroup",value:function(){var e=this.props,t=e.isThreadStarted,n=e.message,a=e.publishMessage,r=e.requiresExplicitConsentToProcess,i=Object(Wr.d)(n),o=Object(Wr.b)(n);return U.a.createElement(He,null,U.a.createElement(ei,{disabled:r||!t,options:i,message:n,multiSelect:o,publishMessage:a,onSend:this.handleQuickReplySend}))}},{key:"renderContentSection",value:function(){var e,t,n=this.props.message;if(Boolean(Object(V.getType)(n))){e=Object(we.getPlainText)(n);t=Object(we.getRichText)(n)}else{e=Object(Ur.b)(n);t=Object(Ur.a)(n)}var a=_a.a.link(t,{stripPrefix:!1});return U.a.createElement(Le,null,U.a.createElement(un,{"aria-label":xt.a.text("conversations-visitor-message-history.agentMessage"),contentText:a||e}),this.showQuickReplySelection()&&this.renderQuickReplySelect())}},{key:"renderMessageFooter",value:function(){var e=this.props.message,t=Object(Wr.d)(e),n=Object(Wr.b)(e);return this.showQuickReplySelection()?this.renderQuickReplySendButton():this.showQuickReplies()&&(t.count()<=ti||n)?this.renderQuickReplyGroup():null}},{key:"render",value:function(){var e=this.props.positionDescriptors,t=e.get(wn.a);return U.a.createElement(Xe,{positionDescriptors:e,use:Y.a},t&&U.a.createElement(Qe,null,this.renderAvatar()),U.a.createElement(ze,null,this.renderContentSection()),this.renderMessageFooter())}}]);return t}(z.PureComponent);ki.displayName="InitialMessage";ki.propTypes={chatHeadingConfig:p.a.oneOfType([Object(m.a)("CompanyChatHeadingConfig"),Object(m.a)("OwnerChatHeadingConfig"),Object(m.a)("UsersAndTeamsChatHeadingConfig")]),hasUnansweredQuickReplyMessage:p.a.bool,isThreadStarted:p.a.bool.isRequired,message:p.a.oneOfType([Object(m.a)("PubNubMessageRecord"),Object(m.a)("InitialMessage")]).isRequired,positionDescriptors:J.a.isRequired,publishMessage:p.a.func,requiresExplicitConsentToProcess:p.a.bool.isRequired,sendFromResponders:p.a.instanceOf(Sn.List).isRequired,senders:$.a.isRequired};var Ei=ki,wi=n("a4p2"),Ii=n("N02q"),Ri=n("/11t"),Si=n("Gbx4"),Ai=n("GAhl"),Mi=n("cep6"),Pi=n("MS0j"),Ni=function(e){var t=Object(Mi.a)(e);return{chatHeadingConfig:Object(Ii.a)(e),sendFromResponders:Object(Ri.a)(e),hasUnansweredQuickReplyMessage:Object(Ai.a)(e,{thread:t}),isThreadStarted:Object(wi.a)(t),mobile:Object(Pi.getIsMobile)(e)}},qi={publishMessage:Si.a},_i=Object(Cr.b)(Ni,qi)(Ei),Fi=function(e){return e?xt.a.moment.userTz(e).format("LT"):null},Di=function(e){var t=Object(we.getSenderType)(e);return Object(Wr.a)(e)&&t===G.b},Li=function(e){Object(l.a)(t,e);function t(e){var n;Object(o.a)(this,t);(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).handleQuickReplySend=function(){var e=n.props,t=e.message,a=e.publishMessage,r=n.state.selectedQuickReply;a({text:Vr(r),quickReply:Object(Wr.a)(t).set("quickReplies",[r])})};n.handleQuickReplySelect=function(e){var t=e.target.value,a=n.props.message,r=Object(Wr.d)(a).filter(function(e){return Qr(e)===t}).first();n.setState({selectedQuickReply:r})};n.showQuickReplies=function(){var e=n.props,t=e.hasUnansweredQuickReplyMessage,a=e.message,r=e.positionDescriptors,i=t&&r.get(wn.c);return Di(a)&&i};n.showQuickReplySelection=function(){var e=n.props.message,t=Object(Wr.d)(e),a=Object(Wr.b)(e);return n.showQuickReplies()&&t.count()>ti&&!a};n.renderQuickReplyGroup=function(){var e=n.props,t=e.isThreadStarted,a=e.message,r=e.publishMessage,i=e.requiresExplicitConsentToProcess,o=Object(Wr.d)(a),s=Object(Wr.b)(a);return U.a.createElement(He,null,U.a.createElement(ei,{options:o,disabled:i||!t,message:a,multiSelect:s,publishMessage:r,onChange:n.handleQuickReplyUpdate}))};n.renderQuickReplySendButton=function(){var e=n.props.isThreadStarted,t=n.state.selectedQuickReply;return U.a.createElement(He,null,U.a.createElement(Ha.a,{disabled:!e||!Qr(t),onClick:n.handleQuickReplySend,size:"sm",use:"primary"},U.a.createElement(at.a,{message:"conversations-visitor-message-history.quickReply.selectionComplete"})))};n.renderQuickReplySelect=function(){var e=n.props,t=e.message,a=e.isThreadStarted,r=e.requiresExplicitConsentToProcess,i=n.state.selectedQuickReply,o=Object(Wr.d)(t);return U.a.createElement("div",{className:"m-bottom-3 m-x-3"},U.a.createElement(pi,{quickReplyOptions:o,disabled:r||!a,onChange:n.handleQuickReplySelect,value:Qr(i),placeholder:xt.a.text("conversations-visitor-message-history.quickReply.selectionPlaceholder")}))};n.state={selectedQuickReply:Object(Sn.Map)()};return n}Object(s.a)(t,[{key:"isSentFromVisitor",value:function(){return Object(we.getSenderType)(this.props.message)===G.e}},{key:"renderMessageHeader",value:function(){var e=this.props,t=e.message,n=e.positionDescriptors,a=e.senders;if(!n.includes(wn.b)||this.isSentFromVisitor())return null;var r=Object(we.getSenderId)(t),i=Object(we.getSenderType)(t),o=ne(r,i,a),s=Object(Q.b)(o);s||(s=Object(gi.a)({senderType:i,firstName:Object(we.getFromName)(t),email:Object(we.getFromAddress)(t)||null}));var c=re(o);return U.a.createElement(Qe,null,U.a.createElement(_e,null,U.a.createElement(X,{sender:s,isLoading:c})),U.a.createElement(Ze,null,U.a.createElement(lt,{isSenderLoading:c,sender:s})))}},{key:"renderTimeStamp",value:function(){var e=this.props,t=e.message,n=e.positionDescriptors.includes(wn.d),a=Object(we.getTimestamp)(t);return n&&a?U.a.createElement(He,null,U.a.createElement(nt.a,{use:"help"},Fi(a))):null}},{key:"renderMessageFooter",value:function(){var e=this.props.message,t=Object(Wr.d)(e),n=Object(Wr.b)(e);return this.showQuickReplies()&&this.showQuickReplySelection()?this.renderQuickReplySendButton():this.showQuickReplies()&&(t.count()<=ti||n)?this.renderQuickReplyGroup():this.renderTimeStamp()}},{key:"render",value:function(){var e=this.props,t=e.fileAttachments,n=e.message,a=e.positionDescriptors,r=e.toggleOpen,i=e.mobile,o=this.isSentFromVisitor()?Y.c:Y.a;return U.a.createElement(Xe,{positionDescriptors:a,use:o},this.renderMessageHeader(),U.a.createElement(La,{fileAttachments:t,isLastMessage:a.includes(wn.c),message:n,quickReplySelect:this.showQuickReplySelection()&&this.renderQuickReplySelect,mobile:i,toggleOpen:r}),this.renderMessageFooter())}}]);return t}(z.PureComponent);Li.displayName="CommonMessage";Li.propTypes={fileAttachments:p.a.instanceOf(Sn.List),hasUnansweredQuickReplyMessage:p.a.bool,isThreadStarted:p.a.bool.isRequired,message:p.a.oneOfType([Object(m.a)("PubNubMessageRecord"),Object(m.a)("CommonMessage")]).isRequired,mobile:p.a.bool,positionDescriptors:J.a.isRequired,publishMessage:p.a.func,requiresExplicitConsentToProcess:p.a.bool.isRequired,senders:$.a,toggleOpen:p.a.func};var Bi,zi=Li,Ui=n("yybq"),Hi=function(e){var t=Object(Mi.a)(e);return{hasUnansweredQuickReplyMessage:Object(Ai.a)(e,{thread:t}),isThreadStarted:Object(wi.a)(t),mobile:Object(Pi.getIsMobile)(e)}},Vi={publishMessage:Si.a,toggleOpen:Ui.toggleOpen},Qi=Object(Cr.b)(Hi,Vi)(zi),Wi=n("Zqdz"),Zi=function(e){return{requiresExplicitConsentToProcess:Object(Wi.a)(e)}},Gi={},Ki=Object(Cr.b)(Zi,Gi);n.d(t,"a",function(){return Xi});var Xi=(Bi={},Object(r.a)(Bi,gt.a,za),Object(r.a)(Bi,ft.d,Qi),Object(r.a)(Bi,bt.a,Ki(Qi)),Object(r.a)(Bi,i.a,En),Object(r.a)(Bi,ft.j,qr),Object(r.a)(Bi,gt.b,zr),Object(r.a)(Bi,ft.m,Ki(_i)),Object(r.a)(Bi,ft.q,bn),Object(r.a)(Bi,ft.v,bn),Object(r.a)(Bi,ft.w,mt),Bi)},wVuR:function(e,t,n){"use strict";n.r(t);n.d(t,"handleAttachmentUploadProgress",function(){return i});var a=n("ZyKU"),r=n("BaOL"),i=function(e){var t=e.localId,n=e.threadId,i=e.loaded,o=e.total;return function(e){var s=i/o*a.c;e(Object(r.attachmentUploadProgress)({localId:t,threadId:n,progress:s}))}}},wxZq:function(e,t,n){var a=n("fwVr");function r(){this.__data__=a?a(null):{};this.size=0}e.exports=r},wzyz:function(e,t,n){var a=n("HopT"),r=n("/gqD");function i(e,t){var n=r(e,t);return a(n)?n:void 0}e.exports=i},xqCo:function(e,t,n){"use strict";n.r(t);n.d(t,"sendConsentToProcess",function(){return s});var a=n("nDpY"),r=n.n(a),i=n("kMAx"),o="livechat-public/v1/privacy/consentToProcess";function s(e){var t=e.sessionId,n=e.hubspotUtk,a=e.welcomeMessageId;return i.a.put(o,{query:{sessionId:t,hubspotUtk:n,welcomeMessageId:a,portalId:r.a.get()}})}},"y+ws":function(e,t,n){"use strict";var a=n("PvDV"),r=n("ZQ2w"),i=n.n(r),o=n("OCxt"),s=n("10Vg"),c=s.b,u=s.a,l=s.i,d=function(){return"#f5f8fa"},p=function(){return"#eaf0f6"},h=n("y4Zp"),m=n.n(h),b=n("ZVA3"),f=function(e){var t=e.theme;return Object(o.d)(["color:",";background-color:",";"],c(t),u(t))},g=o.e.div.withConfig({displayName:"VizExFileAttachment__AttachmentWrapper",componentId:"sc-4siid1-0"})(["display:flex;font-size:12px;padding:12px;padding-right:32px;border-radius:3px;position:relative;max-width:100%;flex-direction:row;background-color:",";border:1px solid ",";color:",";",";"],function(e){var t=e.theme;return d(t)},function(e){var t=e.theme;return p(t)},function(e){var t=e.theme;return l(t)},function(e){return e.processing&&f(e)}),v=o.e.div.withConfig({displayName:"VizExFileAttachment__ContentWrapper",componentId:"sc-4siid1-1"})(["display:flex;position:relative;max-width:100%;> *:nth-child(2){padding-left:12px;}"]),O=o.e.div.withConfig({displayName:"VizExFileAttachment__PreviewWrapper",componentId:"sc-4siid1-2"})(["overflow-y:hidden;overflow-x:hidden;align-items:center;display:flex;flex-basis:auto;justify-content:center;flex-shrink:0;font-size:32px;max-height:32px;width:32px;"]),j=o.e.div.withConfig({displayName:"VizExFileAttachment__FileInfoWrapper",componentId:"sc-4siid1-3"})(["flex-grow:1;flex-shrink:0;flex-basis:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;@media all and (-ms-high-contrast:none){flex-basis:auto;max-width:100%;padding-right:12px;}"]),y=o.e.b.withConfig({displayName:"VizExFileAttachment__FileName",componentId:"sc-4siid1-4"})(["font-weight:600;font-size:12px;line-height:12px;"]),C=o.e.div.withConfig({displayName:"VizExFileAttachment__FileInfo",componentId:"sc-4siid1-5"})(["font-size:12px;line-height:12px;"]),x=function(e){var t=e.processing,n=e.preview,r=e.fileName,o=e.fileInfo,s=e.children,c=e.theme,u=Object(a.a)(e,["processing","preview","fileName","fileInfo","children","theme"]);return i.a.createElement(g,Object.assign({},u,{theme:c,processing:t}),s,i.a.createElement(v,null,n&&i.a.createElement(O,null,n),i.a.createElement(j,null,i.a.createElement(y,null,r),i.a.createElement(C,null,o))))};x.propTypes={children:m.a.node,fileInfo:m.a.node,fileName:m.a.node,preview:m.a.node,processing:m.a.bool,theme:b.a};x.displayName="VizExFileAttachment";t.a=x},ylAb:function(e,t,n){"use strict";var a=n("PvDV"),r=n("ZQ2w"),i=n.n(r),o=n("y4Zp"),s=n.n(o),c=n("OCxt"),u=n("ZVA3"),l="default",d="on-dark",p=n("1f16"),h=n("10Vg"),m=n("XMjd"),b=h.a,f=h.b,g=h.g,v=h.h,O=function(){return m.l},j=function(e){var t=e.theme;switch(e.use){case d:return Object(c.d)(["background-color:",";"],O(t));case l:default:return null}},y=function(e){var t=e.theme;return Object(c.d)(["cursor:not-allowed;background-color:",";"],b(t))},C=function(e){var t=e.theme;return Object(c.d)(["color:",";cursor:not-allowed;&::after{color:",";}"],f(t),f(t))},x=c.e.input.withConfig({displayName:"VizExInput__StyledTextInput",componentId:"r1x2l3-0"})(["",";height:100%;width:100%;line-height:22px;font-size:16px;padding-left:10px;padding-right:10px;border:none;border-radius:3px;background:transparent;",";:focus{outline:none;}::placeholder{color:",";}"],p.a,function(e){return e.disabled&&C(e)},function(e){var t=e.theme;return g(t)}),T=c.e.div.withConfig({displayName:"VizExInput__InputContainer",componentId:"r1x2l3-1"})(["height:42px;line-height:22px;font-size:16px;display:flex;flex-direction:row;justify-content:space-between;align-items:center;border:1px solid;border-color:",";background-color:",";:focus-within{border-color:",";}border-radius:3px;"," ",";"],function(e){var t=e.theme;return e.focus?v(t):Object(h.f)(t)},function(e){var t=e.theme;return Object(h.e)(t)},function(e){var t=e.theme;return v(t)},j,function(e){return e.disabled&&y(e)}),k=function(e){var t=e.suffix,n=e.prefix,r=e.disabled,o=e.placeholder,s=e.value,c=e.onChange,u=e.containerStyles,l=e.theme,d=e.use,p=e.focus,h=Object(a.a)(e,["suffix","prefix","disabled","placeholder","value","onChange","containerStyles","theme","use","focus"]);return i.a.createElement(T,{disabled:r,style:u,theme:l,use:d,focus:p,"data-testid":"VizExInput-Container"},n,i.a.createElement(x,Object.assign({"aria-disabled":r,disabled:r,placeholder:o,value:s,onChange:c,theme:l,use:d,"data-testid":"VizExInput-Input"},h)),t)};k.displayName="VizExInput";k.defaultProps={placeholder:""};k.propTypes={containerStyles:s.a.object,disabled:s.a.bool,focus:s.a.bool,onChange:s.a.func,onInput:s.a.func,placeholder:s.a.string,prefix:s.a.node,suffix:s.a.node,theme:u.a,use:s.a.oneOfType([l,d]),value:s.a.string};t.a=k},zF3W:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=n("CRij"),r=n("bDpH"),i=Object(a.createAction)(r.f)},zRU2:function(e,t,n){var a=n("nqur"),r="Expected a function";function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(r);var n=function(){var a=arguments,r=t?t.apply(this,a):a[0],i=n.cache;if(i.has(r))return i.get(r);var o=e.apply(this,a);n.cache=i.set(r,o)||i;return o};n.cache=new(i.Cache||a);return n}i.Cache=a;e.exports=i},zYvt:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a=5e3},znLu:function(e,t,n){"use strict";var a=n("gjBT"),r=n("u1T7"),i=n("2hC2"),o=n("8PIh"),s=n("Cdni"),c=n("G/XJ"),u=n("y4Zp"),l=n.n(u),d=n("ZQ2w"),p=n.n(d),h=n("RK3k"),m=n("D1/i"),b=n("CkTg");function f(e){if("number"==typeof e&&e>=0)return e;throw new Error("expected `interval` to be a positive number but got `"+e+"`")}function g(e,t){f(e);Object(b.a)(t);var n,a,r=0,i=null;function o(){if(null!==i){clearTimeout(i);i=null}}function s(){r=Date.now();a=t.apply(void 0,Object(h.a)(n))}function c(){for(var t=arguments.length,c=new Array(t),u=0;u<t;u++)c[u]=arguments[u];n=c;o();Date.now()-r>=e?s():i=setTimeout(s,e);return a}c.cancel=o;return c}var v=Object(m.a)(g),O=100,j=function(e){Object(c.a)(t,e);function t(e){var n;Object(a.a)(this,t);(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={inTop:!0,inBottom:!0,height:0,distanceToBottom:0,shouldKeepAtBottom:!0};n.scrollContainer=p.a.createRef();n.onResize=v(O,n.onResize.bind(Object(s.a)(n)));n.onScroll=v(O,n.onScroll.bind(Object(s.a)(n)));return n}Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this.scrollContainer.current;if(e){this.setState({height:e.clientHeight});this.scrollToBottom()}window.addEventListener("resize",this.onResize,{passive:!0})}},{key:"getSnapshotBeforeUpdate",value:function(){var e=this.scrollContainer.current;return e?{prevScrollTop:e.scrollTop}:null}},{key:"componentDidUpdate",value:function(e,t,n){var a=this.scrollContainer.current;if(n&&a)if(this.state.shouldKeepAtBottom)this.scrollToBottom();else if(0!==this.state.distanceToBottom){var r=n.prevScrollTop;a.scrollTop===r&&t.height>this.state.height&&this.setScrollTop(a.scrollTop+(t.height-this.state.height))}else this.setState({shouldKeepAtBottom:!0})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize)}},{key:"onScroll",value:function(){var e=this.props,t=e.onScrollToTop,n=e.onScrollToBottom,a=this.inThreshold(),r=a.inTop,i=a.inBottom;!this.state.inTop&&r&&t();!this.state.inBottom&&i&&n();var o=this.getScrollDistanceFromBottom();this.setState({inTop:r,inBottom:i,distanceToBottom:o,shouldKeepAtBottom:!1})}},{key:"inThreshold",value:function(){var e=this.props,t=e.topThreshold,n=e.bottomThreshold;return{inTop:this.getScrollDistanceFromTop()<=t,inBottom:this.getScrollDistanceFromBottom()<=n}}},{key:"getScrollDistanceFromTop",value:function(){var e=this.scrollContainer.current;return e?e.scrollTop:0}},{key:"getScrollDistanceFromBottom",value:function(){var e=this.scrollContainer.current;if(!e)return 0;var t=e.scrollTop,n=e.scrollHeight,a=e.clientHeight,r=e.offsetHeight;return n-(a||r)-t}},{key:"scrollToBottom",value:function(){var e=this.scrollContainer.current;e&&this.setScrollTop(e.scrollHeight);this.setState({shouldKeepAtBottom:!0})}},{key:"setScrollTop",value:function(e){var t=this.scrollContainer.current;t&&(t.scrollTop=e||0)}},{key:"onResize",value:function(){var e=this.scrollContainer.current;e&&this.setState({height:e.clientHeight||0})}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.className;return p.a.createElement("div",{className:n,style:{flexGrow:1},ref:this.scrollContainer,onScroll:this.onScroll},t)}}]);return t}(d.PureComponent);j.displayName="ScrollWrapper";j.propTypes={bottomThreshold:l.a.number.isRequired,children:l.a.node,className:l.a.string,onScrollToBottom:l.a.func.isRequired,onScrollToTop:l.a.func.isRequired,topThreshold:l.a.number.isRequired};var y=function(){};j.defaultProps={bottomThreshold:300,onScrollToBottom:y,onScrollToTop:y,topThreshold:300};var C=j,x=n("iYCd"),T=function(e){return document.querySelector("["+x.a+'="'+e+'"]')},k=n("I5v7"),E=function(e,t){var n=!0,a=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value;Object(k.a)(!!e.prototype[s],"Component missing required function %s",s)}}catch(e){a=!0;r=e}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}},w=function(){var e=document.querySelector("["+x.a+"]:last-child");return e&&e.getAttribute?e.getAttribute(x.a):null},I=function(e){var t=w();if(!e||!t)return null;var n=T(t);if(!n)return null;var a=e.getScrollDistanceFromTop();return{lastMessageId:t,lastMessageOffsetTop:n.offsetTop,prevScrollTop:a}},R=300,S=function(){return function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{alignment:"start"}).alignment,n=T(e);e&&n&&n.scrollIntoView&&n.scrollIntoView("start"===t)}},A=function(e){var t=e.scrollWrapperRef;return function(){var e=t.current;e&&e.scrollToBottom()}},M=function(e){var t=e.scrollWrapperRef;return function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).threshold,n=void 0===e?R:e,a=t.current;a&&a.state&&(t.current.state.distanceToBottom<=n||a.getScrollDistanceFromBottom()<=n)&&a.scrollToBottom()}},P=function(e){var t=e.current;return{lastMessageId:t.lastMessageId,lastMessageOffsetTop:t.lastMessageOffsetTop,prevScrollTop:t.prevScrollTop}},N=function(e){E(e,["getScrollDistanceFromTop","getScrollDistanceFromBottom","setScrollTop","scrollToBottom"]);var t=Object(d.forwardRef)(function(e,t){var n=Object(d.useRef)(),a=Object(d.useRef)();t.current={scrollToMessage:S(),scrollToBottom:A({scrollWrapperRef:n}),scrollToBottomIfInThreshold:M({scrollWrapperRef:n})};var r=Object(d.useRef)(!0);Object(d.useLayoutEffect)(function(){var e=n.current;if(r.current){a.current=I(e);r.current=!1}else if(a.current){var t=P(a),i=t.lastMessageId,o=t.lastMessageOffsetTop,s=t.prevScrollTop;a.current=I(e);if(e.getScrollDistanceFromTop()===s){var c=T(i);if(c&&c.offsetTop){var u=c.offsetTop-o;u&&e.setScrollTop(e.getScrollDistanceFromTop()+u)}}}});return p.a.createElement(C,Object.assign({ref:n},e))});t.displayName="WithScrollTo";return t},q=n("+UqK"),_=n("b2e+"),F=n("Aomi"),D=n("OCxt"),L=n("CTrm"),B=n("CDTs"),z=n("sjvu"),U=n("ooj3"),H=Object(D.e)(L.a).withConfig({displayName:"ThreadHistoryFetcher__LoadingSpinnerWrapper",componentId:"sc-1wh6m0q-0"})(["height:0;margin-top:20px;"]),V=Object(D.e)(N(C)).withConfig({displayName:"ThreadHistoryFetcher__ScrollToWrapper",componentId:"sc-1wh6m0q-1"})(["flex:1 1;display:flex;flex-direction:column;padding-bottom:12px;align-self:stretch;overflow-y:scroll;overflow-x:hidden;"]),Q=function(e){Object(c.a)(t,e);function t(e){var n;Object(a.a)(this,t);(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).scrollWrapper=Object(d.createRef)();n.fetchHistory=n.fetchHistory.bind(Object(s.a)(n));return n}Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this.scrollWrapper.current;e&&e.scrollToBottom();this.fetchHistory()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.threadId,a=t.messageCount,r=t.shouldScrollToBottom,i=t.isOnFocus,o=e.threadId,s=e.messageCount,c=e.shouldScrollToBottom,u=e.isOnFocus,l=this.scrollWrapper.current;if(n===o)if(s){a!==s&&l&&l.scrollToBottomIfInThreshold();r!==c&&l&&l.scrollToBottomIfInThreshold();i!==u&&l&&l.scrollToBottomIfInThreshold()}else l&&l.scrollToBottom();else{this.fetchHistory();l&&l.scrollToBottom()}}},{key:"fetchHistory",value:function(){var e=this.props,t=e.fetchThreadHistory,n=e.threadId,a=e.threadHistory,r=e.sessionId;n!==z.a&&t({offsetOrdinal:Object(_.c)(a),offsetTimestamp:Object(_.d)(a),threadId:n,sessionId:r})}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.isLoadingHistory,a=e.loadingHistoryFailed,r=e.threadId,i=e.threadHistory;if(n&&!Object(F.hasMessages)(i))return p.a.createElement(L.a,{grow:!0});if(a&&!Object(F.hasMessages)(i))return p.a.createElement(U.a,null);var o=Object(B.a)(this.props.className,"messages-scroll-container-utv");return p.a.createElement(V,{key:r,className:o,ref:this.scrollWrapper,onScrollToTop:this.fetchHistory},n&&p.a.createElement(H,{grow:!0}),t)}}]);return t}(d.PureComponent);Q.propTypes={children:l.a.node.isRequired,className:l.a.string,fetchThreadHistory:l.a.func.isRequired,isLoadingHistory:l.a.bool,isOnFocus:l.a.bool.isRequired,loadingHistoryFailed:l.a.bool,messageCount:l.a.number.isRequired,sessionId:l.a.string.isRequired,shouldScrollToBottom:l.a.bool.isRequired,threadHistory:Object(q.a)("ThreadHistory"),threadId:l.a.number.isRequired};Q.displayName="ThreadHistoryFetcher";t.a=Q}}]);
//# sourceMappingURL=threadview-utv.js.map